(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[224],{1095:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return O}});var n,i=r(2784),a=r(541),o=r(9973),s=(r(2701),r(3411)),u=r(4795),c=r(7162),l=r.n(c),p=r(9470),d=r(9015),f=r(3091),h=r(3018),v=r(3397),g=r(8042);function b(e){var t=e.SCRIPTS,r={};for(var n in t){var i=t[n];r[n]={CODE_HASH:i.CODE_HASH,HASH_TYPE:i.HASH_TYPE,TX_HASH:i.TX_HASH,INDEX:i.INDEX,DEP_TYPE:i.DEP_TYPE}}return g.vc.CKB2019({PREFIX:e.PREFIX,SCRIPTS:r})}var y,w,m=s.ZP.div(n||(n=(0,a.Z)(["\n  padding: 20px;\n\n  .resultForm {\n    .ant-form-item {\n      margin-bottom: 0px;\n    }\n  }\n\n  .errorMessage {\n    color: #ff4d4f;\n  }\n"]))),x=function(){var e=(0,i.useState)(),t=e[0],r=e[1],n=(0,i.useState)(),a=n[0],o=n[1],s=(0,i.useState)(),c=s[0],y=s[1],w=(0,i.useState)(),x=w[0],_=w[1],k=(0,i.useState)(),S=k[0],C=k[1],E=function(e){var t={};return e.address||(t.address="address required"),t},P=(0,v.TA)({onSubmit:function(e,t){return(0,u.Z)(l().mark((function n(){var i,a,s,u,c,p,d;return l().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=t.setFieldError,E(e),!e.address.startsWith("ckb")){n.next=7;break}g.vc.initializeConfig(g.vc.predefined.LINA),C("Mainnet"),n.next=15;break;case 7:if(!e.address.startsWith("ckt")){n.next=12;break}C("Testnet"),g.vc.initializeConfig(g.vc.predefined.AGGRON4),n.next=15;break;case 12:return i("address","ckb address must start with ckb/ckt"),C(void 0),n.abrupt("return");case 15:try{a=g.BM.addressToScript(e.address),r(a),s=g.vc.getConfig(),u=b(s),c=g.BM.encodeToAddress(a),o(c),p=g.BM.generateAddress(a,{config:u}),y(p),d=g.BM.generateAddress(a),_(d!==c?d:void 0)}catch(l){i("address",l.message),C(void 0)}case 16:case"end":return n.stop()}}),n)})))()},validate:E,initialValues:{address:""}}),I=function(e){return g.vc.helpers.nameOfScript(e)};return i.createElement(m,null,i.createElement(p.Z,{name:"basic"},i.createElement(p.Z.Item,{label:"Address",validateStatus:P.errors.address?"error":"success"},i.createElement(d.Z,{name:"address",onChange:P.handleChange,value:P.values.address}),i.createElement("span",{className:"errorMessage"},P.errors.address)),i.createElement(p.Z.Item,null,i.createElement(f.Z,{onClick:function(){return P.submitForm()},type:"primary",htmlType:"submit"},"Submit"))),i.createElement(p.Z,{name:"scriptToAddress",className:"resultForm"},i.createElement(p.Z.Item,{label:"Address(new full format)"},a&&i.createElement(h.Z.Text,{copyable:!0},a)),i.createElement(p.Z.Item,{label:"Address(deprecated full format)"},c&&i.createElement(h.Z.Text,{copyable:!0},c)),x&&i.createElement(p.Z.Item,{label:"Address(deprecated short format)"},i.createElement(h.Z.Text,{copyable:!0},x)),i.createElement(p.Z.Item,{label:"CodeHash"},t&&(null==t?void 0:t.code_hash)&&i.createElement(h.Z.Text,{copyable:!0},null==t?void 0:t.code_hash)),i.createElement(p.Z.Item,{label:"HashType"},(null==t?void 0:t.hash_type)&&i.createElement(h.Z.Text,{copyable:!0},null==t?void 0:t.hash_type)),i.createElement(p.Z.Item,{label:"args"},(null==t?void 0:t.args)&&i.createElement(h.Z.Text,{copyable:!0},null==t?void 0:t.args)),i.createElement(p.Z.Item,{label:"network"},S&&i.createElement(h.Z.Text,{copyable:!0},S)),t&&I(t)&&i.createElement(p.Z.Item,{label:"lock name"},i.createElement(h.Z.Text,{copyable:!0},I(t)))))},_=r(2192),k=s.ZP.div(y||(y=(0,a.Z)(["\n  padding: 20px;\n\n  .resultForm {\n    .ant-form-item {\n      margin-bottom: 0px;\n    }\n  }\n\n  .errorMessage {\n    color: #ff4d4f;\n  }\n"]))),S=function(){var e=(0,i.useState)(""),t=e[0],r=e[1],n=(0,i.useState)(""),a=n[0],o=n[1],s=(0,i.useState)(""),c=s[0],y=s[1],w=(0,i.useState)(""),m=w[0],x=w[1],S=(0,i.useState)(""),C=S[0],E=S[1],P=(0,i.useState)(""),I=P[0],A=P[1],z=(0,v.TA)({onSubmit:function(e){return(0,u.Z)(l().mark((function t(){var n,i,a,s,u,c,p,d;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:g.vc.initializeConfig(g.vc.predefined.AGGRON4),n=g.BM.scriptToAddress(e),i=g.BM.encodeToAddress(e),E(i),x(n!==i?n:void 0),a=g.vc.getConfig(),s=b(a),u=g.BM.scriptToAddress(e,{config:s}),A(u),g.vc.initializeConfig(g.vc.predefined.LINA),c=g.BM.scriptToAddress(e),p=g.BM.encodeToAddress(e),o(p),r(c!==p?c:void 0),a=g.vc.getConfig(),s=b(a),d=g.BM.scriptToAddress(e,{config:s}),y(d);case 18:case"end":return t.stop()}}),t)})))()},initialValues:{code_hash:"",hash_type:"type",args:""}});return i.createElement(k,null,i.createElement(p.Z,{name:"scriptToAddress"},i.createElement(p.Z.Item,{label:"CodeHash"},i.createElement(d.Z,{name:"code_hash",onChange:z.handleChange,value:z.values.code_hash})),i.createElement(p.Z.Item,{label:"HashType"},i.createElement(_.ZP.Group,{name:"hash_type",onChange:z.handleChange,value:z.values.hash_type},i.createElement(_.ZP,{value:"data"},"data"),i.createElement(_.ZP,{value:"type"},"type"))),i.createElement(p.Z.Item,{label:"args"},i.createElement(d.Z,{name:"args",onChange:z.handleChange,value:z.values.args})),i.createElement(p.Z.Item,null,i.createElement(f.Z,{onClick:function(){return z.submitForm()},type:"primary",htmlType:"submit"},"Submit"))),i.createElement(p.Z,{className:"resultForm"},i.createElement("h4",null,"Testnet"),i.createElement(p.Z.Item,{label:"Address(new full format)"},C&&i.createElement(h.Z.Text,{copyable:!0},C)),i.createElement(p.Z.Item,{label:"Address(deprecated full format)"},I&&i.createElement(h.Z.Text,{copyable:!0},I)),m&&i.createElement(p.Z.Item,{label:"Address(deprecated short format)"},i.createElement(h.Z.Text,{copyable:!0},m)),i.createElement("h4",{style:{marginTop:15}},"Mainnet"),i.createElement(p.Z.Item,{label:"Address(new full format)"},a&&i.createElement(h.Z.Text,{copyable:!0},a)),i.createElement(p.Z.Item,{label:"Address(deprecated full format)"},c&&i.createElement(h.Z.Text,{copyable:!0},c)),t&&i.createElement(p.Z.Item,{label:"Address(deprecated short format)"},i.createElement(h.Z.Text,{copyable:!0},t))))},C=o.Z.TabPane,E=s.ZP.div(w||(w=(0,a.Z)(["\n  padding: 20px;\n  display: flex;\n  justify-content: center;\n  .ant-tabs {\n    min-width: 900px;\n  }\n"]))),P=function(){return i.createElement(E,null,i.createElement(o.Z,{defaultActiveKey:"1"},i.createElement(C,{tab:"Address to Script/new Address",key:"1"},i.createElement(x,null)),i.createElement(C,{tab:"Script to Address",key:"2"},i.createElement(S,null))))},I=r(5438),A=r(7933),z=r(3181),B=function(){var e=(0,z.TH)();return i.createElement(I.Z,{style:{width:256},defaultSelectedKeys:[e.pathname],mode:"inline"},i.createElement(I.Z.Item,{key:"/tools/address-conversion"},i.createElement(A.rU,{to:"/tools/address-conversion"},"Address Conversion")))},T=r(3611);function O(){return i.createElement(T.Z,{title:"Tools",description:""},i.createElement("div",{style:{display:"flex"}},i.createElement(B,null),i.createElement(P,null)))}},3677:function(e,t){!function(e){"use strict";function t(e,t){throw new Error("Invalid data length! Required: "+t+", actual: "+e)}function r(e,r){e!==r&&t(e,r)}function n(e){if(e instanceof Object&&e.toArrayBuffer instanceof Function&&(e=e.toArrayBuffer()),!(e instanceof ArrayBuffer))throw new Error("Provided value must be an ArrayBuffer or can be transformed into ArrayBuffer!");return e}function i(e,n,i){e.byteLength<4&&t(e.byteLength,">4");var a=e.getUint32(0,!0);if(r(e.byteLength,a),4===a)return[a];a<8&&t(e.byteLength,">8");var o=e.getUint32(4,!0);if(o%4!=0||o<8)throw new Error("Invalid first offset: "+o);var s=o/4-1;if(s<n)throw new Error("Item count not enough! Required: "+n+", actual: "+s);if(!i&&s>n)throw new Error("Item count is more than required! Required: "+n+", actual: "+s);if(a<o)throw new Error("First offset is larger than byte length: "+o);for(var u=[],c=0;c<s;c++){var l=4+4*c;u.push(e.getUint32(l,!0))}u.push(a);for(var p=0;p<u.length-1;p++)if(u[p]>u[p+1])throw new Error("Offset index "+p+": "+u[p]+" is larger than offset index "+(p+1)+": "+u[p+1]);return u}function a(e){for(var t=e.length,r=4*(t+1),n=[],i=0;i<t;i++)n.push(r),r+=e[i].byteLength;var a=new ArrayBuffer(r),o=new Uint8Array(a),s=new DataView(a);s.setUint32(0,r,!0);for(var u=0;u<t;u++)s.setUint32(4+4*u,n[u],!0),o.set(new Uint8Array(e[u]),n[u]);return a}var o=function(){function e(e,t){var r=(void 0===t?{}:t).validate,i=void 0===r||r;this.view=new DataView(n(e)),i&&this.validate()}var t=e.prototype;return t.validate=function(e){void 0===e&&(e=!1),r(this.view.byteLength,4)},t.indexAt=function(e){return this.view.getUint8(e)},t.raw=function(){return this.view.buffer},t.toBigEndianUint32=function(){return this.view.getUint32(0,!1)},t.toLittleEndianUint32=function(){return this.view.getUint32(0,!0)},e.size=function(){return 4},e}();function s(e){var t=n(e);return r(t.byteLength,4),t}var u=function(){function e(e,t){var r=(void 0===t?{}:t).validate,i=void 0===r||r;this.view=new DataView(n(e)),i&&this.validate()}var t=e.prototype;return t.validate=function(e){void 0===e&&(e=!1),r(this.view.byteLength,8)},t.indexAt=function(e){return this.view.getUint8(e)},t.raw=function(){return this.view.buffer},t.toBigEndianBigUint64=function(){return this.view.getBigUint64(0,!1)},t.toLittleEndianBigUint64=function(){return this.view.getBigUint64(0,!0)},e.size=function(){return 8},e}();function c(e){var t=n(e);return r(t.byteLength,8),t}var l=function(){function e(e,t){var r=(void 0===t?{}:t).validate,i=void 0===r||r;this.view=new DataView(n(e)),i&&this.validate()}var t=e.prototype;return t.validate=function(e){void 0===e&&(e=!1),r(this.view.byteLength,16)},t.indexAt=function(e){return this.view.getUint8(e)},t.raw=function(){return this.view.buffer},e.size=function(){return 16},e}();function p(e){var t=n(e);return r(t.byteLength,16),t}var d=function(){function e(e,t){var r=(void 0===t?{}:t).validate,i=void 0===r||r;this.view=new DataView(n(e)),i&&this.validate()}var t=e.prototype;return t.validate=function(e){void 0===e&&(e=!1),r(this.view.byteLength,32)},t.indexAt=function(e){return this.view.getUint8(e)},t.raw=function(){return this.view.buffer},e.size=function(){return 32},e}();function f(e){var t=n(e);return r(t.byteLength,32),t}var h=function(){function e(e,t){var r=(void 0===t?{}:t).validate,i=void 0===r||r;this.view=new DataView(n(e)),i&&this.validate()}var t=e.prototype;return t.validate=function(e){void 0===e&&(e=!1),r(this.view.byteLength,32)},t.indexAt=function(e){return this.view.getUint8(e)},t.raw=function(){return this.view.buffer},e.size=function(){return 32},e}();function v(e){var t=n(e);return r(t.byteLength,32),t}var g=function(){function e(e,t){var r=(void 0===t?{}:t).validate,i=void 0===r||r;this.view=new DataView(n(e)),i&&this.validate()}var i=e.prototype;return i.validate=function(e){void 0===e&&(e=!1),this.view.byteLength<4&&t(this.view.byteLength,">4");var n=this.length()+4;r(this.view.byteLength,n)},i.raw=function(){return this.view.buffer.slice(4)},i.indexAt=function(e){return this.view.getUint8(4+e)},i.length=function(){return this.view.getUint32(0,!0)},e}();function b(e){var t=n(e),r=new Uint8Array(4+t.byteLength);return new DataView(r.buffer).setUint32(0,t.byteLength,!0),r.set(new Uint8Array(t),4),r.buffer}var y=function(){function e(e,t){var r=(void 0===t?{}:t).validate,i=void 0===r||r;this.view=new DataView(n(e)),i&&this.validate()}var t=e.prototype;return t.validate=function(e){void 0===e&&(e=!1),this.hasValue()&&this.value().validate(e)},t.value=function(){return new g(this.view.buffer,{validate:!1})},t.hasValue=function(){return this.view.byteLength>0},e}();function w(e){return e?b(e):new ArrayBuffer(0)}var m=function(){function e(e,t){var r=(void 0===t?{}:t).validate,i=void 0===r||r;this.view=new DataView(n(e)),i&&this.validate()}var t=e.prototype;return t.validate=function(e){void 0===e&&(e=!1);for(var t=i(this.view,0,!0),r=0;r<t.length-1;r++)new g(this.view.buffer.slice(t[r],t[r+1]),{validate:!1}).validate()},t.length=function(){return this.view.byteLength<8?0:this.view.getUint32(4,!0)/4-1},t.indexAt=function(e){var t=4+4*e,r=this.view.getUint32(t,!0),n=this.view.byteLength;return e+1<this.length()&&(n=this.view.getUint32(t+4,!0)),new g(this.view.buffer.slice(r,n),{validate:!1})},e}();function x(e){return a(e.map((function(e){return b(e)})))}var _=function(){function e(e,t){var r=(void 0===t?{}:t).validate,i=void 0===r||r;this.view=new DataView(n(e)),i&&this.validate()}var i=e.prototype;return i.validate=function(e){void 0===e&&(e=!1),this.view.byteLength<4&&t(this.view.byteLength,">4");var n=this.length()*d.size()+4;r(this.view.byteLength,n);for(var i=0;i<0;i++)this.indexAt(i).validate(e)},i.indexAt=function(e){return new d(this.view.buffer.slice(4+e*d.size(),4+(e+1)*d.size()),{validate:!1})},i.length=function(){return this.view.getUint32(0,!0)},e}();function k(e){var t=new Uint8Array(4+d.size()*e.length);new DataView(t.buffer).setUint32(0,e.length,!0);for(var r=0;r<e.length;r++){var n=f(e[r]);t.set(new Uint8Array(n),4+r*d.size())}return t.buffer}var S=function(){function e(e,t){var r=(void 0===t?{}:t).validate,i=void 0===r||r;this.view=new DataView(n(e)),i&&this.validate()}var t=e.prototype;return t.validate=function(e){void 0===e&&(e=!1),this.hasValue()&&this.value().validate(e)},t.value=function(){return new N(this.view.buffer,{validate:!1})},t.hasValue=function(){return this.view.byteLength>0},e}();function C(e){return e?M(e):new ArrayBuffer(0)}var E=function(){function e(e,t){var r=(void 0===t?{}:t).validate,i=void 0===r||r;this.view=new DataView(n(e)),i&&this.validate()}var t=e.prototype;return t.validate=function(e){void 0===e&&(e=!1),r(this.view.byteLength,10)},t.indexAt=function(e){return this.view.getUint8(e)},t.raw=function(){return this.view.buffer},e.size=function(){return 10},e}();function P(e){var t=n(e);return r(t.byteLength,10),t}var I=function(){function e(e,t){var r=(void 0===t?{}:t).validate,i=void 0===r||r;this.view=new DataView(n(e)),i&&this.validate()}var t=e.prototype;return t.validate=function(e){void 0===e&&(e=!1);for(var t=i(this.view,0,!0),r=0;r<t.length-1;r++)new ie(this.view.buffer.slice(t[r],t[r+1]),{validate:!1}).validate()},t.length=function(){return this.view.byteLength<8?0:this.view.getUint32(4,!0)/4-1},t.indexAt=function(e){var t=4+4*e,r=this.view.getUint32(t,!0),n=this.view.byteLength;return e+1<this.length()&&(n=this.view.getUint32(t+4,!0)),new ie(this.view.buffer.slice(r,n),{validate:!1})},e}();function A(e){return a(e.map((function(e){return ae(e)})))}var z=function(){function e(e,t){var r=(void 0===t?{}:t).validate,i=void 0===r||r;this.view=new DataView(n(e)),i&&this.validate()}var t=e.prototype;return t.validate=function(e){void 0===e&&(e=!1);for(var t=i(this.view,0,!0),r=0;r<t.length-1;r++)new $(this.view.buffer.slice(t[r],t[r+1]),{validate:!1}).validate()},t.length=function(){return this.view.byteLength<8?0:this.view.getUint32(4,!0)/4-1},t.indexAt=function(e){var t=4+4*e,r=this.view.getUint32(t,!0),n=this.view.byteLength;return e+1<this.length()&&(n=this.view.getUint32(t+4,!0)),new $(this.view.buffer.slice(r,n),{validate:!1})},e}();function B(e){return a(e.map((function(e){return Q(e)})))}var T=function(){function e(e,t){var r=(void 0===t?{}:t).validate,i=void 0===r||r;this.view=new DataView(n(e)),i&&this.validate()}var i=e.prototype;return i.validate=function(e){void 0===e&&(e=!1),this.view.byteLength<4&&t(this.view.byteLength,">4");var n=this.length()*E.size()+4;r(this.view.byteLength,n);for(var i=0;i<0;i++)this.indexAt(i).validate(e)},i.indexAt=function(e){return new E(this.view.buffer.slice(4+e*E.size(),4+(e+1)*E.size()),{validate:!1})},i.length=function(){return this.view.getUint32(0,!0)},e}();function O(e){var t=new Uint8Array(4+E.size()*e.length);new DataView(t.buffer).setUint32(0,e.length,!0);for(var r=0;r<e.length;r++){var n=P(e[r]);t.set(new Uint8Array(n),4+r*E.size())}return t.buffer}var H=function(){function e(e,t){var r=(void 0===t?{}:t).validate,i=void 0===r||r;this.view=new DataView(n(e)),i&&this.validate()}var i=e.prototype;return i.validate=function(e){void 0===e&&(e=!1),this.view.byteLength<4&&t(this.view.byteLength,">4");var n=this.length()*J.size()+4;r(this.view.byteLength,n);for(var i=0;i<0;i++)this.indexAt(i).validate(e)},i.indexAt=function(e){return new J(this.view.buffer.slice(4+e*J.size(),4+(e+1)*J.size()),{validate:!1})},i.length=function(){return this.view.getUint32(0,!0)},e}();function j(e){var t=new Uint8Array(4+J.size()*e.length);new DataView(t.buffer).setUint32(0,e.length,!0);for(var r=0;r<e.length;r++){var n=X(e[r]);t.set(new Uint8Array(n),4+r*J.size())}return t.buffer}var D=function(){function e(e,t){var r=(void 0===t?{}:t).validate,i=void 0===r||r;this.view=new DataView(n(e)),i&&this.validate()}var i=e.prototype;return i.validate=function(e){void 0===e&&(e=!1),this.view.byteLength<4&&t(this.view.byteLength,">4");var n=this.length()*F.size()+4;r(this.view.byteLength,n);for(var i=0;i<0;i++)this.indexAt(i).validate(e)},i.indexAt=function(e){return new F(this.view.buffer.slice(4+e*F.size(),4+(e+1)*F.size()),{validate:!1})},i.length=function(){return this.view.getUint32(0,!0)},e}();function L(e){var t=new Uint8Array(4+F.size()*e.length);new DataView(t.buffer).setUint32(0,e.length,!0);for(var r=0;r<e.length;r++){var n=V(e[r]);t.set(new Uint8Array(n),4+r*F.size())}return t.buffer}var R=function(){function e(e,t){var r=(void 0===t?{}:t).validate,i=void 0===r||r;this.view=new DataView(n(e)),i&&this.validate()}var t=e.prototype;return t.validate=function(e){void 0===e&&(e=!1);for(var t=i(this.view,0,!0),r=0;r<t.length-1;r++)new W(this.view.buffer.slice(t[r],t[r+1]),{validate:!1}).validate()},t.length=function(){return this.view.byteLength<8?0:this.view.getUint32(4,!0)/4-1},t.indexAt=function(e){var t=4+4*e,r=this.view.getUint32(t,!0),n=this.view.byteLength;return e+1<this.length()&&(n=this.view.getUint32(t+4,!0)),new W(this.view.buffer.slice(r,n),{validate:!1})},e}();function U(e){return a(e.map((function(e){return Y(e)})))}var N=function(){function e(e,t){var r=(void 0===t?{}:t).validate,i=void 0===r||r;this.view=new DataView(n(e)),i&&this.validate()}var t=e.prototype;return t.validate=function(e){void 0===e&&(e=!1);var t=i(this.view,0,!0);if(new d(this.view.buffer.slice(t[0],t[1]),{validate:!1}).validate(),t[2]-t[1]!=1)throw new Error("Invalid offset for hash_type: "+t[1]+" - "+t[2]);new g(this.view.buffer.slice(t[2],t[3]),{validate:!1}).validate()},t.getCodeHash=function(){var e=4,t=this.view.getUint32(e,!0),r=this.view.getUint32(e+4,!0);return new d(this.view.buffer.slice(t,r),{validate:!1})},t.getHashType=function(){var e=8,t=this.view.getUint32(e,!0),r=this.view.getUint32(e+4,!0);return new DataView(this.view.buffer.slice(t,r)).getUint8(0)},t.getArgs=function(){var e=12,t=this.view.getUint32(e,!0),r=this.view.byteLength;return new g(this.view.buffer.slice(t,r),{validate:!1})},e}();function M(e){var t=[];t.push(f(e.code_hash));var r=new DataView(new ArrayBuffer(1));return r.setUint8(0,e.hash_type),t.push(r.buffer),t.push(b(e.args)),a(t)}var K=function(){function e(e,t){var r=(void 0===t?{}:t).validate,i=void 0===r||r;this.view=new DataView(n(e)),i&&this.validate()}var t=e.prototype;return t.getTxHash=function(){return new d(this.view.buffer.slice(0,0+d.size()),{validate:!1})},t.getIndex=function(){return new o(this.view.buffer.slice(0+d.size(),0+d.size()+o.size()),{validate:!1})},t.validate=function(t){void 0===t&&(t=!1),r(this.view.byteLength,e.size()),this.getTxHash().validate(t),this.getIndex().validate(t)},e.size=function(){return 0+d.size()+o.size()},e}();function q(e){var t=new Uint8Array(0+d.size()+o.size());return t.set(new Uint8Array(f(e.tx_hash)),0),t.set(new Uint8Array(s(e.index)),0+d.size()),t.buffer}var F=function(){function e(e,t){var r=(void 0===t?{}:t).validate,i=void 0===r||r;this.view=new DataView(n(e)),i&&this.validate()}var t=e.prototype;return t.getSince=function(){return new u(this.view.buffer.slice(0,0+u.size()),{validate:!1})},t.getPreviousOutput=function(){return new K(this.view.buffer.slice(0+u.size(),0+u.size()+K.size()),{validate:!1})},t.validate=function(t){void 0===t&&(t=!1),r(this.view.byteLength,e.size()),this.getSince().validate(t),this.getPreviousOutput().validate(t)},e.size=function(){return 0+u.size()+K.size()},e}();function V(e){var t=new Uint8Array(0+u.size()+K.size());return t.set(new Uint8Array(c(e.since)),0),t.set(new Uint8Array(q(e.previous_output)),0+u.size()),t.buffer}var W=function(){function e(e,t){var r=(void 0===t?{}:t).validate,i=void 0===r||r;this.view=new DataView(n(e)),i&&this.validate()}var t=e.prototype;return t.validate=function(e){void 0===e&&(e=!1);var t=i(this.view,0,!0);new u(this.view.buffer.slice(t[0],t[1]),{validate:!1}).validate(),new N(this.view.buffer.slice(t[1],t[2]),{validate:!1}).validate(),new S(this.view.buffer.slice(t[2],t[3]),{validate:!1}).validate()},t.getCapacity=function(){var e=4,t=this.view.getUint32(e,!0),r=this.view.getUint32(e+4,!0);return new u(this.view.buffer.slice(t,r),{validate:!1})},t.getLock=function(){var e=8,t=this.view.getUint32(e,!0),r=this.view.getUint32(e+4,!0);return new N(this.view.buffer.slice(t,r),{validate:!1})},t.getType=function(){var e=12,t=this.view.getUint32(e,!0),r=this.view.byteLength;return new S(this.view.buffer.slice(t,r),{validate:!1})},e}();function Y(e){var t=[];return t.push(c(e.capacity)),t.push(M(e.lock)),t.push(C(e.type_)),a(t)}var J=function(){function e(e,t){var r=(void 0===t?{}:t).validate,i=void 0===r||r;this.view=new DataView(n(e)),i&&this.validate()}var t=e.prototype;return t.getOutPoint=function(){return new K(this.view.buffer.slice(0,0+K.size()),{validate:!1})},t.getDepType=function(){return this.view.getUint8(0+K.size())},t.validate=function(t){void 0===t&&(t=!1),r(this.view.byteLength,e.size()),this.getOutPoint().validate(t)},e.size=function(){return 0+K.size()+1},e}();function X(e){var t=new Uint8Array(0+K.size()+1),r=new DataView(t.buffer);return t.set(new Uint8Array(q(e.out_point)),0),r.setUint8(0+K.size(),e.dep_type),t.buffer}var Z=function(){function e(e,t){var r=(void 0===t?{}:t).validate,i=void 0===r||r;this.view=new DataView(n(e)),i&&this.validate()}var t=e.prototype;return t.validate=function(e){void 0===e&&(e=!1);var t=i(this.view,0,!0);new o(this.view.buffer.slice(t[0],t[1]),{validate:!1}).validate(),new H(this.view.buffer.slice(t[1],t[2]),{validate:!1}).validate(),new _(this.view.buffer.slice(t[2],t[3]),{validate:!1}).validate(),new D(this.view.buffer.slice(t[3],t[4]),{validate:!1}).validate(),new R(this.view.buffer.slice(t[4],t[5]),{validate:!1}).validate(),new m(this.view.buffer.slice(t[5],t[6]),{validate:!1}).validate()},t.getVersion=function(){var e=4,t=this.view.getUint32(e,!0),r=this.view.getUint32(e+4,!0);return new o(this.view.buffer.slice(t,r),{validate:!1})},t.getCellDeps=function(){var e=8,t=this.view.getUint32(e,!0),r=this.view.getUint32(e+4,!0);return new H(this.view.buffer.slice(t,r),{validate:!1})},t.getHeaderDeps=function(){var e=12,t=this.view.getUint32(e,!0),r=this.view.getUint32(e+4,!0);return new _(this.view.buffer.slice(t,r),{validate:!1})},t.getInputs=function(){var e=16,t=this.view.getUint32(e,!0),r=this.view.getUint32(e+4,!0);return new D(this.view.buffer.slice(t,r),{validate:!1})},t.getOutputs=function(){var e=20,t=this.view.getUint32(e,!0),r=this.view.getUint32(e+4,!0);return new R(this.view.buffer.slice(t,r),{validate:!1})},t.getOutputsData=function(){var e=24,t=this.view.getUint32(e,!0),r=this.view.byteLength;return new m(this.view.buffer.slice(t,r),{validate:!1})},e}();function G(e){var t=[];return t.push(s(e.version)),t.push(j(e.cell_deps)),t.push(k(e.header_deps)),t.push(L(e.inputs)),t.push(U(e.outputs)),t.push(x(e.outputs_data)),a(t)}var $=function(){function e(e,t){var r=(void 0===t?{}:t).validate,i=void 0===r||r;this.view=new DataView(n(e)),i&&this.validate()}var t=e.prototype;return t.validate=function(e){void 0===e&&(e=!1);var t=i(this.view,0,!0);new Z(this.view.buffer.slice(t[0],t[1]),{validate:!1}).validate(),new m(this.view.buffer.slice(t[1],t[2]),{validate:!1}).validate()},t.getRaw=function(){var e=4,t=this.view.getUint32(e,!0),r=this.view.getUint32(e+4,!0);return new Z(this.view.buffer.slice(t,r),{validate:!1})},t.getWitnesses=function(){var e=8,t=this.view.getUint32(e,!0),r=this.view.byteLength;return new m(this.view.buffer.slice(t,r),{validate:!1})},e}();function Q(e){var t=[];return t.push(G(e.raw)),t.push(x(e.witnesses)),a(t)}var ee=function(){function e(e,t){var r=(void 0===t?{}:t).validate,i=void 0===r||r;this.view=new DataView(n(e)),i&&this.validate()}var t=e.prototype;return t.getVersion=function(){return new o(this.view.buffer.slice(0,0+o.size()),{validate:!1})},t.getCompactTarget=function(){return new o(this.view.buffer.slice(0+o.size(),0+o.size()+o.size()),{validate:!1})},t.getTimestamp=function(){return new u(this.view.buffer.slice(0+o.size()+o.size(),0+o.size()+o.size()+u.size()),{validate:!1})},t.getNumber=function(){return new u(this.view.buffer.slice(0+o.size()+o.size()+u.size(),0+o.size()+o.size()+u.size()+u.size()),{validate:!1})},t.getEpoch=function(){return new u(this.view.buffer.slice(0+o.size()+o.size()+u.size()+u.size(),0+o.size()+o.size()+u.size()+u.size()+u.size()),{validate:!1})},t.getParentHash=function(){return new d(this.view.buffer.slice(0+o.size()+o.size()+u.size()+u.size()+u.size(),0+o.size()+o.size()+u.size()+u.size()+u.size()+d.size()),{validate:!1})},t.getTransactionsRoot=function(){return new d(this.view.buffer.slice(0+o.size()+o.size()+u.size()+u.size()+u.size()+d.size(),0+o.size()+o.size()+u.size()+u.size()+u.size()+d.size()+d.size()),{validate:!1})},t.getProposalsHash=function(){return new d(this.view.buffer.slice(0+o.size()+o.size()+u.size()+u.size()+u.size()+d.size()+d.size(),0+o.size()+o.size()+u.size()+u.size()+u.size()+d.size()+d.size()+d.size()),{validate:!1})},t.getExtraHash=function(){return new d(this.view.buffer.slice(0+o.size()+o.size()+u.size()+u.size()+u.size()+d.size()+d.size()+d.size(),0+o.size()+o.size()+u.size()+u.size()+u.size()+d.size()+d.size()+d.size()+d.size()),{validate:!1})},t.getDao=function(){return new d(this.view.buffer.slice(0+o.size()+o.size()+u.size()+u.size()+u.size()+d.size()+d.size()+d.size()+d.size(),0+o.size()+o.size()+u.size()+u.size()+u.size()+d.size()+d.size()+d.size()+d.size()+d.size()),{validate:!1})},t.validate=function(t){void 0===t&&(t=!1),r(this.view.byteLength,e.size()),this.getVersion().validate(t),this.getCompactTarget().validate(t),this.getTimestamp().validate(t),this.getNumber().validate(t),this.getEpoch().validate(t),this.getParentHash().validate(t),this.getTransactionsRoot().validate(t),this.getProposalsHash().validate(t),this.getExtraHash().validate(t),this.getDao().validate(t)},e.size=function(){return 0+o.size()+o.size()+u.size()+u.size()+u.size()+d.size()+d.size()+d.size()+d.size()+d.size()},e}();function te(e){var t=new Uint8Array(0+o.size()+o.size()+u.size()+u.size()+u.size()+d.size()+d.size()+d.size()+d.size()+d.size());return t.set(new Uint8Array(s(e.version)),0),t.set(new Uint8Array(s(e.compact_target)),0+o.size()),t.set(new Uint8Array(c(e.timestamp)),0+o.size()+o.size()),t.set(new Uint8Array(c(e.number)),0+o.size()+o.size()+u.size()),t.set(new Uint8Array(c(e.epoch)),0+o.size()+o.size()+u.size()+u.size()),t.set(new Uint8Array(f(e.parent_hash)),0+o.size()+o.size()+u.size()+u.size()+u.size()),t.set(new Uint8Array(f(e.transactions_root)),0+o.size()+o.size()+u.size()+u.size()+u.size()+d.size()),t.set(new Uint8Array(f(e.proposals_hash)),0+o.size()+o.size()+u.size()+u.size()+u.size()+d.size()+d.size()),t.set(new Uint8Array(f(e.extra_hash)),0+o.size()+o.size()+u.size()+u.size()+u.size()+d.size()+d.size()+d.size()),t.set(new Uint8Array(f(e.dao)),0+o.size()+o.size()+u.size()+u.size()+u.size()+d.size()+d.size()+d.size()+d.size()),t.buffer}var re=function(){function e(e,t){var r=(void 0===t?{}:t).validate,i=void 0===r||r;this.view=new DataView(n(e)),i&&this.validate()}var t=e.prototype;return t.getRaw=function(){return new ee(this.view.buffer.slice(0,0+ee.size()),{validate:!1})},t.getNonce=function(){return new l(this.view.buffer.slice(0+ee.size(),0+ee.size()+l.size()),{validate:!1})},t.validate=function(t){void 0===t&&(t=!1),r(this.view.byteLength,e.size()),this.getRaw().validate(t),this.getNonce().validate(t)},e.size=function(){return 0+ee.size()+l.size()},e}();function ne(e){var t=new Uint8Array(0+ee.size()+l.size());return t.set(new Uint8Array(te(e.raw)),0),t.set(new Uint8Array(p(e.nonce)),0+ee.size()),t.buffer}var ie=function(){function e(e,t){var r=(void 0===t?{}:t).validate,i=void 0===r||r;this.view=new DataView(n(e)),i&&this.validate()}var t=e.prototype;return t.validate=function(e){void 0===e&&(e=!1);var t=i(this.view,0,!0);new re(this.view.buffer.slice(t[0],t[1]),{validate:!1}).validate(),new T(this.view.buffer.slice(t[1],t[2]),{validate:!1}).validate()},t.getHeader=function(){var e=4,t=this.view.getUint32(e,!0),r=this.view.getUint32(e+4,!0);return new re(this.view.buffer.slice(t,r),{validate:!1})},t.getProposals=function(){var e=8,t=this.view.getUint32(e,!0),r=this.view.byteLength;return new T(this.view.buffer.slice(t,r),{validate:!1})},e}();function ae(e){var t=[];return t.push(ne(e.header)),t.push(O(e.proposals)),a(t)}var oe=function(){function e(e,t){var r=(void 0===t?{}:t).validate,i=void 0===r||r;this.view=new DataView(n(e)),i&&this.validate()}var t=e.prototype;return t.validate=function(e){void 0===e&&(e=!1);var t=i(this.view,0,!0);new re(this.view.buffer.slice(t[0],t[1]),{validate:!1}).validate(),new I(this.view.buffer.slice(t[1],t[2]),{validate:!1}).validate(),new z(this.view.buffer.slice(t[2],t[3]),{validate:!1}).validate(),new T(this.view.buffer.slice(t[3],t[4]),{validate:!1}).validate()},t.getHeader=function(){var e=4,t=this.view.getUint32(e,!0),r=this.view.getUint32(e+4,!0);return new re(this.view.buffer.slice(t,r),{validate:!1})},t.getUncles=function(){var e=8,t=this.view.getUint32(e,!0),r=this.view.getUint32(e+4,!0);return new I(this.view.buffer.slice(t,r),{validate:!1})},t.getTransactions=function(){var e=12,t=this.view.getUint32(e,!0),r=this.view.getUint32(e+4,!0);return new z(this.view.buffer.slice(t,r),{validate:!1})},t.getProposals=function(){var e=16,t=this.view.getUint32(e,!0),r=this.view.byteLength;return new T(this.view.buffer.slice(t,r),{validate:!1})},e}();function se(e){var t=[];return t.push(ne(e.header)),t.push(A(e.uncles)),t.push(B(e.transactions)),t.push(O(e.proposals)),a(t)}var ue=function(){function e(e,t){var r=(void 0===t?{}:t).validate,i=void 0===r||r;this.view=new DataView(n(e)),i&&this.validate()}var t=e.prototype;return t.validate=function(e){void 0===e&&(e=!1);var t=i(this.view,0,!0);new re(this.view.buffer.slice(t[0],t[1]),{validate:!1}).validate(),new I(this.view.buffer.slice(t[1],t[2]),{validate:!1}).validate(),new z(this.view.buffer.slice(t[2],t[3]),{validate:!1}).validate(),new T(this.view.buffer.slice(t[3],t[4]),{validate:!1}).validate(),new g(this.view.buffer.slice(t[4],t[5]),{validate:!1}).validate()},t.getHeader=function(){var e=4,t=this.view.getUint32(e,!0),r=this.view.getUint32(e+4,!0);return new re(this.view.buffer.slice(t,r),{validate:!1})},t.getUncles=function(){var e=8,t=this.view.getUint32(e,!0),r=this.view.getUint32(e+4,!0);return new I(this.view.buffer.slice(t,r),{validate:!1})},t.getTransactions=function(){var e=12,t=this.view.getUint32(e,!0),r=this.view.getUint32(e+4,!0);return new z(this.view.buffer.slice(t,r),{validate:!1})},t.getProposals=function(){var e=16,t=this.view.getUint32(e,!0),r=this.view.getUint32(e+4,!0);return new T(this.view.buffer.slice(t,r),{validate:!1})},t.getExtension=function(){var e=20,t=this.view.getUint32(e,!0),r=this.view.byteLength;return new g(this.view.buffer.slice(t,r),{validate:!1})},e}();function ce(e){var t=[];return t.push(ne(e.header)),t.push(A(e.uncles)),t.push(B(e.transactions)),t.push(O(e.proposals)),t.push(b(e.extension)),a(t)}var le=function(){function e(e,t){var r=(void 0===t?{}:t).validate,i=void 0===r||r;this.view=new DataView(n(e)),i&&this.validate()}var t=e.prototype;return t.validate=function(e){void 0===e&&(e=!1);var t=i(this.view,0,!0);new N(this.view.buffer.slice(t[0],t[1]),{validate:!1}).validate(),new g(this.view.buffer.slice(t[1],t[2]),{validate:!1}).validate()},t.getLock=function(){var e=4,t=this.view.getUint32(e,!0),r=this.view.getUint32(e+4,!0);return new N(this.view.buffer.slice(t,r),{validate:!1})},t.getMessage=function(){var e=8,t=this.view.getUint32(e,!0),r=this.view.byteLength;return new g(this.view.buffer.slice(t,r),{validate:!1})},e}();function pe(e){var t=[];return t.push(M(e.lock)),t.push(b(e.message)),a(t)}var de=function(){function e(e,t){var r=(void 0===t?{}:t).validate,i=void 0===r||r;this.view=new DataView(n(e)),i&&this.validate()}var t=e.prototype;return t.validate=function(e){void 0===e&&(e=!1);var t=i(this.view,0,!0);new y(this.view.buffer.slice(t[0],t[1]),{validate:!1}).validate(),new y(this.view.buffer.slice(t[1],t[2]),{validate:!1}).validate(),new y(this.view.buffer.slice(t[2],t[3]),{validate:!1}).validate()},t.getLock=function(){var e=4,t=this.view.getUint32(e,!0),r=this.view.getUint32(e+4,!0);return new y(this.view.buffer.slice(t,r),{validate:!1})},t.getInputType=function(){var e=8,t=this.view.getUint32(e,!0),r=this.view.getUint32(e+4,!0);return new y(this.view.buffer.slice(t,r),{validate:!1})},t.getOutputType=function(){var e=12,t=this.view.getUint32(e,!0),r=this.view.byteLength;return new y(this.view.buffer.slice(t,r),{validate:!1})},e}();function fe(e){var t=[];return t.push(w(e.lock)),t.push(w(e.input_type)),t.push(w(e.output_type)),a(t)}e.Block=oe,e.BlockV1=ue,e.Byte32=d,e.Byte32Vec=_,e.Bytes=g,e.BytesOpt=y,e.BytesVec=m,e.CellDep=J,e.CellDepVec=H,e.CellInput=F,e.CellInputVec=D,e.CellOutput=W,e.CellOutputVec=R,e.CellbaseWitness=le,e.Header=re,e.OutPoint=K,e.ProposalShortId=E,e.ProposalShortIdVec=T,e.RawHeader=ee,e.RawTransaction=Z,e.Script=N,e.ScriptOpt=S,e.SerializeBlock=se,e.SerializeBlockV1=ce,e.SerializeByte32=f,e.SerializeByte32Vec=k,e.SerializeBytes=b,e.SerializeBytesOpt=w,e.SerializeBytesVec=x,e.SerializeCellDep=X,e.SerializeCellDepVec=j,e.SerializeCellInput=V,e.SerializeCellInputVec=L,e.SerializeCellOutput=Y,e.SerializeCellOutputVec=U,e.SerializeCellbaseWitness=pe,e.SerializeHeader=ne,e.SerializeOutPoint=q,e.SerializeProposalShortId=P,e.SerializeProposalShortIdVec=O,e.SerializeRawHeader=te,e.SerializeRawTransaction=G,e.SerializeScript=M,e.SerializeScriptOpt=C,e.SerializeTransaction=Q,e.SerializeTransactionVec=B,e.SerializeUint128=p,e.SerializeUint256=v,e.SerializeUint32=s,e.SerializeUint64=c,e.SerializeUncleBlock=ae,e.SerializeUncleBlockVec=A,e.SerializeWitnessArgs=fe,e.Transaction=$,e.TransactionVec=z,e.Uint128=l,e.Uint256=h,e.Uint32=o,e.Uint64=u,e.UncleBlock=ie,e.UncleBlockVec=I,e.WitnessArgs=de,Object.defineProperty(e,"__esModule",{value:!0})}(t)},8331:function(e,t,r){var n=r(1674).Reader;e.exports={DenormalizeOutPoint:function(e){return{tx_hash:new n(e.getTxHash().raw()).serializeJson(),index:"0x"+BigInt(e.getIndex().toLittleEndianUint32()).toString(16)}},DenormalizeScript:function(e){var t=e.getHashType();return{code_hash:new n(e.getCodeHash().raw()).serializeJson(),hash_type:0===t?"data":1===t?"type":2===t?"data1":void 0,args:new n(e.getArgs().raw()).serializeJson()}}}},720:function(e,t,r){var n=r(7115).ScriptValue;e.exports={isCellMatchQueryOptions:function(e,t){var r=t.lock,i=void 0===r?void 0:r,a=t.type,o=void 0===a?void 0:a,s=t.argsLen,u=void 0===s?-1:s,c=t.data,l=void 0===c?"any":c,p=t.fromBlock,d=void 0===p?void 0:p,f=t.toBlock,h=void 0===f?void 0:f,v=null,g=null;if(i&&!i.script?v={script:i,argsLen:u}:i&&i.script&&(v=i,i.argsLen||(v.argsLen=u)),o&&"empty"===o?g=o:o&&"object"==typeof o&&!o.script?g={script:o,argsLen:u}:o&&"object"==typeof o&&o.script&&(g=o,o.argsLen||(g.argsLen=u)),v&&v.script&&-1===v.argsLen&&!new n(e.cell_output.lock,{validate:!1}).equals(new n(v.script,{validate:!1})))return!1;if(v&&v.script&&"any"===v.argsLen){var b=e.cell_output.lock;if(b.code_hash!==v.script.code_hash||b.hash_type!==v.script.hash_type||!b.args.startsWith(v.script.args))return!1}if(v&&v.script&&"number"==typeof v.argsLen&&v.argsLen>=0){var y=2*v.argsLen+2,w=v.script.args.length,m=Math.min(y,w),x=e.cell_output.lock;if(x.args.length!==y)return!1;if(x.code_hash!==v.script.code_hash||x.hash_type!==v.script.hash_type||x.args.slice(0,m)!==v.script.args.slice(0,m))return!1}return(!g||"empty"!==g||!e.cell_output.type)&&(!!(!g||"object"!=typeof g||e.cell_output.type&&new n(e.cell_output.type,{validate:!1}).equals(new n(g.script,{validate:!1})))&&((!l||"any"===l||e.data===l)&&(!(d&&e.block_number&&BigInt(e.block_number)<BigInt(d))&&!(h&&e.block_number&&BigInt(e.block_number)>BigInt(h)))))}}},7143:function(e,t,r){e.exports={core:r(3677),denormalizers:r(8331),values:r(7115),utils:r(8400),since:r(318),helpers:r(720),indexer:r(6023),logger:r(4286)}},6023:function(e,t,r){var n=r(3572).default,i=r(7162),a=r(2954).default,o=r(4879).default,s=r(8133).default,u=r(1674).validators,c=r(8400),l=function(){"use strict";function e(e,t,r){var n=void 0===t?{}:t,i=n.lock,a=void 0===i?null:i,o=n.type,s=void 0===o?null:o,l=n.argsLen,p=void 0===l?-1:l,d=n.fromBlock,f=void 0===d?null:d,h=n.toBlock,v=void 0===h?null:h,g=n.order,b=void 0===g?"asc":g,y=n.skip,w=void 0===y?null:y,m=void 0===r?{}:r,x=m.skipMissing,_=void 0!==x&&x,k=m.includeStatus,S=void 0===k||k;if(!(a||s&&"empty"!==s))throw new Error("Either lock or type script must be provided!");if(a&&!a.script?(u.ValidateScript(a),this.lock={script:a,ioType:"both",argsLen:p}):a&&a.script&&(u.ValidateScript(a.script),this.lock=a,a.argsLen||(this.lock.argsLen=p),a.ioType||(this.lock.ioType="both")),"empty"===s?this.type=s:s&&!s.script?(u.ValidateScript(s),this.type={script:s,ioType:"both",argsLen:p}):s&&s.script&&(u.ValidateScript(s.script),this.type=s,s.argsLen||(this.type.argsLen=p),s.ioType||(this.type.ioType="both")),f&&c.assertHexadecimal("fromBlock",f),v&&c.assertHexadecimal("toBlock",v),"asc"!==b&&"desc"!==b)throw new Error("Order must be either asc or desc!");this.indexer=e,this.skipMissing=_,this.includeStatus=S,this.fromBlock=f,this.toBlock=v,this.order=b,this.skip=w,this.rpc=e.rpc}var t=e.prototype;return t.getTransactionHashes=function(){var e=a(i.mark((function e(){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implement!");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t.count=function(){var e=a(i.mark((function e(){var t;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getTransactionHashes();case 2:return t=e.sent,e.abrupt("return",t.size);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.collect=function(){var e=this;return s(i.mark((function t(){var r,a,s,u,c;return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o(e.getTransactionHashes());case 2:r=t.sent,a=n(r);case 4:if((s=a()).done){t.next=20;break}return u=s.value,t.next=8,o(e.rpc.get_transaction(u));case 8:if(c=t.sent,e.skipMissing||c){t.next=11;break}throw new Error("Transaction "+h+" is missing!");case 11:if(!e.includeStatus){t.next=16;break}return t.next=14,c;case 14:t.next=18;break;case 16:return t.next=18,c.transaction;case 18:t.next=4;break;case 20:case"end":return t.stop()}}),t)})))()},e}();e.exports={TransactionCollector:l}},4286:function(e,t){function r(e,t){var r="["+e+"] "+t;return"error"===e||"warn"===e?console.warn(r):void console.log("["+e+"] "+t)}e.exports={defaultLogger:r,deprecated:function(e){r("deprecated",e)}}},318:function(e){function t(e){var t,r,n=(e=BigInt(e))>>BigInt(56),i=n>>BigInt(5)&BigInt("0b11");if(i===BigInt(0))t="blockNumber",r=e&BigInt("0xFFFFFFFFFFFFFF");else if(i===BigInt(1))t="epochNumber",r={length:Number(e>>BigInt(40)&BigInt(65535)),index:Number(e>>BigInt(24)&BigInt(65535)),number:Number(e&BigInt(16777215))};else{if(i!==BigInt(2))throw new Error("Invalid metric flag!");t="blockTimestamp",r=e&BigInt("0xFFFFFFFFFFFFFF")}return{relative:(n&BigInt("0x80"))!==BigInt(0),type:t,value:r}}function r(e){var t,r=e.relative,n=e.type,i=e.value,o=BigInt(0);return r&&(o+=BigInt(128)),"epochNumber"===n?o+=BigInt(32):"blockTimestamp"===n&&(o+=BigInt(64)),t="object"==typeof i?BigInt(a(i)):BigInt(i),u((o<<BigInt(56))+t)}function n(e){return e=BigInt(e),{length:Number(e>>BigInt(40)&BigInt(65535)),index:Number(e>>BigInt(24)&BigInt(65535)),number:Number(e&BigInt(16777215))}}function i(e){return r({relative:!1,type:"epochNumber",value:{length:e.length,index:e.index,number:e.number}})}function a(e){var t=e.length,r=e.index,n=e.number;return u((BigInt(t)<<BigInt(40))+(BigInt(r)<<BigInt(24))+BigInt(n))}function o(e){var r=t(e),n=r.relative,i=r.type,a=r.value;if(!1!==n||"epochNumber"!==i)throw new Error("Since format error!");return a}function s(e,r){var i=t(e).value,a=n(BigInt(r));return i.number<a.number||i.number===a.number&&BigInt(i.index)*BigInt(a.length)<=BigInt(a.index)*BigInt(i.length)}function u(e){return"0x"+e.toString(16)}e.exports={parseSince:t,parseEpoch:n,maximumAbsoluteEpochSince:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n=t.map((function(e){return o(e)})),a=Math.max.apply(Math,n.map((function(e){return e.number}))),s=n.filter((function(e){return e.number===a})),u=s[0],c=1;c<s.length;++c){var l=s[c];BigInt(l.index)*BigInt(u.length)>=BigInt(u.index)*BigInt(l.length)&&(u=l)}return i(u)},generateAbsoluteEpochSince:i,parseAbsoluteEpochSince:o,validateAbsoluteEpochSince:s,validateSince:function(e,r,i){var a=t(e),o=a.relative,u=a.type,c=a.value;if(o){if("epochNumber"===u){var l=n(BigInt(r.epoch)),p=n(BigInt(i.epoch)),d={number:BigInt(c.number+p.number),index:BigInt(c.index)*BigInt(p.length)+BigInt(p.index)*BigInt(c.length),length:BigInt(c.length)*BigInt(p.length)};return 0===c.length&&0!==p.length?(d.index=BigInt(p.index),d.length=BigInt(p.length)):0===p.length&&0!==c.length&&(d.index=BigInt(c.index),d.length=BigInt(c.length)),d.length&&d.index>=d.length&&(d.number+=d.index/d.length,d.index=d.index%d.length),d.number<BigInt(l.number)||d.number===BigInt(l.number)&&d.index*BigInt(l.length)<=BigInt(l.index)*d.length}if("blockNumber"===u)return c+BigInt(i.block_number)<=BigInt(r.block_number);if("blockTimestamp"===u){if(!r.median_timestamp||!i.median_timestamp)throw new Error("Must provide median_timestamp!");return 1000n*c+BigInt(i.median_timestamp)<=BigInt(r.median_timestamp)}}else{if("epochNumber"===u)return s(e,r.epoch);if("blockNumber"===u)return c<=BigInt(r.block_number);if("blockTimestamp"===u){if(!r.median_timestamp)throw new Error("Must provide tip median_timestamp!");return 1000n*c<=BigInt(r.median_timestamp)}}},generateSince:r,generateHeaderEpoch:a}},8400:function(e,t,r){var n=r(8834).Buffer,i=r(5391),a=r(1674),o=a.validators,s=a.normalizers,u=a.Reader,c=r(3677),l=c.SerializeScript,p=c.SerializeCellInput,d=r(1713).xxHash32,f=function(){"use strict";function e(){this.hasher=i(32,null,null,new Uint8Array(u.fromRawString("ckb-default-hash").toArrayBuffer()))}var t=e.prototype;return t.update=function(e){return this.hasher.update(new Uint8Array(new u(e).toArrayBuffer())),this},t.digestReader=function(){var e=new Uint8Array(32);return this.hasher.digest(e),new u(e.buffer)},t.digestHex=function(){return this.digestReader().serializeJson()},e}();function h(e){var t=new f;return t.update(e),t.digestReader()}function v(e){e=BigInt(e);var t=n.alloc(8);return t.writeBigUInt64LE(e),"0x"+t.toString("hex")}var g=BigInt(0),b=340282366920938463463374607431768211455n;function y(e,t){if(!/^0x(0|[0-9a-fA-F]+)$/.test(t))throw new Error(e+" must be a hexadecimal!")}e.exports={CKBHasher:f,ckbHash:h,toBigUInt64LE:v,readBigUInt64LE:function(e){return n.from(e.slice(2),"hex").readBigUInt64LE()},toBigUInt128LE:function(e){if(e<g)throw new Error("u128 "+e+" too small");if(e>b)throw new Error("u128 "+e+" too large");var t=n.alloc(16);return t.writeBigUInt64LE(e&BigInt("0xFFFFFFFFFFFFFFFF"),0),t.writeBigUInt64LE(e>>BigInt(64),8),"0x"+t.toString("hex")},readBigUInt128LE:function(e){if(e.length<34||!e.startsWith("0x"))throw new Error("leHex format error");var t=n.from(e.slice(2,34),"hex");return(t.readBigUInt64LE(8)<<BigInt(64))+t.readBigUInt64LE(0)},computeScriptHash:function(e,t){var r=(void 0===t?{}:t).validate;return(void 0===r||r)&&o.ValidateScript(e),h(new u(l(s.NormalizeScript(e)))).serializeJson()},hashCode:function(e){return d(e,0)},assertHexString:function(e,t){if(!/^0x([0-9a-fA-F][0-9a-fA-F])*$/.test(t))throw new Error(e+" must be a hex string!")},assertHexadecimal:y,generateTypeIdScript:function(e,t){void 0===t&&(t="0x0"),o.ValidateCellInput(e),y("outputIndex",t);var r=function(e,t){var r=p(s.NormalizeCellInput(e)),n=v(t),i=new f;return i.update(r),i.update(n),i.digestHex()}(e,t);return{code_hash:"0x00000000000000000000000000000000000000000000000000545950455f4944",hash_type:"type",args:r}}}},7115:function(e,t,r){var n=r(8834).Buffer,i=r(7111).default,a=r(1674),o=a.validators,s=a.normalizers,u=a.Reader,c=r(1713).xxHash32,l=r(3677),p=r(8400).ckbHash,d=function(){"use strict";function e(e,t){this.buffer=e,this.value=t}var t=e.prototype;return t.equals=function(e){return new u(this.buffer).serializeJson()===new u(e.buffer).serializeJson()},t.hashCode=function(){return c(n.from(this.buffer),0)},t.hash=function(){return p(this.buffer).serializeJson()},e}(),f=function(e){"use strict";function t(t,r){var n=(void 0===r?{}:r).validate;return(void 0===n||n)&&o.ValidateScript(t),e.call(this,l.SerializeScript(s.NormalizeScript(t)),t)||this}return i(t,e),t}(d),h=function(e){"use strict";function t(t,r){var n=(void 0===r?{}:r).validate;return(void 0===n||n)&&o.ValidateOutPoint(t),e.call(this,l.SerializeOutPoint(s.NormalizeOutPoint(t)),t)||this}return i(t,e),t}(d),v=function(e){"use strict";function t(t,r){var n=(void 0===r?{}:r).validate;return(void 0===n||n)&&o.ValidateRawTransaction(t),e.call(this,l.SerializeRawTransaction(s.NormalizeRawTransaction(t)),t)||this}return i(t,e),t}(d),g=function(e){"use strict";function t(t,r){var n=(void 0===r?{}:r).validate;return(void 0===n||n)&&o.ValidateTransaction(t),e.call(this,l.SerializeTransaction(s.NormalizeTransaction(t)),t)||this}return i(t,e),t}(d);e.exports={ScriptValue:f,OutPointValue:h,RawTransactionValue:v,TransactionValue:g}},1996:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BI=void 0,t.isBIish=a,t.toJSBI=u;var n,i=(n=r(1484))&&n.__esModule?n:{default:n};function a(e){return null!==e&&("number"==typeof e&&e%1==0||"string"==typeof e&&(!!e.match(/^0x(0|[0-9a-fA-F]+)$/)||!!e.match(/^-?[0-9]+$/))||"bigint"==typeof e||o.isBI(e))}var o=function(){function e(e){this.jsbi=e,this._isBI=!0}var t=e.prototype;return t.add=function(e){return s(i.default.add(this.jsbi,u(e)))},t.sub=function(e){return s(i.default.subtract(this.jsbi,u(e)))},t.div=function(e){return s(i.default.divide(this.jsbi,u(e)))},t.mul=function(e){return s(i.default.multiply(this.jsbi,u(e)))},t.mod=function(e){return s(i.default.remainder(this.jsbi,u(e)))},t.abs=function(){return i.default.greaterThanOrEqual(this.jsbi,u(0))?s(this.jsbi):s(i.default.unaryMinus(this.jsbi))},t.pow=function(e){return s(i.default.exponentiate(this.jsbi,u(e)))},t.and=function(e){return s(i.default.bitwiseAnd(this.jsbi,u(e)))},t.or=function(e){return s(i.default.bitwiseOr(this.jsbi,u(e)))},t.xor=function(e){return s(i.default.bitwiseXor(this.jsbi,u(e)))},t.not=function(){return s(i.default.bitwiseNot(this.jsbi))},t.mask=function(e){var t=u(e);if(i.default.lessThan(t,u(0))||i.default.lessThan(this.jsbi,u(0)))throw new Error("mask works only with positive numbers");var r=u(this.jsbi.toString(2).length);if(i.default.lessThanOrEqual(r,t))return s(this.jsbi);var n=i.default.leftShift(i.default.signedRightShift(this.jsbi,t),t);return s(i.default.bitwiseXor(this.jsbi,n))},t.shl=function(e){return s(i.default.leftShift(this.jsbi,u(e)))},t.shr=function(e){return s(i.default.signedRightShift(this.jsbi,u(e)))},t.eq=function(e){return i.default.equal(this.jsbi,u(e))},t.lt=function(e){return i.default.lessThan(this.jsbi,u(e))},t.lte=function(e){return i.default.lessThanOrEqual(this.jsbi,u(e))},t.gt=function(e){return i.default.greaterThan(this.jsbi,u(e))},t.gte=function(e){return i.default.greaterThanOrEqual(this.jsbi,u(e))},t.isNegative=function(){return i.default.lessThan(this.jsbi,u(0))},t.isZero=function(){return i.default.equal(this.jsbi,u(0))},t.toNumber=function(){return i.default.toNumber(this.jsbi)},t.toBigInt=function(){try{return BigInt(this.jsbi.toString(10))}catch(e){throw new Error("this platform does not support BigInt")}},t.toString=function(e){return e=e||10,this.jsbi.toString(e)},t.toHexString=function(){return i.default.lessThan(this.jsbi,u(0))?"-0x"+i.default.unaryMinus(this.jsbi).toString(16):"0x"+this.jsbi.toString(16)},e.from=function(t){if(t instanceof e)return t;if(a(t))return s(u(t));throw new Error("invalid type: "+t+" can't be converted into BI")},e.isBI=function(e){return!(!e||!e._isBI)},e}();function s(e){return new o(e)}function u(e){return"number"==typeof e||"string"==typeof e?i.default.BigInt(e):i.default.BigInt(e.toString())}t.BI=o},9804:function(e,t,r){"use strict";var n=r(7162),i=r(2954).default,a=r(4879).default,o=r(8133).default;Object.defineProperty(t,"__esModule",{value:!0}),t.CKBCellCollector=void 0;var s,u=r(7143),c=r(1674),l=r(162),p=(s=r(6279))&&s.__esModule?s:{default:s};var d=function(){function e(e,t,r){this.indexer=e,this.queries=t,this.otherQueryOptions=r;var n={lock:void 0,type:void 0,argsLen:-1,data:"any",fromBlock:void 0,toBlock:void 0,order:"asc",skip:void 0,outputDataLenRange:void 0,outputCapacityRange:void 0,bufferSize:void 0};if(this.queries=Object.assign({},n,this.queries),!(this.queries.lock||this.queries.type&&"empty"!==this.queries.type))throw new Error("Either lock or type script must be provided!");if(this.queries.lock&&((0,l.instanceOfScriptWrapper)(this.queries.lock)?(0,l.instanceOfScriptWrapper)(this.queries.lock)&&(c.validators.ValidateScript(this.queries.lock.script),this.queries.lock=this.queries.lock.script):c.validators.ValidateScript(this.queries.lock)),this.queries.type&&"empty"!==this.queries.type&&("object"!=typeof this.queries.type||(0,l.instanceOfScriptWrapper)(this.queries.type)?"object"==typeof this.queries.type&&(0,l.instanceOfScriptWrapper)(this.queries.type)&&(c.validators.ValidateScript(this.queries.type.script),this.queries.type=this.queries.type.script):c.validators.ValidateScript(this.queries.type)),this.queries.fromBlock&&u.utils.assertHexadecimal("fromBlock",this.queries.fromBlock),this.queries.toBlock&&u.utils.assertHexadecimal("toBlock",this.queries.toBlock),"asc"!==this.queries.order&&"desc"!==this.queries.order)throw new Error("Order must be either asc or desc!");if(this.queries.outputCapacityRange&&(u.utils.assertHexadecimal("outputCapacityRange[0]",this.queries.outputCapacityRange[0]),u.utils.assertHexadecimal("outputCapacityRange[1]",this.queries.outputCapacityRange[1])),this.queries.outputDataLenRange&&(u.utils.assertHexadecimal("outputDataLenRange[0]",this.queries.outputDataLenRange[0]),u.utils.assertHexadecimal("outputDataLenRange[1]",this.queries.outputDataLenRange[1])),this.queries.skip&&"number"!=typeof this.queries.skip)throw new Error("skip must be a number!");if(this.queries.bufferSize&&"number"!=typeof this.queries.bufferSize)throw new Error("bufferSize must be a number!")}var t=e.prototype;return t.getLiveCell=function(){var e=i(n.mark((function e(t){var r,i;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={sizeLimit:this.queries.bufferSize,order:this.queries.order},t&&(r.lastCursor=t),e.next=4,this.indexer.getCells((0,l.generateSearchKey)(this.queries),void 0,r);case 4:return i=e.sent,e.abrupt("return",i);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.shouldSkipped=function(e,t){return void 0===t&&(t=0),!!(this.queries.skip&&t<this.queries.skip)||(!(!e||"empty"!==this.queries.type||!e.cell_output.type)||("any"!==this.queries.data&&e.data!==this.queries.data||(-1!==this.queries.argsLen&&"any"!==this.queries.argsLen&&(0,l.getHexStringBytes)(e.cell_output.lock.args)!==this.queries.argsLen||void 0)))},t.count=function(){var e=i(n.mark((function e(){var t,r,a,o,s,u,c,l=this;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=void 0,r=function(){var e=i(n.mark((function e(){var r;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.getLiveCell(t);case 2:return r=e.sent,t=r.lastCursor,e.abrupt("return",r.objects);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),a=0,e.next=5,r();case 5:if(0!==(o=e.sent).length){e.next=8;break}return e.abrupt("return",0);case 8:s=r(),u=0,c=0;case 11:if(this.shouldSkipped(o[u],c)?c++:a+=1,++u!==o.length){e.next=22;break}return u=0,e.next=18,s;case 18:if(0!==(o=e.sent).length){e.next=21;break}return e.abrupt("break",24);case 21:s=r();case 22:e.next=11;break;case 24:return e.abrupt("return",a);case 25:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.request=function(){var e=i(n.mark((function e(t,r){var i,a;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,p.default)(t,{method:"POST",body:JSON.stringify(r),headers:{"Content-Type":"application/json"}});case 2:if(200===(i=e.sent).status){e.next=5;break}throw new Error("indexer request failed with HTTP code "+i.status);case 5:return e.next=7,i.json();case 7:if(void 0===(a=e.sent).error){e.next=10;break}throw new Error("indexer request rpc failed with error: "+JSON.stringify(a.error));case 10:return e.abrupt("return",a);case 11:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),t.getLiveCellWithBlockHash=function(){var e=i(n.mark((function e(t){var r,i,a;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.otherQueryOptions){e.next=2;break}throw new Error("CKB Rpc URL must provide");case 2:return e.next=4,this.getLiveCell(t);case 4:if(0!==(r=e.sent).objects.length){e.next=7;break}return e.abrupt("return",r);case 7:return i=r.objects.map((function(e,t){return{id:t,jsonrpc:"2.0",method:"get_block_hash",params:[e.block_number]}})),e.next=10,this.request(this.otherQueryOptions.ckbRpcUrl,i);case 10:return a=e.sent,r.objects=r.objects.map((function(e,t){var r=a.find((function(e){return e.id===t})),n=r&&r.result;return Object.assign({},e,{block_hash:n})})),e.abrupt("return",r);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.collect=function(){var e=this;return o(n.mark((function t(){var r,o,s,u,c,l,p;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.otherQueryOptions&&"withBlockHash"in e.otherQueryOptions&&e.otherQueryOptions.withBlockHash,o=void 0,s=function(){var t=i(n.mark((function t(){var i;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r?e.getLiveCellWithBlockHash(o):e.getLiveCell(o);case 2:return i=t.sent,o=i.lastCursor,t.abrupt("return",i.objects);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),t.next=5,a(s());case 5:if(0!==(u=t.sent).length){t.next=8;break}return t.abrupt("return");case 8:c=s(),l=0,p=0;case 11:if(e.shouldSkipped(u[l],p)){t.next=17;break}return t.next=15,u[l];case 15:t.next=18;break;case 17:p++;case 18:if(++l!==u.length){t.next=27;break}return l=0,t.next=23,a(c);case 23:if(0!==(u=t.sent).length){t.next=26;break}return t.abrupt("break",29);case 26:c=s();case 27:t.next=11;break;case 29:case"end":return t.stop()}}),t)})))()},e}();t.CKBCellCollector=d},8357:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TransactionCollector=t.RPC=t.Indexer=t.CellCollector=void 0;var n=r(9804),i=r(5672),a=r(3990),o=r(3667),s=i.CkbIndexer;t.Indexer=s;var u=n.CKBCellCollector;t.CellCollector=u;var c=a.CKBIndexerTransactionCollector;t.TransactionCollector=c;var l=o.RPC;t.RPC=l},5672:function(e,t,r){"use strict";var n=r(3572).default,i=r(7162),a=r(2954).default;Object.defineProperty(t,"__esModule",{value:!0}),t.CkbIndexer=void 0;var o=r(7143),s=r(1674),u=r(6493),c=r(162),l=r(9804),p=r(2699),d=r(9531);function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var h=function(){return{stop:!1,push:!0}};function v(e,t){console.log("["+e+"] "+t)}var g=function(){function e(e,t){f(this,"medianTimeEmitters",[]),f(this,"emitters",[]),f(this,"isSubscribeRunning",!1),this.ckbIndexerUrl=e,this.ckbRpcUrl=t,this.uri=t}var t=e.prototype;return t.getCkbRpc=function(){return new u.RPC(this.ckbRpcUrl)},t.tip=function(){var e=a(i.mark((function e(){var t;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,c.request)(this.ckbIndexerUrl,"get_tip");case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.asyncSleep=function(e){return new Promise((function(t){return setTimeout(t,e)}))},t.waitForSync=function(){var e=a(i.mark((function e(t){var r;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),e.t0=parseInt,e.next=4,this.getCkbRpc().get_tip_header();case 4:e.t1=e.sent.number,r=(0,e.t0)(e.t1,16);case 6:return e.t2=parseInt,e.next=10,this.tip();case 10:if(e.t3=e.sent.block_number,!((0,e.t2)(e.t3,16)+t>=r)){e.next=14;break}return e.abrupt("return");case 14:return e.next=16,this.asyncSleep(1e3);case 16:e.next=6;break;case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.collector=function(e,t){return new l.CKBCellCollector(this,e,t)},t.request=function(){var e=a(i.mark((function e(t,r,n){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n&&(n=this.ckbIndexerUrl),e.abrupt("return",(0,c.request)(n,t,r));case 2:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}(),t.getCells=function(){var e=a(i.mark((function e(t,r,a){var o,s,u,c,l,p,d,f,v,g,b,y,w,m;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===r&&(r=h),void 0===a&&(a={}),o=[],s=a.lastCursor,u=a.sizeLimit||100,c=a.order||"asc",l=0;case 7:return p=[t,c,"0x"+u.toString(16),s],e.next=11,this.request("get_cells",p);case 11:d=e.sent,f=d.objects,s=d.last_cursor,v=n(f);case 15:if((g=v()).done){e.next=24;break}if(b=g.value,y={cell_output:b.output,data:b.output_data,out_point:b.out_point,block_number:b.block_number},w=r(l,y),m=w.stop,w.push&&o.push(y),!m){e.next=22;break}return e.abrupt("return",{objects:o,lastCursor:s});case 22:e.next=15;break;case 24:if(!(f.length<=u)){e.next=26;break}return e.abrupt("break",28);case 26:e.next=7;break;case 28:return e.abrupt("return",{objects:o,lastCursor:s});case 29:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}(),t.getTransactions=function(){var e=a(i.mark((function e(t,r){var n,a,o,s,u,c,l;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===r&&(r={}),n=[],a=r.lastCursor,o=r.sizeLimit||100,s=r.order||"asc";case 5:return u=[t,s,"0x"+o.toString(16),a],e.next=8,this.request("get_transactions",u);case 8:if(c=e.sent,l=c.objects,a=c.last_cursor,n=n.concat(l),!(l.length<=o)){e.next=14;break}return e.abrupt("break",16);case 14:e.next=5;break;case 16:return e.abrupt("return",{objects:n,lastCursor:a});case 17:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),t.running=function(){return!0},t.start=function(){v("warn","deprecated: no need to start the ckb-indexer manually")},t.startForever=function(){v("warn","deprecated: no need to startForever the ckb-indexer manually")},t.stop=function(){v("warn","deprecated: no need to stop the ckb-indexer manually")},t.subscribe=function(e){if(this.isSubscribeRunning=!0,this.scheduleLoop(),e.lock&&e.type)throw new Error("The notification machanism only supports you subscribing for one script once so far!");null===e.toBlock&&null===e.skip||v("warn","The passing fields such as toBlock and skip are ignored in subscribe() method.");var t=new d.IndexerEmitter;if(t.argsLen=e.argsLen,t.outputData=e.data,e.fromBlock&&o.utils.assertHexadecimal("fromBlock",e.fromBlock),t.fromBlock=e.fromBlock?BigInt(e.fromBlock):0n,e.lock)s.validators.ValidateScript(e.lock),t.lock=e.lock;else{if(!e.type||"empty"===e.type)throw new Error("Either lock or type script must be provided!");s.validators.ValidateScript(e.type),t.type=e.type}return this.emitters.push(t),t},t.loop=function(){var e=this;this.isSubscribeRunning&&this.poll().then((function(t){e.scheduleLoop(t)})).catch((function(t){v("error","Error occurs: "+t+" "+t.stack+", stopping indexer!"),e.isSubscribeRunning=!1}))},t.scheduleLoop=function(e){var t=this;void 0===e&&(e=1),setTimeout((function(){t.loop()}),e)},t.poll=function(){var e=a(i.mark((function e(){var t,r,n,a,o,s,u,c,l;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=1,e.next=3,this.tip();case 3:if(r=e.sent,n=r.block_number,a=r.block_hash,"0x0"!==n){e.next=11;break}return e.next=8,this.request("get_block_by_number",[n],this.ckbRpcUrl);case 8:return o=e.sent,e.next=11,this.publishAppendBlockEvents(o);case 11:return s=BigInt(n)+BigInt(1),e.next=14,this.request("get_block_by_number",["0x"+s.toString(16)],this.ckbRpcUrl);case 14:if(!(u=e.sent)){e.next=28;break}if(u.header.parent_hash!==a){e.next=21;break}return e.next=19,this.publishAppendBlockEvents(u);case 19:e.next=26;break;case 21:return e.next=23,this.request("get_block_by_number",[n],this.ckbRpcUrl);case 23:return c=e.sent,e.next=26,this.publishAppendBlockEvents(c);case 26:e.next=34;break;case 28:return e.next=30,this.request("get_block_by_number",[n],this.ckbRpcUrl);case 30:return l=e.sent,e.next=33,this.publishAppendBlockEvents(l);case 33:t=3e3;case 34:return e.abrupt("return",t);case 35:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.publishAppendBlockEvents=function(){var e=a(i.mark((function e(t){var r,a,o,s=this;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=i.mark((function e(){var r,a,u,l,p,d,f,h,v,g,b;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=o.value,a=r[0],u=r[1],l=t.header.number,!(a>0)){e.next=8;break}return p=u.inputs.map((function(e,t){return{id:t,jsonrpc:"2.0",method:"get_transaction",params:[e.previous_output.tx_hash]}})),e.next=6,(0,c.requestBatch)(s.ckbRpcUrl,p).then((function(e){return e.map((function(e,t){var r=u.inputs[t].previous_output.index;return{output:e.result.transaction.outputs[parseInt(r)],outputData:e.result.transaction.outputs_data[parseInt(r)]}}))}));case 6:e.sent.forEach((function(e){var t=e.output,r=e.outputData;s.filterEvents(t,l,r)}));case 8:for(d=n(u.outputs.entries());!(f=d()).done;)h=f.value,v=h[0],g=h[1],b=u.outputs_data[v],s.filterEvents(g,l,b);case 9:case"end":return e.stop()}}),e)})),a=n(t.transactions.entries());case 2:if((o=a()).done){e.next=6;break}return e.delegateYield(r(),"t0",4);case 4:e.next=2;break;case 6:return e.next=8,this.emitMedianTimeEvents();case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.filterEvents=function(e,t,r){for(var i,a=n(this.emitters);!(i=a()).done;){var o=i.value;void 0!==o.lock&&this.checkFilterOptions(o,t,r,o.lock,e.lock)&&o.emit("changed")}if(null!==e.type)for(var s,u=n(this.emitters);!(s=u()).done;){var c=s.value;void 0!==c.type&&this.checkFilterOptions(c,t,r,c.type,e.type)&&c.emit("changed")}},t.checkFilterOptions=function(e,t,r,n,i){var a=!e.fromBlock||e.fromBlock<=BigInt(t),o="any"===e.outputData||!e.outputData||e.outputData===r,s=!i||n.code_hash===i.code_hash&&n.hash_type===i.hash_type&&this.checkArgs(e.argsLen,n.args,i.args);return a&&o&&s},t.checkArgs=function(e,t,r){return-1===e||!e&&0!==e?t===r:("number"==typeof e&&r.length===2*e+2||"any"===e)&&r.substring(0,t.length)===t},t.emitMedianTimeEvents=function(){var e=a(i.mark((function e(){var t,r,a,o;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.medianTimeEmitters.length){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,c.request)(this.ckbRpcUrl,"get_blockchain_info");case 4:for(t=e.sent,r=t.median_time,a=n(this.medianTimeEmitters);!(o=a()).done;)o.value.emit("changed",r);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.subscribeMedianTime=function(){this.isSubscribeRunning=!0,this.scheduleLoop();var e=new p.EventEmitter;return this.medianTimeEmitters.push(e),e},e}();t.CkbIndexer=g},3667:function(e,t,r){"use strict";var n=r(7162),i=r(2954).default;Object.defineProperty(t,"__esModule",{value:!0}),t.RPC=void 0;var a=r(1674),o={get:function(e,t){return i(n.mark((function r(){var i,a,o=arguments;return n.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(i=e.rpc)[t].apply(i,o);case 2:return a=r.sent,r.abrupt("return",a);case 4:case"end":return r.stop()}}),r)})))}},s=function(){function e(e){this.rpc=new a.RPC(e)}return e.prototype.getProxy=function(){return new Proxy(this,o)},e}(),u=function(){function e(e){this.rpcProxy=new s(e).getProxy()}var t=e.prototype;return t.get_tip=function(){var e=i(n.mark((function e(){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpcProxy.get_tip());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.get_cells=function(){var e=i(n.mark((function e(t,r,i,a){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpcProxy.get_cells(t,r,i,a));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i){return e.apply(this,arguments)}}(),t.get_transactions=function(){var e=i(n.mark((function e(t,r,i,a){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpcProxy.get_transactions(t,r,i,a));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i){return e.apply(this,arguments)}}(),t.get_cells_capacity=function(){var e=i(n.mark((function e(t){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpcProxy.get_cells_capacity(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.get_indexer_info=function(){var e=i(n.mark((function e(){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpcProxy.get_indexer_info());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e}();t.RPC=u},162:function(e,t,r){"use strict";var n=r(7162),i=r(2954).default;Object.defineProperty(t,"__esModule",{value:!0}),t.getHexStringBytes=t.generateSearchKey=void 0,t.instanceOfScriptWrapper=u,t.requestBatch=t.request=void 0;var a,o=r(7143),s=(a=r(6279))&&a.__esModule?a:{default:a};function u(e){return"object"==typeof e&&null!=e&&"script"in e}var c=function(e){return u(e)?e.script:e};t.generateSearchKey=function(e){var t=void 0,r={},n=void 0;if(e.lock){if(t=c(e.lock),n="lock",e.type&&"string"!=typeof e.type){var i=c(e.type);r.script=i}}else if(e.type&&"string"!=typeof e.type){t=c(e.type),n="type"}var a=null;if(e.fromBlock&&e.toBlock&&(a=[e.fromBlock,"0x"+(BigInt(e.toBlock)+1n).toString(16)]),a&&(r.block_range=a),e.outputDataLenRange&&(r.output_data_len_range=e.outputDataLenRange),e.outputCapacityRange&&(r.output_capacity_range=e.outputCapacityRange),!t)throw new Error("Either lock or type script must be provided!");if(!n)throw new Error("script_type must be provided");return{script:t,script_type:n,filter:r}};t.getHexStringBytes=function(e){return o.utils.assertHexString("",e),Math.ceil(e.substr(2).length/2)};var l=function(){var e=i(n.mark((function e(t,r){var i,a;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,s.default)(t,{method:"POST",body:JSON.stringify(r),headers:{"Content-Type":"application/json"}});case 2:if(200===(i=e.sent).status){e.next=5;break}throw new Error("indexer request failed with HTTP code "+i.status);case 5:return e.next=7,i.json();case 7:if(void 0===(a=e.sent).error){e.next=10;break}throw new Error("indexer request rpc failed with error: "+JSON.stringify(a.error));case 10:return e.abrupt("return",a);case 11:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}();t.requestBatch=l;var p=function(){var e=i(n.mark((function e(t,r,i){var a,o;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,s.default)(t,{method:"POST",body:JSON.stringify({id:0,jsonrpc:"2.0",method:r,params:i}),headers:{"Content-Type":"application/json"}});case 2:if(200===(a=e.sent).status){e.next=5;break}throw new Error("indexer request failed with HTTP code "+a.status);case 5:return e.next=7,a.json();case 7:if(void 0===(o=e.sent).error){e.next=10;break}throw new Error("indexer request rpc failed with error: "+JSON.stringify(o.error));case 10:return e.abrupt("return",o.result);case 11:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}();t.request=p},3990:function(e,t,r){"use strict";var n=r(7162),i=r(2954).default,a=r(8111).default,o=r(7111).default,s=r(4879).default,u=r(8133).default;Object.defineProperty(t,"__esModule",{value:!0}),t.CKBIndexerTransactionCollector=void 0;var c=r(7143),l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=p(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(162));function p(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(p=function(e){return e?r:t})(e)}function d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var f=function(e){function t(t,r,o,s){var u;u=e.call(this,t,r,s)||this,d(a(u),"getTransactionListFromRpc",function(){var e=i(n.mark((function e(t){var r,i;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.objects.map((function(e,t){return{id:t,jsonrpc:"2.0",method:"get_transaction",params:[e.tx_hash]}})),e.next=3,l.requestBatch(u.CKBRpcUrl,r).then((function(e){return e.map((function(e){if(!u.filterOptions.skipMissing&&!e.result)throw new Error("Transaction "+t.objects[e.id].tx_hash+" is missing!");var r=t.objects[e.id].io_type,n=t.objects[e.id].io_index;return Object.assign({ioType:r,ioIndex:n},e.result)}))}));case 3:return i=e.sent,e.abrupt("return",i);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),d(a(u),"isLockArgsLenMatched",(function(e,t){return!t||("any"===t||(-1===t||l.getHexStringBytes(e)===t))})),d(a(u),"isCellScriptArgsValid",(function(e){if(u.queries.lock){var t=l.instanceOfScriptWrapper(u.queries.lock)?u.queries.lock.argsLen:u.queries.argsLen;if(!u.isLockArgsLenMatched(e.lock.args,t))return!1}if(u.queries.type&&"empty"!==u.queries.type){var r,n=l.instanceOfScriptWrapper(u.queries.type)?u.queries.type.argsLen:u.queries.argsLen;if(!u.isLockArgsLenMatched(null===(r=e.type)||void 0===r?void 0:r.args,n))return!1}return!u.queries.type||"empty"!==u.queries.type||!e.type})),d(a(u),"filterByIoType",(function(e,t){return"both"===t?e:"input"===t||"output"===t?e.filter((function(e){return e.io_type===t||"both"===e.io_type})):e})),d(a(u),"filterByTypeIoTypeAndLockIoType",(function(e,t){var r=e;return l.instanceOfScriptWrapper(t.lock)&&t.lock.ioType&&(r=u.filterByIoType(r,t.lock.ioType)),l.instanceOfScriptWrapper(t.type)&&t.type.ioType&&(r=u.filterByIoType(r,t.type.ioType)),r})),u.indexer=t,u.queries=r,u.CKBRpcUrl=o,u.options=s;return u.filterOptions=Object.assign({},{skipMissing:!1,includeStatus:!0},u.options),u}o(t,e);var r=t.prototype;return r.getTransactions=function(){var e=i(n.mark((function e(t){var r,i,a,o,s,u=this;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r={sizeLimit:this.queries.bufferSize,order:this.queries.order},t&&(r.lastCursor=t),i={objects:[],lastCursor:""},!l.instanceOfScriptWrapper(this.queries.lock)||!l.instanceOfScriptWrapper(this.queries.type)){e.next=10;break}return e.next=6,this.getTransactionByLockAndTypeIndependent(r);case 6:i=e.sent,t=i.lastCursor,e.next=14;break;case 10:return e.next=12,this.indexer.getTransactions(l.generateSearchKey(this.queries),r);case 12:i=e.sent,t=i.lastCursor;case 14:if(i.objects=this.filterByTypeIoTypeAndLockIoType(i.objects,this.queries),0!==i.objects.length){e.next=17;break}return e.abrupt("return",{objects:[],lastCursor:t});case 17:return e.next=19,this.getTransactionListFromRpc(i);case 19:if(a=e.sent,o=[],a.forEach((function(e){if("input"===e.ioType){var t=e.transaction.inputs[parseInt(e.ioIndex)].previous_output;o.push({id:t.index+"-"+e.transaction.hash,jsonrpc:"2.0",method:"get_transaction",params:[t.tx_hash]})}})),!(o.length>0)){e.next=25;break}return e.next=25,l.requestBatch(this.CKBRpcUrl,o).then((function(e){e.forEach((function(e){var t=e.id.toString().split("-"),r=t[0],n=t[1],i=e.result.transaction.outputs[parseInt(r)],o=a.find((function(e){return e.transaction.hash===n}));o&&(o.inputCell=i)}))}));case 25:return a=a.filter((function(e){if("input"===e.ioType&&e.inputCell)return u.isCellScriptArgsValid(e.inputCell);var t=e.transaction.outputs[parseInt(e.ioIndex)];return u.isCellScriptArgsValid(t)})),s=a.map((function(e){return{transaction:e.transaction,tx_status:e.tx_status}})),e.abrupt("return",{objects:s,lastCursor:t});case 28:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),r.getTransactionByLockAndTypeIndependent=function(){var e=i(n.mark((function e(t){var r,i,a,o,s,u,c,p,d,f,h,v;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object.assign({},t),i=Object.assign({},t),t.lastCursor&&(a=t.lastCursor.split("-"),o=a[0],s=a[1],i.lastCursor=o,r.lastCursor=s),u=Object.assign({},this.queries,{type:void 0}),e.next=6,this.indexer.getTransactions(l.generateSearchKey(u),r);case 6:return c=e.sent,p=Object.assign({},this.queries,{lock:void 0}),e.next=10,this.indexer.getTransactions(l.generateSearchKey(p),i);case 10:return d=e.sent,f=function(e,t){var r=[];return e.forEach((function(e){var n=t.find((function(t){return t.tx_hash===e.tx_hash}));if(n){var i="output"===e.io_type?e:n;r.push(Object.assign({},i,{io_type:"both"}))}})),r}(d.objects,c.objects),h=c.lastCursor+"-"+d.lastCursor,v=f,e.abrupt("return",{objects:v,lastCursor:h});case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),r.count=function(){var e=i(n.mark((function e(){var t,r,a,o,s,u,c,l=this;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=void 0,r=function(){var e=i(n.mark((function e(){var r;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.getTransactions(t);case 2:return r=e.sent,t=r.lastCursor,e.abrupt("return",r.objects);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),a=0,e.next=5,r();case 5:if(0!==(o=e.sent).length){e.next=8;break}return e.abrupt("return",0);case 8:s=r(),u=0,c=0;case 11:if(this.queries.skip&&c<this.queries.skip?c++:a+=1,++u!==o.length){e.next=22;break}return u=0,e.next=18,s;case 18:if(0!==(o=e.sent).length){e.next=21;break}return e.abrupt("break",24);case 21:s=r();case 22:e.next=11;break;case 24:return e.abrupt("return",a);case 25:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),r.getTransactionHashes=function(){var e=i(n.mark((function e(){var t,r,a,o,s,u,c,l=this;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=void 0,r=function(){var e=i(n.mark((function e(){var r;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.getTransactions(t);case 2:return r=e.sent,t=r.lastCursor,e.abrupt("return",r.objects);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),a=[],e.next=5,r();case 5:if(0!==(o=e.sent).length){e.next=8;break}return e.abrupt("return",[]);case 8:s=r(),u=0,c=0;case 11:if(this.queries.skip&&c<this.queries.skip?c++:o[u].transaction.hash&&a.push(o[u].transaction.hash),++u!==o.length){e.next=22;break}return u=0,e.next=18,s;case 18:if(0!==(o=e.sent).length){e.next=21;break}return e.abrupt("break",24);case 21:s=r();case 22:e.next=11;break;case 24:return e.abrupt("return",a);case 25:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),r.collect=function(){var e=this;return u(n.mark((function t(){var r,a,o,u,c,l;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=void 0,a=function(){var t=i(n.mark((function t(){var i;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getTransactions(r);case 2:return i=t.sent,r=i.lastCursor,t.abrupt("return",i.objects);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),t.next=4,s(a());case 4:if(0!==(o=t.sent).length){t.next=7;break}return t.abrupt("return",0);case 7:u=a(),c=0,l=0;case 10:if(!(e.queries.skip&&l<e.queries.skip)){t.next=15;break}l++,t.next=22;break;case 15:if(!e.filterOptions.includeStatus){t.next=20;break}return t.next=18,o[c];case 18:t.next=22;break;case 20:return t.next=22,o[c].transaction;case 22:if(++c!==o.length){t.next=31;break}return c=0,t.next=27,s(u);case 27:if(0!==(o=t.sent).length){t.next=30;break}return t.abrupt("break",33);case 30:u=a();case 31:t.next=10;break;case 33:case"end":return t.stop()}}),t)})))()},t}(c.indexer.TransactionCollector);t.CKBIndexerTransactionCollector=f},9531:function(e,t,r){"use strict";var n=r(7111).default;Object.defineProperty(t,"__esModule",{value:!0}),t.IndexerEmitter=void 0;var i=function(e){function t(){return e.apply(this,arguments)||this}return n(t,e),t}(r(2699).EventEmitter);t.IndexerEmitter=i},82:function(e,t,r){"use strict";var n=r(3572).default,i=r(2954).default,a=r(7162),o=r(4879).default,s=r(8133).default,u=r(1799).default;Object.defineProperty(t,"__esModule",{value:!0}),t.CellCollector=void 0,t.checkLimit=S,t.default=void 0,t.injectCapacity=P,t.prepareSigningEntries=A,t.setupInputCell=_,t.setupOutputCell=C,t.withdraw=z;var c=r(7143),l=r(3664),p=r(9336),d=r(1674),f=r(7623),h=r(4166),v=r(8278),g=c.values.ScriptValue,b=c.utils,y=b.CKBHasher,w=b.ckbHash,m=b.readBigUInt128LE,x=function(){function e(e,t,r){var n=void 0===r?{}:r,i=n.config,a=void 0===i?void 0:i,o=n.queryOptions,s=void 0===o?{}:o;if(!t)throw new Error("Cell provider is missing!");a=a||(0,l.getConfig)(),this.fromScript=(0,h.parseFromInfo)(e,{config:a}).fromScript,this.config=a,s=Object.assign({},s,{lock:this.fromScript,type:s.type||"empty"}),this.cellCollector=t.collector(s)}return e.prototype.collect=function(){var e=this;return s(a.mark((function t(){var r,n,i,s,c,l;return a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((0,v.isAcpScript)(e.fromScript,e.config)){t.next=2;break}return t.abrupt("return");case 2:r=!1,n=!1,t.prev=4,s=u(e.cellCollector.collect());case 6:return t.next=8,o(s.next());case 8:if(!(r=!(c=t.sent).done)){t.next=15;break}return l=c.value,t.next=12,l;case 12:r=!1,t.next=6;break;case 15:t.next=21;break;case 17:t.prev=17,t.t0=t.catch(4),n=!0,i=t.t0;case 21:if(t.prev=21,t.prev=22,!r||null==s.return){t.next=26;break}return t.next=26,o(s.return());case 26:if(t.prev=26,!n){t.next=29;break}throw i;case 29:return t.finish(26);case 30:return t.finish(21);case 31:case"end":return t.stop()}}),t,null,[[4,17,21,31],[22,,26,30]])})))()},e}();function _(e,t,r,n){return k.apply(this,arguments)}function k(){return(k=i(a.mark((function e(t,r,n,i){var o,s,u,p,f,h,b,y,w,m,x,_,k,S,C,E,P,I;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=(o=void 0===i?{}:i).config,u=void 0===s?void 0:s,p=o.defaultWitness,f=void 0===p?"0x":p,h=o.since,b=void 0===h?void 0:h,u=u||(0,l.getConfig)(),y=r.cell_output.lock,(0,v.isAcpScript)(y,u)){e.next=5;break}throw new Error("Not anyone-can-pay input!");case 5:if(t=t.update("inputs",(function(e){return e.push(r)})),b&&(t=t.update("inputSinces",(function(e){return e.set(t.get("inputs").size-1,b)}))),t=t.update("witnesses",(function(e){return e.push(f)})),w={cell_output:{capacity:r.cell_output.capacity,lock:r.cell_output.lock,type:r.cell_output.type},data:r.data},t=(t=t.update("outputs",(function(e){return e.push(w)}))).update("fixedEntries",(function(e){return e.push({field:"outputs",index:t.get("outputs").size-1})})),m=u.SCRIPTS.ANYONE_CAN_PAY){e.next=14;break}throw new Error("ANYONE_CAN_PAY script not defined in config!");case 14:if(x={tx_hash:m.TX_HASH,index:m.INDEX},t=(0,v.addCellDep)(t,{out_point:x,dep_type:m.DEP_TYPE}),-1===(_=t.get("inputs").findIndex((function(e){return new g(e.cell_output.lock,{validate:!1}).equals(new g(y,{validate:!1}))})))){e.next=32;break}for(;_>=t.get("witnesses").size;)t=t.update("witnesses",(function(e){return e.push("0x")}));if(k=t.get("witnesses").get(_),S={lock:v.SECP_SIGNATURE_PLACEHOLDER},"0x"===k){e.next=30;break}if(C=new c.core.WitnessArgs(new d.Reader(k)),!(E=C.getLock()).hasValue()||new d.Reader(E.value().raw()).serializeJson()===S.lock){e.next=26;break}throw new Error("Lock field in first witness is set aside for signature!");case 26:(P=C.getInputType()).hasValue()&&(S.input_type=new d.Reader(P.value().raw()).serializeJson()),(I=C.getOutputType()).hasValue()&&(S.output_type=new d.Reader(I.value().raw()).serializeJson());case 30:k=new d.Reader(c.core.SerializeWitnessArgs(d.normalizers.NormalizeWitnessArgs(S))).serializeJson(),t=t.update("witnesses",(function(e){return e.set(_,k)}));case 32:return e.abrupt("return",t);case 33:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e,t){var r,n;if(e.length>=46&&(r=Math.pow(10n,BigInt("0x"+e.slice(44,46)))),e.length>=44&&(n=Math.pow(10n,BigInt("0x"+e.slice(42,44)))*Math.pow(10n,8n)),n&&r){if(t<n)throw new Error("capacity("+t+") less than toAddress minimal capacity limit("+n+"), and amount less then toAddress minimal amount limit("+r+")! If you want to transfer sudt, maybe sudt.transfer can help you.")}else if(n&&t<n)throw new Error("capacity("+t+") less than toAddress minimal capacity limit("+n+")!")}function C(e,t,r){return E.apply(this,arguments)}function E(){return(E=i(a.mark((function e(t,r,n){var i,o,s,u,c,d,f,h,g,b,y;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=(void 0===n?{}:n).config,o=(o=void 0===i?void 0:i)||(0,l.getConfig)(),s=r.cell_output.lock,u=BigInt(r.cell_output.capacity),S(s.args,u),c=t.get("cellProvider")){e.next=8;break}throw new Error("Cell Provider is missing!");case 8:return d=(0,p.generateAddress)(s,{config:o}),f=new x(d,c,{config:o}),e.next=12,f.collect().next();case 12:if(h=e.sent.value,g=u,h&&(g=u+BigInt(h.cell_output.capacity),t=(t=t.update("inputs",(function(e){return e.push(h)}))).update("witnesses",(function(e){return e.push("0x")}))),r.cell_output.capacity="0x"+g.toString(16),t=t.update("outputs",(function(e){return e.push(r)})),!h){e.next=23;break}if(b=o.SCRIPTS.ANYONE_CAN_PAY){e.next=21;break}throw new Error("ANYONE_CAN_PAY script not defined in config!");case 21:y={tx_hash:b.TX_HASH,index:b.INDEX},t=(0,v.addCellDep)(t,{out_point:y,dep_type:b.DEP_TYPE});case 23:return e.abrupt("return",t);case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e,t,r,n,i){return I.apply(this,arguments)}function I(){return(I=i(a.mark((function e(t,r,i,o,s){var c,d,h,v,b,y,w,m,x,k,S,C,E,P,I;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=(void 0===s?{}:s).config,d=(d=void 0===c?void 0:c)||(0,l.getConfig)(),!(i>=r.get("outputs").size)){e.next=4;break}throw new Error("Invalid output index!");case 4:if(o=BigInt(o),d.SCRIPTS.ANYONE_CAN_PAY){e.next=8;break}throw new Error("Provided config does not have ANYONE_CAN_PAY script setup!");case 8:for(h=t.fromScript,v=r.get("fixedEntries").filter((function(e){return"outputs"===e.field})).maxBy((function(e){return e.index})),b=v?v.index+1:0;b<r.get("outputs").size&&o>0;b++)y=r.get("outputs").get(b),new g(y.cell_output.lock,{validate:!1}).equals(new g(h,{validate:!1}))&&(w=BigInt(y.cell_output.capacity),m=w-(0,p.minimalCellCapacity)(y),o-=x=o>=m?m:o,y.cell_output.capacity="0x"+(w-x).toString(16));if(r=r.update("outputs",(function(e){return e.filter((function(e){return BigInt(e.cell_output.capacity)!==BigInt(0)}))})),k=function(e){return e.out_point.tx_hash+"_"+e.out_point.index},!(o>0n)){e.next=16;break}return e.delegateYield(a.mark((function e(){var i,s,c,l,v,g,b,y,w;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i={cell_output:{capacity:"0x0",lock:h,type:void 0},data:"0x",out_point:void 0,block_hash:void 0},s=0n,c=(0,p.minimalCellCapacity)(i),l=(0,f.Set)(),v=n(r.get("inputs"));!(g=v()).done;)b=g.value,l=l.add(k(b));S=!1,C=!1,e.prev=7,y=a.mark((function e(){var t,n,u,p,f;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=I.value,!l.has(k(t))){e.next=3;break}return e.abrupt("return","continue");case 3:return e.next=5,_(r,t,void 0,{config:d});case 5:if(r=e.sent,n=r.get("outputs").size-1,r=r.update("outputs",(function(e){return e.remove(n)})),(u=r.get("fixedEntries").findIndex((function(e){return"outputs"===e.field&&e.index===n})))>=0&&(r=r.update("fixedEntries",(function(e){return e.remove(u)}))),p=BigInt(t.cell_output.capacity),(f=p)>o&&(f=o),s+=p-f,!(0n===(o-=f)&&s>=c)){e.next=17;break}return e.abrupt("return","break");case 17:i.cell_output.capacity="0x"+s.toString(16),r=r.update("outputs",(function(e){return e.push(i)}));case 19:case"end":return e.stop()}}),e)})),P=u(t.collect());case 10:return e.next=12,P.next();case 12:if(!(S=!(I=e.sent).done)){e.next=22;break}return e.delegateYield(y(),"t0",14);case 14:if("continue"!==(w=e.t0)){e.next=17;break}return e.abrupt("continue",19);case 17:if("break"!==w){e.next=19;break}return e.abrupt("break",22);case 19:S=!1,e.next=10;break;case 22:e.next=28;break;case 24:e.prev=24,e.t1=e.catch(7),C=!0,E=e.t1;case 28:if(e.prev=28,e.prev=29,!S||null==P.return){e.next=33;break}return e.next=33,P.return();case 33:if(e.prev=33,!C){e.next=36;break}throw E;case 36:return e.finish(33);case 37:return e.finish(28);case 38:if(!(o>0n||s<c)){e.next=40;break}throw new Error("Not enough capacity in from address!");case 40:i.cell_output.capacity="0x"+s.toString(16),r=r.update("outputs",(function(e){return e.push(i)}));case 42:case"end":return e.stop()}}),e,null,[[7,24,28,38],[29,,33,37]])}))(),"t0",16);case 16:return e.abrupt("return",r);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(e,t){var r=(void 0===t?{}:t).config,n=void 0===r?void 0:r,i="ANYONE_CAN_PAY",a=(n=n||(0,l.getConfig)()).SCRIPTS[i];if(!a)throw new Error("Provided config does not have ANYONE_CAN_PAY script setup!");for(var o=(0,f.Set)(),s=(0,p.createTransactionFromSkeleton)(e),u=w(c.core.SerializeRawTransaction(d.normalizers.NormalizeRawTransaction(s))).serializeJson(),h=e.get("inputs"),b=e.get("witnesses"),x=e.get("signingEntries"),_=function(t){var r=h.get(t);if(a.CODE_HASH===r.cell_output.lock.code_hash&&a.HASH_TYPE===r.cell_output.lock.hash_type&&!o.has(r.cell_output.lock.args)){o=o.add(r.cell_output.lock.args);var n=e.get("outputs").filter((function(e){return new g(e.cell_output.lock,{validate:!1}).equals(new g(r.cell_output.lock,{validate:!1}))})),i=n.map((function(e){return BigInt(e.cell_output.capacity)})).reduce((function(e,t){return e+t}),0n),s=n.filter((function(e){return"0x"!==e.data})).map((function(e){return m(e.data)})).reduce((function(e,t){return e+t}),0n),l=h.filter((function(e){return new g(e.cell_output.lock,{validate:!1}).equals(new g(r.cell_output.lock,{validate:!1}))})),p=l.map((function(e){return BigInt(e.cell_output.capacity)})).reduce((function(e,t){return e+t}),0n),d=l.filter((function(e){return"0x"!==e.data})).map((function(e){return m(e.data)})).reduce((function(e,t){return e+t}),0n);if(p<=i&&d<=s)return"continue";var f=new c.values.ScriptValue(r.cell_output.lock,{validate:!1}),w=new y;if(w.update(u),t>=b.size)throw new Error("The first witness in the script group starting at input index "+t+" does not exist, maybe some other part has invalidly tampered the transaction?");(0,v.hashWitness)(w,b.get(t));for(var _=t+1;_<h.size&&_<b.size;_++){var k=h.get(_);f.equals(new c.values.ScriptValue(k.cell_output.lock,{validate:!1}))&&(0,v.hashWitness)(w,b.get(_))}for(var S=h.size;S<b.size;S++)(0,v.hashWitness)(w,b.get(S));var C={type:"witness_args_lock",index:t,message:w.digestHex()};x=x.push(C)}},k=0;k<h.size;k++)_(k);return e=e.set("signingEntries",x)}function z(e,t,r,n,i){return B.apply(this,arguments)}function B(){return(B=i(a.mark((function e(t,r,n,i,o){var s,u,c,d,f,h,g,b,y,w,m,k;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=(void 0===o?{}:o).config,u=(u=void 0===s?void 0:s)||(0,l.getConfig)(),(0,v.isAcpScript)(r.cell_output.lock,u)){e.next=4;break}throw new Error("fromInput is not a ANYONE_CAN_PAY cell!");case 4:if(i=BigInt(i),c=BigInt(r.cell_output.capacity),d=(0,p.minimalCellCapacity)(r),i>=0n&&i<=c-d||i===c){e.next=9;break}throw new Error("capacity must be in [0, "+(c-d)+"] or "+c+" !");case 9:if(f=(0,p.parseAddress)(n,{config:u}),h={cell_output:{capacity:"0x"+i.toString(16),lock:f,type:void 0},data:"0x",out_point:void 0,block_hash:void 0},!(0,v.isAcpScript)(f,u)){e.next=26;break}if(S(f.args,i),g=t.get("cellProvider")){e.next=16;break}throw new Error("Cell Provider is missing!");case 16:return b=new x(n,g,{config:u}),e.next=19,b.collect().next();case 19:if(y=e.sent.value){e.next=22;break}throw new Error("toAddress ANYONE_CAN_PAY input not found!");case 22:w=BigInt(i)+BigInt(y.cell_output.capacity),h.cell_output.capacity="0x"+w.toString(16),t=(t=t.update("inputs",(function(e){return e.push(y)}))).update("witnesses",(function(e){return e.push("0x")}));case 26:return t=t.update("outputs",(function(e){return e.push(h)})),e.next=29,_(t,r,(0,p.generateAddress)(r.cell_output.lock,{config:u}),{config:u});case 29:return t=e.sent,m=t.get("outputs").size-1,t=t.update("outputs",(function(e){return e.remove(m)})),(k=t.get("fixedEntries").findIndex((function(e){return"outputs"===e.field&&e.index===m})))>=0&&(t=t.update("fixedEntries",(function(e){return e.remove(k)}))),i!==c&&(t=t.update("outputs",(function(e){return e.push({cell_output:{capacity:"0x"+(c-i).toString(16),lock:r.cell_output.lock,type:r.cell_output.type},data:r.data})}))),e.abrupt("return",t);case 36:case"end":return e.stop()}}),e)})))).apply(this,arguments)}t.CellCollector=x;var T={CellCollector:x,setupInputCell:_,setupOutputCell:C,injectCapacity:P,prepareSigningEntries:A,withdraw:z};t.default=T},844:function(e,t,r){"use strict";var n=r(8834).Buffer,i=r(7162),a=r(3572).default,o=r(2954).default,s=r(1799).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.injectCapacity=I,t.payFee=z,t.payFeeByFeeRate=N,t.prepareSigningEntries=T,t.registerCustomLockScriptInfos=S,t.setupInputCell=R,t.transfer=E;var u=r(9336),c=m(r(3009)),l=r(4166),p=m(r(8608)),d=r(3664),f=m(r(2584)),h=r(7143),v=m(r(82)),g=r(7623),b=r(3677),y=r(1674),w=r(8278);function m(e){return e&&e.__esModule?e:{default:e}}var x=h.values.ScriptValue;function _(e,t){console.log("["+e+"] "+t)}var k={configHashCode:0,_predefinedInfos:[],_customInfos:[],get infos(){return[].concat(this._predefinedInfos,this._customInfos)}};function S(e){k._customInfos=e}function C(e){var t=(void 0===e?{}:e).config,r=void 0===t?void 0:t;r=r||(0,d.getConfig)();var i=function(){var e=r.SCRIPTS.SECP256K1_BLAKE160,t=r.SCRIPTS.SECP256K1_BLAKE160_MULTISIG,n=r.SCRIPTS.ANYONE_CAN_PAY,i=[];return e?i.push({code_hash:e.CODE_HASH,hash_type:e.HASH_TYPE,lockScriptInfo:p.default}):_("warn","SECP256K1_BLAKE160 script info not found in config!"),t?i.push({code_hash:t.CODE_HASH,hash_type:t.HASH_TYPE,lockScriptInfo:c.default}):_("warn","SECP256K1_BLAKE160_MULTISIG script info not found in config!"),n?i.push({code_hash:n.CODE_HASH,hash_type:n.HASH_TYPE,lockScriptInfo:v.default}):_("warn","ANYONE_CAN_PAY script info not found in config!"),i},a=h.utils.hashCode(n.from(JSON.stringify(r)));0===k.infos.length?(k._predefinedInfos=i(),k.configHashCode=a):a!==k.configHashCode&&(_("warn","`config` changed, regenerate lockScriptInfos!"),k._predefinedInfos=i(),k.configHashCode=a)}function E(e,t,r,n,i,a,o){return P.apply(this,arguments)}function P(){return(P=o(i.mark((function e(t,r,n,a,o,s,c){var l,p,h,v,g,b,y,w,m,x;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p=(l=void 0===c?{}:c).config,h=void 0===p?void 0:p,v=l.useLocktimeCellsFirst,g=void 0===v||v,b=l.LocktimePoolCellCollector,y=void 0===b?f.default.CellCollector:b,h=h||(0,d.getConfig)(),n){e.next=4;break}throw new Error("You must provide a to address!");case 4:if(w=(0,u.parseAddress)(n,{config:h}),m={cell_output:{capacity:"0x"+BigInt(a).toString(16),lock:w,type:void 0},data:"0x"},C({config:h}),!(x=k.infos.find((function(e){return e.code_hash===w.code_hash&&e.hash_type===w.hash_type})))||!("setupOutputCell"in x.lockScriptInfo)){e.next=14;break}return e.next=11,x.lockScriptInfo.setupOutputCell(t,m,{config:h});case 11:t=e.sent,e.next=15;break;case 14:t=t.update("outputs",(function(e){return e.push(m)}));case 15:return e.next=17,I(t,r,a,o,s,{config:h,useLocktimeCellsFirst:g,LocktimePoolCellCollector:y});case 17:return t=e.sent,e.abrupt("return",t);case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(e,t,r,n,i,a){return A.apply(this,arguments)}function A(){return(A=o(i.mark((function e(t,r,n,a,o,s){var c,p,h,v,g,b,y,w,m,x,_,k,S,C,E,P,I,A,z,B;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p=(c=void 0===s?{}:s).config,h=void 0===p?void 0:p,v=c.useLocktimeCellsFirst,g=void 0===v||v,b=c.LocktimePoolCellCollector,y=void 0===b?f.default.CellCollector:b,w=c.enableDeductCapacity,m=void 0===w||w,h=h||(0,d.getConfig)(),n=BigInt(n),x=BigInt(n),0!==r.length){e.next=6;break}throw new Error("No from info provided!");case 6:if(_=(0,l.parseFromInfo)(a||r[0],{config:h}).fromScript,k={cell_output:{capacity:"0x0",lock:_,type:void 0},data:"0x"},S=(0,u.minimalCellCapacity)(k),C=0n,!g){e.next=36;break}if(!o){e.next=18;break}return e.next=14,f.default.injectCapacityWithoutChange(t,r,x,o,S,{config:h,LocktimeCellCollector:y,enableDeductCapacity:m});case 14:E=e.sent,t=E.txSkeleton,x=E.capacity,C=E.changeCapacity;case 18:if(!(x>0n)){e.next=27;break}return e.next=21,O(t,r,x,S,{config:h,enableDeductCapacity:m});case 21:P=e.sent,t=P.txSkeleton,x=P.capacity,C=P.changeCapacity,e.next=34;break;case 27:if(!(0n===x&&C>0n&&C<S)){e.next=34;break}return e.next=30,O(t,r,S-C,0n,{config:h,enableDeductCapacity:m});case 30:I=e.sent,t=I.txSkeleton,x=I.capacity,C=I.changeCapacity;case 34:e.next=59;break;case 36:return e.next=38,O(t,r,x,S,{config:h,enableDeductCapacity:m});case 38:if(A=e.sent,t=A.txSkeleton,x=A.capacity,C=A.changeCapacity,!o){e.next=59;break}if(!(x>0n)){e.next=52;break}return e.next=46,f.default.injectCapacityWithoutChange(t,r,x,o,S,{config:h,LocktimeCellCollector:y,enableDeductCapacity:m});case 46:z=e.sent,t=z.txSkeleton,x=z.capacity,C=z.changeCapacity,e.next=59;break;case 52:if(!(0n===x&&C>0n&&C<S)){e.next=59;break}return e.next=55,f.default.injectCapacityWithoutChange(t,r,S-C,o,0n,{config:h,LocktimeCellCollector:y,enableDeductCapacity:m});case 55:B=e.sent,t=B.txSkeleton,x=B.capacity,C=B.changeCapacity;case 59:if(!(x>0n)){e.next=61;break}throw new Error("Not enough capacity in from infos!");case 61:if(!(C>0n&&C<S)){e.next=63;break}throw new Error("Not enough capacity in from infos for change!");case 63:return C>0n&&(k.cell_output.capacity="0x"+C.toString(16),t=t.update("outputs",(function(e){return e.push(k)}))),e.abrupt("return",t);case 65:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(e,t,r,n,i){return B.apply(this,arguments)}function B(){return(B=o(i.mark((function e(t,r,n,a,o){var s,u,c,l,p,d,f;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=(s=void 0===o?{}:o).config,c=void 0===u?void 0:u,l=s.useLocktimeCellsFirst,p=void 0===l||l,d=s.enableDeductCapacity,f=void 0===d||d,e.abrupt("return",I(t,r,n,void 0,a,{config:c,useLocktimeCellsFirst:p,enableDeductCapacity:f}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(e,t){var r=(void 0===t?{}:t).config,n=void 0===r?void 0:r;C({config:n=n||(0,d.getConfig)()});for(var i,o=a(k.infos);!(i=o()).done;){e=i.value.lockScriptInfo.prepareSigningEntries(e,{config:n})}return e}function O(e,t,r,n,i){return H.apply(this,arguments)}function H(){return(H=o(i.mark((function e(t,r,n,o,u){var c,p,f,h,v,b,y,w,m,x,_,S,E,P,I,A,z,B,T,O,H,L,R,U,N;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p=(c=void 0===u?{}:u).config,f=void 0===p?void 0:p,h=c.enableDeductCapacity,v=void 0===h||h,f=f||(0,d.getConfig)(),n=BigInt(n),b=t.get("cellProvider")){e.next=6;break}throw new Error("Cell Provider is missing!");case 6:for(y=function(e){return e.out_point.tx_hash+"_"+e.out_point.index},w=(0,g.Set)(),m=a(t.get("inputs"));!(x=m()).done;)_=x.value,w=w.add(y(_));for(S=r.map((function(e){return(0,l.parseFromInfo)(e,{config:f}).fromScript})),E=a(S);!(P=E()).done;)I=P.value,v&&n>0n&&(A=j(t,I,n),t=A[0],n=A[1]);if(C({config:f}),z=0n,!(n>0n)){e.next=23;break}B=i.mark((function e(){var r,u,c,l,p,d,h,v,g,m;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=O.value,u=k.infos.map((function(e){return new e.lockScriptInfo.CellCollector(r,b,{config:f})})),c=a(u);case 3:if((l=c()).done){e.next=49;break}p=l.value,H=!1,L=!1,e.prev=7,U=s(p.collect());case 9:return e.next=11,U.next();case 11:if(!(H=!(N=e.sent).done)){e.next=31;break}if(d=N.value,h=y(d),!w.has(h)){e.next=16;break}return e.abrupt("continue",28);case 16:return w=w.add(h),e.next=19,D(t,d,r,{config:f,needCapacity:n});case 19:if(v=e.sent,t=v.txSkeleton,g=BigInt(v.availableCapacity),(m=g)>n&&(m=n),z+=g-m,0n!==(n-=m)||!(0n===z||z>o)){e.next=28;break}return e.abrupt("return","break|loop1");case 28:H=!1,e.next=9;break;case 31:e.next=37;break;case 33:e.prev=33,e.t0=e.catch(7),L=!0,R=e.t0;case 37:if(e.prev=37,e.prev=38,!H||null==U.return){e.next=42;break}return e.next=42,U.return();case 42:if(e.prev=42,!L){e.next=45;break}throw R;case 45:return e.finish(42);case 46:return e.finish(37);case 47:e.next=3;break;case 49:case"end":return e.stop()}}),e,null,[[7,33,37,47],[38,,42,46]])})),T=a(r);case 16:if((O=T()).done){e.next=23;break}return e.delegateYield(B(),"t0",18);case 18:if("break|loop1"!==e.t0){e.next=21;break}return e.abrupt("break",23);case 21:e.next=16;break;case 23:return e.abrupt("return",{txSkeleton:t,capacity:n,changeCapacity:z});case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e,t,r){for(var n=e.get("fixedEntries").filter((function(e){return"outputs"===e.field})).maxBy((function(e){return e.index})),i=n?n.index+1:0;i<e.get("outputs").size&&r>0;i++){var a=e.get("outputs").get(i);new x(a.cell_output.lock,{validate:!1}).equals(new x(t,{validate:!1}))&&function(){var t=JSON.parse(JSON.stringify(a)),n=BigInt(t.cell_output.capacity),o=void 0;r>=n?o=n:(o=n-(0,u.minimalCellCapacity)(t))>r&&(o=r),r-=o,t.cell_output.capacity="0x"+(n-o).toString(16),e=e.update("outputs",(function(e){return e.update(i,(function(){return t}))}))}()}return e=e.update("outputs",(function(e){return e.filter((function(e){return BigInt(e.cell_output.capacity)!==BigInt(0)}))})),[e,r]}function D(e,t,r,n){return L.apply(this,arguments)}function L(){return(L=o(i.mark((function e(t,r,n,a){var o,s,c,l,p,f,h,v,g,b,y,m,x,_,k,S,C,E,P,I;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=(o=void 0===a?{}:a).config,c=void 0===s?void 0:s,l=o.since,p=void 0===l?void 0:l,f=o.defaultWitness,h=void 0===f?"0x":f,v=o.needCapacity,g=void 0===v?void 0:v,c=c||(0,d.getConfig)(),e.next=4,R(t,r,n,{config:c,since:p,defaultWitness:h});case 4:return t=e.sent,b=t.get("outputs").size-1,y=t.get("outputs").get(b),m=BigInt(y.cell_output.capacity),x=t.get("fixedEntries").findIndex((function(e){return"outputs"===e.field&&e.index===b})),_=r.cell_output.lock,k=0n,c.SCRIPTS.ANYONE_CAN_PAY&&(0,w.isAcpScript)(_,c)?(S=!!(n&&"object"==typeof n&&"destroyable"in n&&n.destroyable),g=g||m,S?(k=m,t=t.update("outputs",(function(e){return e.remove(b)})),x>=0&&(t=t.update("fixedEntries",(function(e){return e.remove(x)})))):(C=(0,u.minimalCellCapacity)(y),E=m-C,P=JSON.parse(JSON.stringify(y)),I=C,k=E,g<E&&(I=m-g,k=g),P.cell_output.capacity="0x"+I.toString(16),t=t.update("outputs",(function(e){return e.update(b,(function(){return P}))})))):x<0&&(k=BigInt(t.get("outputs").get(b).cell_output.capacity),t=t.update("outputs",(function(e){return e.remove(b)}))),e.abrupt("return",{txSkeleton:t,availableCapacity:k});case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e,t,r,n){return U.apply(this,arguments)}function U(){return(U=o(i.mark((function e(t,r,n,a){var o,s,u,c,l,p,f,h,v;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=(o=void 0===a?{}:a).config,u=void 0===s?void 0:s,c=o.since,l=void 0===c?void 0:c,p=o.defaultWitness,f=void 0===p?void 0:p,C({config:u=u||(0,d.getConfig)()}),h=r.cell_output.lock,v=k.infos.find((function(e){return e.code_hash===h.code_hash&&e.hash_type===h.hash_type}))){e.next=7;break}throw new Error("No LockScriptInfo found for setupInputCell!");case 7:return e.abrupt("return",v.lockScriptInfo.setupInputCell(t,r,n,{config:u,since:l,defaultWitness:f}));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(e,t,r,n,i){return M.apply(this,arguments)}function M(){return(M=o(i.mark((function e(t,r,n,a,o){var s,u,c,l,p,d,f,h,v,g,b;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u=(s=void 0===o?{}:o).config,c=void 0===u?void 0:u,l=s.useLocktimeCellsFirst,p=void 0===l||l,d=s.enableDeductCapacity,f=void 0===d||d,n=BigInt(n),h=0,g=q(v=t);case 5:if(!(g>h)){e.next=14;break}return b=K(h=g,n),e.next=10,z(t,r,b,a,{config:c,useLocktimeCellsFirst:p,enableDeductCapacity:f});case 10:v=e.sent,g=q(v),e.next=5;break;case 14:return e.abrupt("return",v);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(e,t){var r=1000n,n=BigInt(e)*t,i=n/r;return i*r<n?i+1n:i}function q(e){return F((0,u.createTransactionFromSkeleton)(e))}function F(e){return(0,b.SerializeTransaction)(y.normalizers.NormalizeTransaction(e)).byteLength+4}var V={transfer:E,payFee:z,prepareSigningEntries:T,injectCapacity:I,setupInputCell:R,registerCustomLockScriptInfos:S,payFeeByFeeRate:N,__tests__:{_commonTransfer:O,resetLockScriptInfos:function(){k.configHashCode=0,k._predefinedInfos=[],k._customInfos=[]},getLockScriptInfos:function(){return k},generateLockScriptInfos:C,getTransactionSizeByTx:F,getTransactionSize:q,calculateFee:K}};t.default=V},3765:function(e,t,r){"use strict";var n=r(2954).default,i=r(7162),a=r(4879).default,o=r(8133).default,s=r(1799).default;Object.defineProperty(t,"__esModule",{value:!0}),t.CellCollector=void 0,t.calculateDaoEarliestSince=j,t.calculateMaximumWithdraw=U,t.default=void 0,t.deposit=P,t.listDaoCells=C,t.unlock=O;var u=r(9336),c=r(7143),l=r(3664),p=r(1674),d=b(r(8608)),f=b(r(3009)),h=r(4166),v=r(8278),g=r(6493);function b(e){return e&&e.__esModule?e:{default:e}}var y=c.utils,w=y.toBigUInt64LE,m=y.readBigUInt64LE,x=c.since.parseSince,_="0x0000000000000000",k=BigInt(180),S=function(){function e(e,t,r,n){var i=(void 0===n?{}:n).config,a=void 0===i?void 0:i;if(!t)throw new Error("Cell Provider is missing!");a=a||(0,l.getConfig)();var o=(0,h.parseFromInfo)(e,{config:a}).fromScript,s=(0,v.generateDaoScript)(a),u="deposit"===r?_:"any";this.cellType=r,this.cellCollector=t.collector({lock:o,type:s,data:u})}return e.prototype.collect=function(){var e=this;return o(i.mark((function t(){var r,n,o,u,c,l;return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=!1,n=!1,t.prev=2,u=s(e.cellCollector.collect());case 4:return t.next=6,a(u.next());case 6:if(!(r=!(c=t.sent).done)){t.next=15;break}if(l=c.value,"withdraw"!==e.cellType||l.data!==_){t.next=10;break}return t.abrupt("continue",12);case 10:return t.next=12,l;case 12:r=!1,t.next=4;break;case 15:t.next=21;break;case 17:t.prev=17,t.t0=t.catch(2),n=!0,o=t.t0;case 21:if(t.prev=21,t.prev=22,!r||null==u.return){t.next=26;break}return t.next=26,a(u.return());case 26:if(t.prev=26,!n){t.next=29;break}throw o;case 29:return t.finish(26);case 30:return t.finish(21);case 31:case"end":return t.stop()}}),t,null,[[2,17,21,31],[22,,26,30]])})))()},e}();function C(e,t,r){return E.apply(this,arguments)}function E(){return(E=o(i.mark((function e(t,r,n,o){var u,c,l,p,d,f,h,v;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u=(void 0===o?{}:o).config,c=new S(r,t,n,{config:void 0===u?void 0:u}),l=!1,p=!1,e.prev=4,f=s(c.collect());case 6:return e.next=8,a(f.next());case 8:if(!(l=!(h=e.sent).done)){e.next=15;break}return v=h.value,e.next=12,v;case 12:l=!1,e.next=6;break;case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(4),p=!0,d=e.t0;case 21:if(e.prev=21,e.prev=22,!l||null==f.return){e.next=26;break}return e.next=26,a(f.return());case 26:if(e.prev=26,!p){e.next=29;break}throw d;case 29:return e.finish(26);case 30:return e.finish(21);case 31:case"end":return e.stop()}}),e,null,[[4,17,21,31],[22,,26,30]])})))).apply(this,arguments)}function P(e,t,r,n,i){return I.apply(this,arguments)}function I(){return(I=n(i.mark((function e(t,r,n,a,o){var s,c,p,h,g,b,y;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=(void 0===o?{}:o).config,c=(c=void 0===s?void 0:s)||(0,l.getConfig)(),p=c.SCRIPTS.DAO){e.next=5;break}throw new Error("Provided config does not have DAO script setup!");case 5:if(A(r,c),t=L(t,c),n){e.next=9;break}throw new Error("You must provide a to address!");case 9:if(h=(0,u.parseAddress)(n,{config:c}),g={code_hash:p.CODE_HASH,hash_type:p.HASH_TYPE,args:"0x"},t=t.update("outputs",(function(e){return e.push({cell_output:{capacity:"0x"+BigInt(a).toString(16),lock:h,type:g},data:_,out_point:void 0,block_hash:void 0})})),b=t.get("outputs").size-1,t=t.update("fixedEntries",(function(e){return e.push({field:"outputs",index:b})})),"string"!=typeof r){e.next=28;break}if(y=(0,u.parseAddress)(r,{config:c}),!(0,v.isSecp256k1Blake160Script)(y,c)){e.next=22;break}return e.next=19,d.default.injectCapacity(t,b,r,{config:c});case 19:t=e.sent,e.next=26;break;case 22:if(!(0,v.isSecp256k1Blake160MultisigScript)(y,c)){e.next=26;break}return e.next=25,f.default.injectCapacity(t,b,r,{config:c});case 25:t=e.sent;case 26:e.next=32;break;case 28:if(!r){e.next=32;break}return e.next=31,f.default.injectCapacity(t,b,r,{config:c});case 31:t=e.sent;case 32:return e.abrupt("return",t);case 33:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(e,t){var r;if("string"==typeof e){var n=(0,u.parseAddress)(e,{config:t}).args;58===n.length&&(r="0x"+m("0x"+n.slice(42)).toString(16))}else"R"in e&&(r=e.since);if(null!=r){var i=x(r),a=i.relative,o=i.type;if(a||"epochNumber"!==o)throw new Error("Can't deposit a dao cell with multisig locktime which not using absolute-epoch-number format!")}}function z(){return(z=n(i.mark((function e(t,r,n,a){var o,s,c,p,h,g,b,y;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=(void 0===a?{}:a).config,D(s=(s=void 0===o?void 0:o)||(0,l.getConfig)()),(t=L(t,s)).get("inputs").size===t.get("outputs").size){e.next=6;break}throw new Error("Input size must equals to output size in txSkeleton!");case 6:if(s.SCRIPTS.DAO){e.next=8;break}throw new Error("Provided config does not have DAO script setup!");case 8:if(t.get("cellProvider")){e.next=11;break}throw new Error("Cell provider is missing!");case 11:if(c=r.cell_output.type,p=s.SCRIPTS.DAO,c&&c.code_hash===p.CODE_HASH&&c.hash_type===p.HASH_TYPE&&r.data===_){e.next=15;break}throw new Error("fromInput is not a DAO deposit cell.");case 15:if(h=r.cell_output.lock,!(0,v.isSecp256k1Blake160Script)(h,s)){e.next=22;break}return e.next=19,d.default.setupInputCell(t,r,void 0,{config:s});case 19:t=e.sent,e.next=26;break;case 22:if(!(0,v.isSecp256k1Blake160MultisigScript)(h,s)){e.next=26;break}return e.next=25,f.default.setupInputCell(t,r,n||(0,u.generateAddress)(h,{config:s}),{config:s});case 25:t=e.sent;case 26:return g=t.get("outputs").size-1,b=t.get("outputs").get(g),(y=JSON.parse(JSON.stringify(b))).data=w(BigInt(r.block_number)),t=(t=(t=t.update("outputs",(function(e){return e.update(g,(function(){return y}))}))).update("headerDeps",(function(e){return e.push(r.block_hash)}))).update("fixedEntries",(function(e){return e.push({field:"inputs",index:t.get("inputs").size-1},{field:"outputs",index:t.get("outputs").size-1})})),e.abrupt("return",t);case 34:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function B(e){return{length:e>>BigInt(40)&BigInt(65535),index:e>>BigInt(24)&BigInt(65535),number:e&BigInt(16777215)}}function T(e){var t=e.length,r=e.index,n=e.number;return(BigInt(32)<<BigInt(56))+(t<<BigInt(40))+(r<<BigInt(24))+n}function O(e,t,r,n,i,a){return H.apply(this,arguments)}function H(){return(H=n(i.mark((function e(t,r,n,a,o,s){var h,b,y,m,x,S,C,E,P,I,A,z,O,H,j,R,N,M,K,q,F,V,W,Y,J,X,Z,G;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(b=(h=void 0===s?{}:s).config,y=void 0===b?void 0:b,m=h.RpcClient,x=void 0===m?g.RPC:m,D(y=y||(0,l.getConfig)()),t=L(t,y),y.SCRIPTS.DAO){e.next=6;break}throw new Error("Provided config does not have DAO script setup!");case 6:if(S=t.get("cellProvider")){e.next=9;break}throw new Error("Cell provider is missing!");case 9:if(C=new x(S.uri),E=r.cell_output.type,P=y.SCRIPTS.DAO,E&&E.code_hash===P.CODE_HASH&&E.hash_type===P.HASH_TYPE&&r.data===_){e.next=14;break}throw new Error("depositInput is not a DAO deposit cell.");case 14:if((I=n.cell_output.type)&&I.code_hash===P.CODE_HASH&&I.hash_type===P.HASH_TYPE&&n.data!==_){e.next=17;break}throw new Error("withdrawInput is not a DAO withdraw cell.");case 17:return e.next=19,C.get_header(r.block_hash);case 19:return A=e.sent,z=B(BigInt(A.epoch)),e.next=23,C.get_header(n.block_hash);case 23:for(O=e.sent,H=B(BigInt(O.epoch)),j=H.index*z.length,R=z.index*H.length,N=H.number-z.number,j>R&&(N+=BigInt(1)),M=(N+(k-BigInt(1)))/k*k,K={number:z.number+M,index:z.index,length:z.length},q=T(K),F="0x"+U(n,A.dao,O.dao).toString(16),V=(0,u.parseAddress)(a,{config:y}),t=t.update("outputs",(function(e){return e.push({cell_output:{capacity:F,lock:V,type:void 0},data:"0x",out_point:void 0,block_hash:void 0})})),W="0x"+q.toString(16);t.get("witnesses").size<t.get("inputs").size-1;)t=t.update("witnesses",(function(e){return e.push("0x")}));if(t=t.update("headerDeps",(function(e){return e.push(r.block_hash,n.block_hash)})),Y=t.get("headerDeps").size-2,J={input_type:w(BigInt(Y))},X=new p.Reader(c.core.SerializeWitnessArgs(p.normalizers.NormalizeWitnessArgs(J))).serializeJson(),Z=n.cell_output.lock,!(0,v.isSecp256k1Blake160Script)(Z,y)){e.next=48;break}return e.next=45,d.default.setupInputCell(t,n,void 0,{config:y,since:W,defaultWitness:X});case 45:t=e.sent,e.next=52;break;case 48:if(!(0,v.isSecp256k1Blake160MultisigScript)(Z,y)){e.next=52;break}return e.next=51,f.default.setupInputCell(t,n,o||(0,u.generateAddress)(Z,{config:y}),{config:y,since:W,defaultWitness:X});case 51:t=e.sent;case 52:return G=t.get("outputs").size-1,t=(t=t.update("outputs",(function(e){return e.remove(G)}))).update("fixedEntries",(function(e){return e.push({field:"inputs",index:t.get("inputs").size-1},{field:"outputs",index:t.get("outputs").size-1},{field:"witnesses",index:t.get("witnesses").size-1},{field:"headerDeps",index:t.get("headerDeps").size-2})})),e.abrupt("return",t);case 56:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e,t){var r=B(BigInt(e)),n=B(BigInt(t)),i=n.index*r.length,a=r.index*n.length,o=n.number-r.number;i>a&&(o+=BigInt(1));var s=(o+(k-BigInt(1)))/k*k;return T({number:r.number+s,index:r.index,length:r.length})}function D(e){if(!e.SCRIPTS.DAO)throw new Error("Provided config does not have DAO script setup!")}function L(e,t){var r=t.SCRIPTS.DAO;return(0,v.addCellDep)(e,{out_point:{tx_hash:r.TX_HASH,index:r.INDEX},dep_type:r.DEP_TYPE})}function R(e){if(!/^(0x)?([0-9a-fA-F]){64}$/.test(e))throw new Error("Invalid dao format!");var t=e.startsWith("0x")?e.slice(2):e;return["c","ar","s","u"].map((function(e,r){var n;return(n={})[e]=m("0x"+t.slice(16*r,16*(r+1))),n})).reduce((function(e,t){return Object.assign({},e,t)}),{})}function U(e,t,r){var n=R(t).ar,i=R(r).ar,a=(0,u.minimalCellCapacity)(e);return(BigInt(e.cell_output.capacity)-a)*i/n+a}t.CellCollector=S;var N={deposit:P,withdraw:function(e,t,r,n){return z.apply(this,arguments)},unlock:O,calculateMaximumWithdraw:U,calculateDaoEarliestSince:j,CellCollector:S,listDaoCells:C};t.default=N},4166:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.multisigArgs=l,t.parseFromInfo=function(e,t){var r,n,o,s,u=(void 0===t?{}:t).config,p=void 0===u?void 0:u;if(p=p||(0,a.getConfig)(),"string"==typeof e)r=(0,i.parseAddress)(e,{config:p});else if("R"in e){var d=p.SCRIPTS.SECP256K1_BLAKE160_MULTISIG;if(!d)throw new Error("Provided config does not have SECP256K1_BLAKE16_MULTISIG script setup!");var f=l(n=c(e),e.since);r={code_hash:d.CODE_HASH,hash_type:d.HASH_TYPE,args:f}}else if("address"in e){var h=p.SCRIPTS.ANYONE_CAN_PAY;if(!h)throw new Error("Provided config does not have ANYONE_CAN_PAY script setup!");var v=e.address;if(r=(0,i.parseAddress)(v,{config:p}),o=e.destroyable,r.code_hash!==h.CODE_HASH||r.hash_type!==h.HASH_TYPE)throw new Error("fromInfo.address is not ANYONE_CAN_PAY address!")}else{if(!("script"in e))throw new Error("Invalid fromInfo format!");r=e.script,s=e.customData}return{fromScript:r,multisigScript:n,destroyable:o,customData:s}},t.serializeMultisigScript=c;var n=r(7143),i=r(9336),a=r(3664),o=n.utils,s=o.CKBHasher,u=o.toBigUInt64LE;function c(e){var t=e.R,r=e.M,n=e.publicKeyHashes;if(t<0||t>255)throw new Error("`R` should be less than 256!");if(r<0||r>255)throw new Error("`M` should be less than 256!");return"0x00"+("00"+t.toString(16)).slice(-2)+("00"+r.toString(16)).slice(-2)+("00"+n.length.toString(16)).slice(-2)+n.map((function(e){return e.slice(2)})).join("")}function l(e,t){var r="0x";return null!=t&&(r=u(BigInt(t))),(new s).update(e).digestHex().slice(0,42)+r.slice(2)}},8278:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SECP_SIGNATURE_PLACEHOLDER=void 0,t.addCellDep=l,t.default=void 0,t.ensureScript=_,t.generateDaoScript=p,t.hashWitness=m,t.isAcpAddress=w,t.isAcpScript=y,t.isDaoScript=g,t.isSecp256k1Blake160Address=f,t.isSecp256k1Blake160MultisigAddress=v,t.isSecp256k1Blake160MultisigScript=h,t.isSecp256k1Blake160Script=d,t.isSudtScript=b,t.prepareSigningEntries=x;var n=r(7623),i=r(9336),a=r(7143),o=r(1674),s=a.utils,u=s.CKBHasher,c=s.ckbHash;function l(e,t){return e.get("cellDeps").find((function(e){return e.dep_type===t.dep_type&&new a.values.OutPointValue(e.out_point,{validate:!1}).equals(new a.values.OutPointValue(t.out_point,{validate:!1}))}))||(e=e.update("cellDeps",(function(e){return e.push({out_point:t.out_point,dep_type:t.dep_type})}))),e}function p(e){var t=e.SCRIPTS.DAO;return{code_hash:t.CODE_HASH,hash_type:t.HASH_TYPE,args:"0x"}}function d(e,t){var r=t.SCRIPTS.SECP256K1_BLAKE160;return e.code_hash===r.CODE_HASH&&e.hash_type===r.HASH_TYPE}function f(e,t){return d((0,i.parseAddress)(e,{config:t}),t)}function h(e,t){var r=t.SCRIPTS.SECP256K1_BLAKE160_MULTISIG;return e.code_hash===r.CODE_HASH&&e.hash_type===r.HASH_TYPE}function v(e,t){return h((0,i.parseAddress)(e,{config:t}),t)}function g(e,t){var r=t.SCRIPTS.DAO;return!!e&&e.code_hash===r.CODE_HASH&&e.hash_type===r.HASH_TYPE}function b(e,t){var r=t.SCRIPTS.SUDT;if(!r)throw new Error("SUDT script not defined in config!");return!!e&&e.code_hash===r.CODE_HASH&&e.hash_type===r.HASH_TYPE}function y(e,t){var r=t.SCRIPTS.ANYONE_CAN_PAY;if(!r)throw new Error("ANYONE_CAN_PAY script not defined in config!");return!!e&&e.code_hash===r.CODE_HASH&&e.hash_type===r.HASH_TYPE}function w(e,t){return y((0,i.parseAddress)(e,{config:t}),t)}function m(e,t){var r=new ArrayBuffer(8);new DataView(r).setBigUint64(0,BigInt(new o.Reader(t).length()),!0),e.update(r),e.update(t)}function x(e,t,r){var s=t.SCRIPTS[r];if(!s)throw new Error("Provided config does not have "+r+" script setup!");for(var l=(0,n.Set)(),p=(0,i.createTransactionFromSkeleton)(e),d=c(a.core.SerializeRawTransaction(o.normalizers.NormalizeRawTransaction(p))).serializeJson(),f=e.get("inputs"),h=e.get("witnesses"),v=e.get("signingEntries"),g=0;g<f.size;g++){var b=f.get(g);if(s.CODE_HASH===b.cell_output.lock.code_hash&&s.HASH_TYPE===b.cell_output.lock.hash_type&&!l.has(b.cell_output.lock.args)){l=l.add(b.cell_output.lock.args);var y=new a.values.ScriptValue(b.cell_output.lock,{validate:!1}),w=new u;if(w.update(d),g>=h.size)throw new Error("The first witness in the script group starting at input index "+g+" does not exist, maybe some other part has invalidly tampered the transaction?");m(w,h.get(g));for(var x=g+1;x<f.size&&x<h.size;x++){var _=f.get(x);y.equals(new a.values.ScriptValue(_.cell_output.lock,{validate:!1}))&&m(w,h.get(x))}for(var k=f.size;k<h.size;k++)m(w,h.get(k));var S={type:"witness_args_lock",index:g,message:w.digestHex()};v=v.push(S)}}return e=e.set("signingEntries",v)}function _(e,t,r){var n=t.SCRIPTS[r];if(!n)throw new Error("Provided config does not have "+r+" script setup!");if(n.CODE_HASH!==e.code_hash||n.HASH_TYPE!==e.hash_type)throw new Error("Provided script is not "+r+" script!")}t.SECP_SIGNATURE_PLACEHOLDER="0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";var k={addCellDep:l,generateDaoScript:p,isSecp256k1Blake160Script:d,isSecp256k1Blake160MultisigScript:h,isDaoScript:g,isSudtScript:b,prepareSigningEntries:x,isSecp256k1Blake160Address:f,isSecp256k1Blake160MultisigAddress:v,ensureScript:_,isAcpScript:y,isAcpAddress:w};t.default=k},6862:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"FromInfo",{enumerable:!0,get:function(){return a.FromInfo}}),Object.defineProperty(t,"LockScriptInfo",{enumerable:!0,get:function(){return u.LockScriptInfo}}),Object.defineProperty(t,"LocktimeCell",{enumerable:!0,get:function(){return s.LocktimeCell}}),Object.defineProperty(t,"MultisigScript",{enumerable:!0,get:function(){return a.MultisigScript}}),Object.defineProperty(t,"anyoneCanPay",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"common",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"dao",{enumerable:!0,get:function(){return o.default}}),t.default=void 0,Object.defineProperty(t,"locktimePool",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"parseFromInfo",{enumerable:!0,get:function(){return a.parseFromInfo}}),Object.defineProperty(t,"secp256k1Blake160",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"secp256k1Blake160Multisig",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"sudt",{enumerable:!0,get:function(){return c.default}});var n=f(r(8608)),i=f(r(3009)),a=r(4166),o=f(r(3765)),s=d(r(2584)),u=d(r(844)),c=f(r(6165)),l=f(r(82));function p(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(p=function(e){return e?r:t})(e)}function d(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=p(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}return n.default=e,r&&r.set(e,n),n}function f(e){return e&&e.__esModule?e:{default:e}}var h={secp256k1Blake160:n.default,secp256k1Blake160Multisig:i.default,dao:o.default,locktimePool:s.default,common:u.default,sudt:c.default,anyoneCanPay:l.default};t.default=h},2584:function(e,t,r){"use strict";var n=r(2954).default,i=r(7162),a=r(3572).default,o=r(4879).default,s=r(8133).default,u=r(1799).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.CellCollector=void 0,t.injectCapacity=N,t.payFee=L,t.prepareSigningEntries=U,t.setupInputCell=F,t.transfer=T;var c,l=r(9336),p=r(4166),d=(c=r(8608))&&c.__esModule?c:{default:c},f=r(3765),h=r(7143),v=r(1674),g=r(8278),b=r(7623),y=r(3664),w=r(6493),m=r(6862);var x=h.utils,_=x.toBigUInt64LE,k=x.readBigUInt64LE,S=h.values.ScriptValue,C=h.since,E=C.parseSince,P=C.parseEpoch,I=C.maximumAbsoluteEpochSince,A=C.generateAbsoluteEpochSince,z=C.validateSince,B=function(){function e(e,t,r){var n=void 0===r?{}:r,i=n.config,a=void 0===i?void 0:i,o=n.queryOptions,s=void 0===o?{}:o,u=n.tipHeader,c=void 0===u?void 0:u,l=n.NodeRPC,d=void 0===l?w.RPC:l;if(!t)throw new Error("Cell provider is missing!");a=a||(0,y.getConfig)();var f=(0,p.parseFromInfo)(e,{config:a}),h=f.fromScript;this.multisigScript=f.multisigScript,this.fromScript=h,this.config=a,this.tipHeader=c,c&&(this.tipSinceValidationInfo={block_number:c.number,epoch:c.epoch,median_timestamp:""}),this.rpc=new d(t.uri),s=Object.assign({},s,{lock:this.fromScript});var v=(0,b.List)([]);if((0,g.isSecp256k1Blake160MultisigScript)(h,a)){var m={code_hash:h.code_hash,hash_type:h.hash_type,args:h.args.slice(0,42)};v=v.push(t.collector({lock:m,argsLen:s.argsLen||28,type:s.type||"empty",data:s.data||"0x"})),s.type||s.data&&"any"!==s.data||(v=(v=v.push(t.collector({lock:m,type:(0,g.generateDaoScript)(a),data:"any"}))).push(t.collector({lock:m,argsLen:28,type:(0,g.generateDaoScript)(a),data:"any"})))}else(0,g.isSecp256k1Blake160Script)(h,a)&&(s.type||s.data&&"any"!==s.data||(v=v.push(t.collector({lock:h,type:(0,g.generateDaoScript)(a),data:"any"}))));this.cellCollectors=v}return e.prototype.collect=function(){var e=this;return s(i.mark((function t(){var r,n,s,c,l,p,d,h,v,b,y,w,m,x,_,k,S,C,B,T,O,H,j,D,L,R;return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=a(e.cellCollectors);case 1:if((n=r()).done){t.next=81;break}s=n.value,c=!1,l=!1,t.prev=5,d=u(s.collect());case 7:return t.next=9,o(d.next());case 9:if(!(c=!(h=t.sent).done)){t.next=63;break}if(v=h.value,b=v.cell_output.lock,y=void 0,w=void 0,m=void 0,x=void 0,_=void 0,58!==b.args.length){t.next=23;break}return t.next=20,o(e.rpc.get_header(v.block_hash));case 20:k=t.sent,y="0x"+W(b.args).toString(16),_={epoch:k.epoch,block_number:k.number,median_timestamp:""};case 23:if(!(0,g.isDaoScript)(v.cell_output.type,e.config)){t.next=54;break}if("0x0000000000000000"!==v.data){t.next=26;break}return t.abrupt("continue",60);case 26:return t.next=28,o(e.rpc.get_transaction(v.out_point.tx_hash));case 28:return S=t.sent,x=S.tx_status.block_hash,C=S.transaction,B=C.inputs[+v.out_point.index].previous_output,t.next=34,o(e.rpc.get_transaction(B.tx_hash));case 34:return m=t.sent.tx_status.block_hash,t.next=37,o(e.rpc.get_header(m));case 37:return T=t.sent,t.next=40,o(e.rpc.get_header(x));case 40:if(O=t.sent,H="0x"+(0,f.calculateDaoEarliestSince)(T.epoch,O.epoch).toString(16),w=(0,f.calculateMaximumWithdraw)(v,T.dao,O.dao),j=P(O.epoch),D={number:j.number+4,length:j.length,index:j.index},H=I(H,A(D)),!y){t.next=53;break}if(!1===(L=E(y)).relative&&"epochNumber"===L.type){t.next=50;break}return t.abrupt("continue",60);case 50:try{y=I(H,y)}catch(i){y=H}t.next=54;break;case 53:y=H;case 54:if("blockTimestamp"!==E(y).type&&(!e.tipHeader||z(y,e.tipSinceValidationInfo,_))){t.next=56;break}return t.abrupt("continue",60);case 56:return(R=Object.assign({},v,{since:y,depositBlockHash:m,withdrawBlockHash:x,sinceValidationInfo:_})).cell_output.capacity="0x"+(w||BigInt(v.cell_output.capacity)).toString(16),t.next=60,R;case 60:c=!1,t.next=7;break;case 63:t.next=69;break;case 65:t.prev=65,t.t0=t.catch(5),l=!0,p=t.t0;case 69:if(t.prev=69,t.prev=70,!c||null==d.return){t.next=74;break}return t.next=74,o(d.return());case 74:if(t.prev=74,!l){t.next=77;break}throw p;case 77:return t.finish(74);case 78:return t.finish(69);case 79:t.next=1;break;case 81:case"end":return t.stop()}}),t,null,[[5,65,69,79],[70,,74,78]])})))()},e}();function T(e,t,r,n,i,a){return O.apply(this,arguments)}function O(){return(O=n(i.mark((function e(t,r,n,o,s,u){var c,l,p,d,f,h,v,g,b,y,w,m,x,_,k;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l=(c=void 0===u?{}:u).config,p=void 0===l?void 0:l,d=c.requireToAddress,f=void 0===d||d,h=c.assertAmountEnough,v=void 0===h||h,g=c.LocktimeCellCollector,b=void 0===g?B:g,o=BigInt(o),y=a(r.entries());case 3:if((w=y()).done){e.next=16;break}return m=w.value,x=m[0],_=m[1],e.next=7,H(t,_,0===x?n:void 0,o,s,{config:p,requireToAddress:0===x&&f,assertAmountEnough:!1,LocktimeCellCollector:b});case 7:if(k=e.sent,t=k[0],(o=k[1])!==BigInt(0)){e.next=14;break}if(!v){e.next=13;break}return e.abrupt("return",t);case 13:return e.abrupt("return",[t,o]);case 14:e.next=3;break;case 16:if(!v){e.next=18;break}throw new Error("Not enough capacity in from addresses!");case 18:return e.abrupt("return",[t,o]);case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(e,t,r,n,i,a){return j.apply(this,arguments)}function j(){return(j=n(i.mark((function e(t,r,n,o,s,c){var d,f,w,m,x,k,C,E,P,I,A,z,T,O,H,j,D,L,R,U,N,M,q,F,V,Y,J,X,Z,G,$,Q;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d=c.config,f=void 0===d?void 0:d,w=c.requireToAddress,m=void 0===w||w,x=c.assertAmountEnough,k=void 0===x||x,C=c.LocktimeCellCollector,E=void 0===C?B:C,P=c.changeAddress,I=void 0===P?void 0:P,f=f||(0,y.getConfig)(),A=(0,p.parseFromInfo)(r,{config:f}),z=A.fromScript,(0,g.isSecp256k1Blake160MultisigScript)(z,f)||(0,g.isSecp256k1Blake160Script)(z,f)){e.next=5;break}throw new Error("fromInfo not supported!");case 5:if(!m||n){e.next=7;break}throw new Error("You must provide a to address!");case 7:for(o=BigInt(o||0),n&&(T=(0,l.parseAddress)(n,{config:f}),t=t.update("outputs",(function(e){return e.push({cell_output:{capacity:"0x"+o.toString(16),lock:T,type:void 0},data:"0x",out_point:void 0,block_hash:void 0})}))),O=t.get("fixedEntries").filter((function(e){return"outputs"===e.field})).maxBy((function(e){return e.index})),H=O?O.index+1:0;H<t.get("outputs").size&&o>0;++H)j=t.get("outputs").get(H),new S(j.cell_output.lock,{validate:!1}).equals(new S(z,{validate:!1}))&&function(){var e=BigInt(j.cell_output.capacity),r=void 0;o>=e?r=e:(r=e-(0,l.minimalCellCapacity)(j))>o&&(r=o),o-=r;var n=JSON.parse(JSON.stringify(j));n.cell_output.capacity="0x"+(e-r).toString(16),t=t.update("outputs",(function(e){return e.update(H,(function(){return n}))}))}();if(t=t.update("outputs",(function(e){return e.filter((function(e){return BigInt(e.cell_output.capacity)!==BigInt(0)}))})),!(o>0n)){e.next=57;break}if(D=t.get("cellProvider")){e.next=17;break}throw new Error("cell provider is missing!");case 17:for(L=I?(0,l.parseAddress)(I,{config:f}):z,R={cell_output:{capacity:"0x0",lock:L,type:void 0},data:"0x",out_point:void 0,block_hash:void 0},U=BigInt(0),N=(0,b.Set)(),M=a(t.get("inputs"));!(q=M()).done;)F=q.value,N=N.add(F.out_point.tx_hash+"_"+F.out_point.index);V=new E(r,D,{config:f,tipHeader:s}),Y=!1,J=!1,e.prev=25,Z=i.mark((function e(){var n,a,s,u,c,p,d,b,y;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=$.value,!N.has(n.out_point.tx_hash+"_"+n.out_point.index)){e.next=3;break}return e.abrupt("return","continue");case 3:return a=void 0,(0,g.isSecp256k1Blake160MultisigScript)(z,f)&&(s=n.cell_output.lock.args,a=58===s.length?W(s):void 0),u="0x",(0,g.isDaoScript)(n.cell_output.type,f)&&(c=f.SCRIPTS.DAO,t=(t=(0,g.addCellDep)(t,{dep_type:c.DEP_TYPE,out_point:{tx_hash:c.TX_HASH,index:c.INDEX}})).update("headerDeps",(function(e){return e.push(n.depositBlockHash,n.withdrawBlockHash)})),p=t.get("headerDeps").size-2,d={input_type:_(BigInt(p))},u=new v.Reader(h.core.SerializeWitnessArgs(v.normalizers.NormalizeWitnessArgs(d))).serializeJson()),e.next=9,K(t,n,(0,g.isSecp256k1Blake160MultisigScript)(z,f)?Object.assign({},r,{since:a}):r,{config:f,defaultWitness:u,since:n.since});case 9:if(t=e.sent,b=BigInt(n.cell_output.capacity),(y=b)>o&&(y=o),o-=y,U+=b-y,(0,g.isDaoScript)(n.cell_output.type,f)&&(t=t.update("fixedEntries",(function(e){return e.push({field:"inputs",index:t.get("inputs").size-1},{field:"witnesses",index:t.get("witnesses").size-1},{field:"headerDeps",index:t.get("headerDeps").size-2})}))),o!==BigInt(0)||!(U===BigInt(0)||U>(0,l.minimalCellCapacity)(R))){e.next=18;break}return e.abrupt("return","break");case 18:case"end":return e.stop()}}),e)})),G=u(V.collect());case 28:return e.next=30,G.next();case 30:if(!(Y=!($=e.sent).done)){e.next=40;break}return e.delegateYield(Z(),"t0",32);case 32:if("continue"!==(Q=e.t0)){e.next=35;break}return e.abrupt("continue",37);case 35:if("break"!==Q){e.next=37;break}return e.abrupt("break",40);case 37:Y=!1,e.next=28;break;case 40:e.next=46;break;case 42:e.prev=42,e.t1=e.catch(25),J=!0,X=e.t1;case 46:if(e.prev=46,e.prev=47,!Y||null==G.return){e.next=51;break}return e.next=51,G.return();case 51:if(e.prev=51,!J){e.next=54;break}throw X;case 54:return e.finish(51);case 55:return e.finish(46);case 56:U>BigInt(0)&&(R.cell_output.capacity="0x"+U.toString(16),t=t.update("outputs",(function(e){return e.push(R)})));case 57:if(k){e.next=59;break}return e.abrupt("return",[t,o]);case 59:if(!(o>0n)){e.next=61;break}throw new Error("Not enough capacity in from address!");case 61:return e.abrupt("return",t);case 62:case"end":return e.stop()}}),e,null,[[25,42,46,56],[47,,51,55]])})))).apply(this,arguments)}function D(){return(D=n(i.mark((function e(t,r,n,o,s,c){var d,f,w,m,x,k,C,E,P,I,A,z,T,O,H,j,D,L,R,U,N,M,q,F,V,Y,J,X;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d=c.config,f=void 0===d?void 0:d,w=c.LocktimeCellCollector,m=void 0===w?B:w,x=c.enableDeductCapacity,k=void 0===x||x,f=f||(0,y.getConfig)(),n=BigInt(n||0),!k){e.next=12;break}C=function(){var e=P.value,r=(0,p.parseFromInfo)(e,{config:f}).fromScript;if(!(0,g.isSecp256k1Blake160MultisigScript)(r,f)&&!(0,g.isSecp256k1Blake160Script)(r,f))return"continue";for(var i=t.get("fixedEntries").filter((function(e){return"outputs"===e.field})).maxBy((function(e){return e.index})),a=i?i.index+1:0;a<t.get("outputs").size&&n>0;++a){var o=t.get("outputs").get(a);new S(o.cell_output.lock,{validate:!1}).equals(new S(r,{validate:!1}))&&function(){var e=JSON.parse(JSON.stringify(o)),r=BigInt(e.cell_output.capacity),i=void 0;n>=r?i=r:(i=r-(0,l.minimalCellCapacity)(e))>n&&(i=n),n-=i,e.cell_output.capacity="0x"+(r-i).toString(16),t=t.update("outputs",(function(t){return t.update(a,(function(){return e}))}))}()}t=t.update("outputs",(function(e){return e.filter((function(e){return BigInt(e.cell_output.capacity)!==BigInt(0)}))}))},E=a(r);case 6:if((P=E()).done){e.next=12;break}if("continue"!==C()){e.next=10;break}return e.abrupt("continue",10);case 10:e.next=6;break;case 12:if(I=BigInt(0),!(n>0n)){e.next=60;break}if(A=t.get("cellProvider")){e.next=17;break}throw new Error("cell provider is missing!");case 17:for(z=function(e){return e.out_point.tx_hash+"_"+e.out_point.index},T=(0,b.Set)(),O=a(t.get("inputs"));!(H=O()).done;)j=H.value,T=T.add(z(j));D=a(r);case 21:if((L=D()).done){e.next=60;break}R=L.value,U=(0,p.parseFromInfo)(R,{config:f}).fromScript,N=new m(R,A,{config:f,tipHeader:o}),M=!1,q=!1,e.prev=27,V=i.mark((function e(){var r,a,o,u,c,l,p,d,b;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=J.value,!T.has(z(r))){e.next=3;break}return e.abrupt("return","continue");case 3:return a="0x",(0,g.isDaoScript)(r.cell_output.type,f)&&(o=f.SCRIPTS.DAO,t=(t=(0,g.addCellDep)(t,{dep_type:o.DEP_TYPE,out_point:{tx_hash:o.TX_HASH,index:o.INDEX}})).update("headerDeps",(function(e){return e.push(r.depositBlockHash,r.withdrawBlockHash)})),u=t.get("headerDeps").size-2,c={input_type:_(BigInt(u))},a=new v.Reader(h.core.SerializeWitnessArgs(v.normalizers.NormalizeWitnessArgs(c))).serializeJson()),l=void 0,(0,g.isSecp256k1Blake160MultisigScript)(U,f)&&(p=r.cell_output.lock.args,l=58===p.length?W(p):void 0),e.next=9,K(t,r,Object.assign({},R,{since:l}),{config:f,defaultWitness:a,since:r.since});case 9:if(t=e.sent,d=BigInt(r.cell_output.capacity),(b=d)>n&&(b=n),n-=b,I+=d-b,(0,g.isDaoScript)(r.cell_output.type,f)&&(t=t.update("fixedEntries",(function(e){return e.push({field:"inputs",index:t.get("inputs").size-1},{field:"witnesses",index:t.get("witnesses").size-1},{field:"headerDeps",index:t.get("headerDeps").size-2})}))),n!==BigInt(0)||!(I===BigInt(0)||I>s)){e.next=18;break}return e.abrupt("return","break");case 18:case"end":return e.stop()}}),e)})),Y=u(N.collect());case 30:return e.next=32,Y.next();case 32:if(!(M=!(J=e.sent).done)){e.next=42;break}return e.delegateYield(V(),"t0",34);case 34:if("continue"!==(X=e.t0)){e.next=37;break}return e.abrupt("continue",39);case 37:if("break"!==X){e.next=39;break}return e.abrupt("break",42);case 39:M=!1,e.next=30;break;case 42:e.next=48;break;case 44:e.prev=44,e.t1=e.catch(27),q=!0,F=e.t1;case 48:if(e.prev=48,e.prev=49,!M||null==Y.return){e.next=53;break}return e.next=53,Y.return();case 53:if(e.prev=53,!q){e.next=56;break}throw F;case 56:return e.finish(53);case 57:return e.finish(48);case 58:e.next=21;break;case 60:return e.abrupt("return",{txSkeleton:t,capacity:n,changeCapacity:I});case 61:case"end":return e.stop()}}),e,null,[[27,44,48,58],[49,,53,57]])})))).apply(this,arguments)}function L(e,t,r,n,i){return R.apply(this,arguments)}function R(){return(R=n(i.mark((function e(t,r,n,a,o){var s,u,c,l,p;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=(s=void 0===o?{}:o).config,c=void 0===u?void 0:u,l=s.LocktimeCellCollector,p=void 0===l?B:l,e.abrupt("return",T(t,r,void 0,n,a,{config:c,requireToAddress:!1,LocktimeCellCollector:p}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(e,t){var r=(void 0===t?{}:t).config,n=void 0===r?void 0:r;return n=n||(0,y.getConfig)(),e=(0,g.prepareSigningEntries)(e,n,"SECP256K1_BLAKE160"),e=(0,g.prepareSigningEntries)(e,n,"SECP256K1_BLAKE160_MULTISIG")}function N(e,t,r,n,i){return M.apply(this,arguments)}function M(){return(M=n(i.mark((function e(t,r,n,a,o){var s,u,c,l,p,d;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=(s=void 0===o?{}:o).config,c=void 0===u?void 0:u,l=s.LocktimeCellCollector,p=void 0===l?B:l,c=c||(0,y.getConfig)(),!(r>=t.get("outputs").size)){e.next=4;break}throw new Error("Invalid output index!");case 4:return d=BigInt(t.get("outputs").get(r).cell_output.capacity),e.abrupt("return",T(t,n,void 0,d,a,{config:c,requireToAddress:!1,LocktimeCellCollector:p}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(e,t,r,n){return q.apply(this,arguments)}function q(){return(q=n(i.mark((function e(t,r,n,a){var o,s,u,c,l,p,d;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=(o=void 0===a?{}:a).config,u=void 0===s?void 0:s,c=o.since,l=void 0===c?void 0:c,p=o.defaultWitness,d=void 0===p?"0x":p,u=u||(0,y.getConfig)(),e.next=4,F(t,r,n,{config:u,since:l,defaultWitness:d});case 4:return t=(t=e.sent).update("outputs",(function(e){return e.remove(e.size-1)})),e.abrupt("return",t);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(e,t,r,n){return V.apply(this,arguments)}function V(){return(V=n(i.mark((function e(t,r,n,a){var o,s,u,c,l,p,f,h;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=(o=void 0===a?{}:a).config,u=void 0===s?void 0:s,c=o.since,l=void 0===c?void 0:c,p=o.defaultWitness,f=void 0===p?"0x":p,u=u||(0,y.getConfig)(),h=r.cell_output.lock,!(0,g.isSecp256k1Blake160Script)(h,u)){e.next=7;break}return e.abrupt("return",d.default.setupInputCell(t,r,n,{config:u,defaultWitness:f,since:l}));case 7:if(!(0,g.isSecp256k1Blake160MultisigScript)(h,u)){e.next=11;break}return e.abrupt("return",m.secp256k1Blake160Multisig.setupInputCell(t,r,n,{config:u,defaultWitness:f,since:l}));case 11:throw new Error("Not supported input lock!");case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function W(e){if(58!==e.length)throw new Error("Invalid multisig with since args!");return k("0x"+e.slice(42))}t.CellCollector=B;var Y={CellCollector:B,transfer:T,payFee:L,prepareSigningEntries:U,injectCapacity:N,setupInputCell:F,injectCapacityWithoutChange:function(e,t,r,n,i,a){return D.apply(this,arguments)}};t.default=Y},8608:function(e,t,r){"use strict";var n=r(3572).default,i=r(2954).default,a=r(7162),o=r(4879).default,s=r(8133).default,u=r(1799).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.CellCollector=void 0,t.injectCapacity=S,t.payFee=_,t.prepareSigningEntries=E,t.setupInputCell=y,t.transfer=m;var c=r(7623),l=r(1674),p=r(9336),d=r(7143),f=r(3664),h=r(8278),v=r(4166),g=d.values.ScriptValue,b=function(){function e(e,t,r){var n=void 0===r?{}:r,i=n.config,a=void 0===i?void 0:i,o=n.queryOptions,s=void 0===o?{}:o;if(!t)throw new Error("Cell provider is missing!");a=a||(0,f.getConfig)(),this.fromScript=(0,v.parseFromInfo)(e,{config:a}).fromScript,this.config=a,s=Object.assign({},s,{lock:this.fromScript,type:s.type||"empty"}),this.cellCollector=t.collector(s)}return e.prototype.collect=function(){var e=this;return s(a.mark((function t(){var r,n,i,s,c,l;return a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((0,h.isSecp256k1Blake160Script)(e.fromScript,e.config)){t.next=2;break}return t.abrupt("return");case 2:r=!1,n=!1,t.prev=4,s=u(e.cellCollector.collect());case 6:return t.next=8,o(s.next());case 8:if(!(r=!(c=t.sent).done)){t.next=15;break}return l=c.value,t.next=12,l;case 12:r=!1,t.next=6;break;case 15:t.next=21;break;case 17:t.prev=17,t.t0=t.catch(4),n=!0,i=t.t0;case 21:if(t.prev=21,t.prev=22,!r||null==s.return){t.next=26;break}return t.next=26,o(s.return());case 26:if(t.prev=26,!n){t.next=29;break}throw i;case 29:return t.finish(26);case 30:return t.finish(21);case 31:case"end":return t.stop()}}),t,null,[[4,17,21,31],[22,,26,30]])})))()},e}();function y(e,t,r,n){return w.apply(this,arguments)}function w(){return(w=i(a.mark((function e(t,r,n,i){var o,s,u,c,p,v,b,y,w,m,x,_,k,S,C,E,P,I;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=(o=void 0===i?{}:i).config,u=void 0===s?void 0:s,c=o.defaultWitness,p=void 0===c?"0x":c,v=o.since,b=void 0===v?void 0:v,u=u||(0,f.getConfig)(),y=r.cell_output.lock,(0,h.isSecp256k1Blake160Script)(y,u)){e.next=5;break}throw new Error("Not SECP256K1_BLAKE160 input!");case 5:if(t=t.update("inputs",(function(e){return e.push(r)})),w={cell_output:{capacity:r.cell_output.capacity,lock:r.cell_output.lock,type:r.cell_output.type},data:r.data},t=t.update("outputs",(function(e){return e.push(w)})),b&&(t=t.update("inputSinces",(function(e){return e.set(t.get("inputs").size-1,b)}))),t=t.update("witnesses",(function(e){return e.push(p)})),m=u.SCRIPTS.SECP256K1_BLAKE160){e.next=13;break}throw new Error("SECP256K1_BLAKE160 script not defined in config!");case 13:if(x={tx_hash:m.TX_HASH,index:m.INDEX},t=(0,h.addCellDep)(t,{out_point:x,dep_type:m.DEP_TYPE}),-1===(_=t.get("inputs").findIndex((function(e){return new g(e.cell_output.lock,{validate:!1}).equals(new g(y,{validate:!1}))})))){e.next=31;break}for(;_>=t.get("witnesses").size;)t=t.update("witnesses",(function(e){return e.push("0x")}));if(k=t.get("witnesses").get(_),S={lock:h.SECP_SIGNATURE_PLACEHOLDER},"0x"===k){e.next=29;break}if(C=new d.core.WitnessArgs(new l.Reader(k)),!(E=C.getLock()).hasValue()||new l.Reader(E.value().raw()).serializeJson()===S.lock){e.next=25;break}throw new Error("Lock field in first witness is set aside for signature!");case 25:(P=C.getInputType()).hasValue()&&(S.input_type=new l.Reader(P.value().raw()).serializeJson()),(I=C.getOutputType()).hasValue()&&(S.output_type=new l.Reader(I.value().raw()).serializeJson());case 29:k=new l.Reader(d.core.SerializeWitnessArgs(l.normalizers.NormalizeWitnessArgs(S))).serializeJson(),t=t.update("witnesses",(function(e){return e.set(_,k)}));case 31:return e.abrupt("return",t);case 32:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e,t,r,n,i){return x.apply(this,arguments)}function x(){return(x=i(a.mark((function e(t,r,i,o,s){var v,b,y,w,m,x,_,k,S,C,E,P,I,A,z,B,T,O,H,j,D,L,R,U,N,M,K,q,F,V,W,Y,J,X,Z,G,$,Q;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(b=(v=void 0===s?{}:s).config,y=void 0===b?void 0:b,w=v.requireToAddress,m=void 0===w||w,x=v.assertAmountEnough,_=void 0===x||x,y=y||(0,f.getConfig)(),k=y.SCRIPTS.SECP256K1_BLAKE160){e.next=5;break}throw new Error("Provided config does not have SECP256K1_BLAKE160 script setup!");case 5:if(S={tx_hash:k.TX_HASH,index:k.INDEX},t=(0,h.addCellDep)(t,{out_point:S,dep_type:k.DEP_TYPE}),C=(0,p.parseAddress)(r,{config:y}),(0,h.ensureScript)(C,y,"SECP256K1_BLAKE160"),!m||i){e.next=11;break}throw new Error("You must provide a to address!");case 11:for(o=BigInt(o),i&&(E=(0,p.parseAddress)(i,{config:y}),t=t.update("outputs",(function(e){return e.push({cell_output:{capacity:"0x"+o.toString(16),lock:E,type:void 0},data:"0x",out_point:void 0,block_hash:void 0})}))),P=t.get("fixedEntries").filter((function(e){return"outputs"===e.field})).maxBy((function(e){return e.index})),I=P?P.index+1:0;I<t.get("outputs").size&&o>0;I++)A=t.get("outputs").get(I),new g(A.cell_output.lock,{validate:!1}).equals(new g(C,{validate:!1}))&&(z=BigInt(A.cell_output.capacity),B=void 0,o>=z?B=z:(B=z-(0,p.minimalCellCapacity)(A))>o&&(B=o),o-=B,A.cell_output.capacity="0x"+(z-B).toString(16));if(t=t.update("outputs",(function(e){return e.filter((function(e){return BigInt(e.cell_output.capacity)!==BigInt(0)}))})),!(o>0)){e.next=59;break}if(T=t.get("cellProvider")){e.next=21;break}throw new Error("Cell provider is missing!");case 21:for(O=T.collector({lock:C}),H={cell_output:{capacity:"0x0",lock:C,type:void 0},data:"0x",out_point:void 0,block_hash:void 0},j=BigInt(0),D=(0,c.Set)(),L=n(t.get("inputs"));!(R=L()).done;)U=R.value,D=D.add(U.out_point.tx_hash+"_"+U.out_point.index);N=!1,M=!1,e.prev=28,q=function(){var e=V.value;if(D.has(e.out_point.tx_hash+"_"+e.out_point.index))return"continue";t=(t=t.update("inputs",(function(t){return t.push(e)}))).update("witnesses",(function(e){return e.push("0x")}));var r=BigInt(e.cell_output.capacity),n=r;return n>o&&(n=o),j+=r-n,(o-=n)===BigInt(0)&&(j===BigInt(0)||j>(0,p.minimalCellCapacity)(H))?"break":void 0},F=u(O.collect());case 31:return e.next=33,F.next();case 33:if(!(N=!(V=e.sent).done)){e.next=42;break}if("continue"!==(W=q())){e.next=37;break}return e.abrupt("continue",39);case 37:if("break"!==W){e.next=39;break}return e.abrupt("break",42);case 39:N=!1,e.next=31;break;case 42:e.next=48;break;case 44:e.prev=44,e.t0=e.catch(28),M=!0,K=e.t0;case 48:if(e.prev=48,e.prev=49,!N||null==F.return){e.next=53;break}return e.next=53,F.return();case 53:if(e.prev=53,!M){e.next=56;break}throw K;case 56:return e.finish(53);case 57:return e.finish(48);case 58:j>BigInt(0)&&(H.cell_output.capacity="0x"+j.toString(16),t=t.update("outputs",(function(e){return e.push(H)})));case 59:if(!(o>0&&_)){e.next=61;break}throw new Error("Not enough capacity in from address!");case 61:if(Y=t.get("inputs").findIndex((function(e){return new g(e.cell_output.lock,{validate:!1}).equals(new g(C,{validate:!1}))})),-1===Y){e.next=77;break}for(;Y>=t.get("witnesses").size;)t=t.update("witnesses",(function(e){return e.push("0x")}));if(J=t.get("witnesses").get(Y),X={lock:h.SECP_SIGNATURE_PLACEHOLDER},"0x"===J){e.next=75;break}if(Z=new d.core.WitnessArgs(new l.Reader(J)),!(G=Z.getLock()).hasValue()||new l.Reader(G.value().raw()).serializeJson()===X.lock){e.next=71;break}throw new Error("Lock field in first witness is set aside for signature!");case 71:($=Z.getInputType()).hasValue()&&(X.input_type=new l.Reader($.value().raw()).serializeJson()),(Q=Z.getOutputType()).hasValue()&&(X.output_type=new l.Reader(Q.value().raw()).serializeJson());case 75:J=new l.Reader(d.core.SerializeWitnessArgs(l.normalizers.NormalizeWitnessArgs(X))).serializeJson(),t=t.update("witnesses",(function(e){return e.set(Y,J)}));case 77:if(_){e.next=79;break}return e.abrupt("return",[t,o]);case 79:return e.abrupt("return",t);case 80:case"end":return e.stop()}}),e,null,[[28,44,48,58],[49,,53,57]])})))).apply(this,arguments)}function _(e,t,r,n){return k.apply(this,arguments)}function k(){return(k=i(a.mark((function e(t,r,n,i){var o,s;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=(void 0===i?{}:i).config,s=(s=void 0===o?void 0:o)||(0,f.getConfig)(),e.next=4,m(t,r,null,n,{config:s,requireToAddress:!1});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e,t,r,n){return C.apply(this,arguments)}function C(){return(C=i(a.mark((function e(t,r,n,i){var o,s,u;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=(void 0===i?{}:i).config,s=(s=void 0===o?void 0:o)||(0,f.getConfig)(),!(r>=t.get("outputs").size)){e.next=4;break}throw new Error("Invalid output index!");case 4:return u=BigInt(t.get("outputs").get(r).cell_output.capacity),e.next=7,m(t,n,null,u,{config:s,requireToAddress:!1});case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e,t){var r=(void 0===t?{}:t).config,n=void 0===r?void 0:r;return n=n||(0,f.getConfig)(),(0,h.prepareSigningEntries)(e,n,"SECP256K1_BLAKE160")}t.CellCollector=b;var P={transfer:m,payFee:_,prepareSigningEntries:E,injectCapacity:S,setupInputCell:y,CellCollector:b};t.default=P},3009:function(e,t,r){"use strict";var n=r(3572).default,i=r(2954).default,a=r(7162),o=r(4879).default,s=r(8133).default,u=r(1799).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.CellCollector=void 0,t.injectCapacity=S,Object.defineProperty(t,"multisigArgs",{enumerable:!0,get:function(){return v.multisigArgs}}),t.payFee=_,t.prepareSigningEntries=E,Object.defineProperty(t,"serializeMultisigScript",{enumerable:!0,get:function(){return v.serializeMultisigScript}}),t.setupInputCell=y,t.transfer=m;var c=r(9336),l=r(7143),p=r(3664),d=r(1674),f=r(7623),h=r(8278),v=r(4166),g=l.values.ScriptValue,b=function(){function e(e,t,r){var n=void 0===r?{}:r,i=n.config,a=void 0===i?void 0:i,o=n.queryOptions,s=void 0===o?{}:o;if(!t)throw new Error("Cell provider is missing!");a=a||(0,p.getConfig)();var u=(0,v.parseFromInfo)(e,{config:a});this.fromScript=u.fromScript,this.multisigScript=u.multisigScript,this.config=a,s=Object.assign({},s,{lock:this.fromScript,type:s.type||"empty"}),this.cellCollector=t.collector(s)}return e.prototype.collect=function(){var e=this;return s(a.mark((function t(){var r,n,i,s,c,l;return a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((0,h.isSecp256k1Blake160MultisigScript)(e.fromScript,e.config)){t.next=2;break}return t.abrupt("return");case 2:r=!1,n=!1,t.prev=4,s=u(e.cellCollector.collect());case 6:return t.next=8,o(s.next());case 8:if(!(r=!(c=t.sent).done)){t.next=15;break}return l=c.value,t.next=12,l;case 12:r=!1,t.next=6;break;case 15:t.next=21;break;case 17:t.prev=17,t.t0=t.catch(4),n=!0,i=t.t0;case 21:if(t.prev=21,t.prev=22,!r||null==s.return){t.next=26;break}return t.next=26,o(s.return());case 26:if(t.prev=26,!n){t.next=29;break}throw i;case 29:return t.finish(26);case 30:return t.finish(21);case 31:case"end":return t.stop()}}),t,null,[[4,17,21,31],[22,,26,30]])})))()},e}();function y(e,t,r,n){return w.apply(this,arguments)}function w(){return(w=i(a.mark((function e(t,r,n,i){var o,s,u,c,f,b,y,w,m,x,_,k,S,C,E,P,I,A,z,B,T,O;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=(o=void 0===i?{}:i).config,u=void 0===s?void 0:s,c=o.defaultWitness,f=void 0===c?"0x":c,b=o.since,y=void 0===b?void 0:b,w=o.requireMultisigScript,m=void 0===w||w,u=u||(0,p.getConfig)(),!m||"object"==typeof n){e.next=4;break}throw new Error("`fromInfo` must be MultisigScript format!");case 4:if(x=r.cell_output.lock,!n){e.next=9;break}if(_=(0,v.parseFromInfo)(n,{config:u}).fromScript,new g(_,{validate:!1}).equals(new g(x,{validate:!1}))){e.next=9;break}throw new Error("`fromInfo` not match to input lock!");case 9:if((0,h.isSecp256k1Blake160MultisigScript)(x,u)){e.next=11;break}throw new Error("Not SECP256K1_BLAKE160_MULTISIG input!");case 11:if(t=t.update("inputs",(function(e){return e.push(r)})),y&&(t=t.update("inputSinces",(function(e){return e.set(t.get("inputs").size-1,y)}))),t=t.update("witnesses",(function(e){return e.push(f)})),k={cell_output:{capacity:r.cell_output.capacity,lock:r.cell_output.lock,type:r.cell_output.type},data:r.data},t=t.update("outputs",(function(e){return e.push(k)})),S=u.SCRIPTS.SECP256K1_BLAKE160_MULTISIG){e.next=19;break}throw new Error("SECP256K1_BLAKE160_MULTISIG script not defined in config!");case 19:if(C={tx_hash:S.TX_HASH,index:S.INDEX},t=(0,h.addCellDep)(t,{out_point:C,dep_type:S.DEP_TYPE}),-1===(E=t.get("inputs").findIndex((function(e){return new g(e.cell_output.lock,{validate:!1}).equals(new g(x,{validate:!1}))})))){e.next=42;break}for(;E>=t.get("witnesses").size;)t=t.update("witnesses",(function(e){return e.push("0x")}));if("0x"!==t.get("witnesses").get(E)||"object"==typeof n){e.next=27;break}throw new Error("`fromInfo` must be MultisigScript format!");case 27:if("object"!=typeof n){e.next=42;break}if(P=(0,v.parseFromInfo)(n,{config:u}).multisigScript,I=t.get("witnesses").get(E),A={lock:"0x"+P.slice(2)+h.SECP_SIGNATURE_PLACEHOLDER.slice(2).repeat(n.M)},"0x"===I){e.next=40;break}if(z=new l.core.WitnessArgs(new d.Reader(I)),!(B=z.getLock()).hasValue()||new d.Reader(B.value().raw()).serializeJson()===A.lock){e.next=36;break}throw new Error("Lock field in first witness is set aside for signature!");case 36:(T=z.getInputType()).hasValue()&&(A.input_type=new d.Reader(T.value().raw()).serializeJson()),(O=z.getOutputType()).hasValue()&&(A.output_type=new d.Reader(O.value().raw()).serializeJson());case 40:I=new d.Reader(l.core.SerializeWitnessArgs(d.normalizers.NormalizeWitnessArgs(A))).serializeJson(),t=t.update("witnesses",(function(e){return e.set(E,I)}));case 42:return e.abrupt("return",t);case 43:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e,t,r,n,i){return x.apply(this,arguments)}function x(){return(x=i(a.mark((function e(t,r,i,o,s){var b,y,w,m,x,_,k,S,C,E,P,I,A,z,B,T,O,H,j,D,L,R,U,N,M,K,q,F,V,W,Y,J,X,Z,G,$,Q,ee,te,re,ne;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(y=(b=void 0===s?{}:s).config,w=void 0===y?void 0:y,m=b.requireToAddress,x=void 0===m||m,_=b.assertAmountEnough,k=void 0===_||_,w=w||(0,p.getConfig)(),S=w.SCRIPTS.SECP256K1_BLAKE160_MULTISIG){e.next=5;break}throw new Error("Provided config does not have SECP256K1_BLAKE16_MULTISIG script setup!");case 5:if(C={tx_hash:S.TX_HASH,index:S.INDEX},t=(0,h.addCellDep)(t,{out_point:C,dep_type:S.DEP_TYPE}),E=(0,v.parseFromInfo)(r,{config:w}),P=E.fromScript,I=E.multisigScript,(0,h.ensureScript)(P,w,"SECP256K1_BLAKE160_MULTISIG"),A=!t.get("inputs").find((function(e){return new g(e.cell_output.lock,{validate:!1}).equals(new g(P,{validate:!1}))})),!A||"string"!=typeof r){e.next=12;break}throw new Error("MultisigScript is required for witness!");case 12:if(!x||i){e.next=14;break}throw new Error("You must provide a to address!");case 14:for(o=BigInt(o||0),i&&(z=(0,c.parseAddress)(i,{config:w}),t=t.update("outputs",(function(e){return e.push({cell_output:{capacity:"0x"+o.toString(16),lock:z,type:void 0},data:"0x",out_point:void 0,block_hash:void 0})}))),B=t.get("fixedEntries").filter((function(e){return"outputs"===e.field})).maxBy((function(e){return e.index})),T=B?B.index+1:0;T<t.get("outputs").size&&o>0;++T)O=t.get("outputs").get(T),new g(O.cell_output.lock,{validate:!1}).equals(new g(P,{validate:!1}))&&(H=BigInt(O.cell_output.capacity),j=void 0,o>=H?j=H:(j=H-(0,c.minimalCellCapacity)(O))>o&&(j=o),o-=j,O.cell_output.capacity="0x"+(H-j).toString(16));if(t=t.update("outputs",(function(e){return e.filter((function(e){return BigInt(e.cell_output.capacity)!==BigInt(0)}))})),!(o>0n)){e.next=62;break}if(D=t.get("cellProvider")){e.next=24;break}throw new Error("cell provider is missing!");case 24:for(L=D.collector({lock:P}),R={cell_output:{capacity:"0x0",lock:P,type:void 0},data:"0x",out_point:void 0,block_hash:void 0},U=BigInt(0),N=(0,f.Set)(),M=n(t.get("inputs"));!(K=M()).done;)q=K.value,N=N.add(q.out_point.tx_hash+"_"+q.out_point.index);F=!1,V=!1,e.prev=31,Y=function(){var e=X.value;if(N.has(e.out_point.tx_hash+"_"+e.out_point.index))return"continue";t=(t=t.update("inputs",(function(t){return t.push(e)}))).update("witnesses",(function(e){return e.push("0x")}));var r=BigInt(e.cell_output.capacity),n=r;return n>o&&(n=o),U+=r-n,(o-=n)===BigInt(0)&&(U===BigInt(0)||U>(0,c.minimalCellCapacity)(R))?"break":void 0},J=u(L.collect());case 34:return e.next=36,J.next();case 36:if(!(F=!(X=e.sent).done)){e.next=45;break}if("continue"!==(Z=Y())){e.next=40;break}return e.abrupt("continue",42);case 40:if("break"!==Z){e.next=42;break}return e.abrupt("break",45);case 42:F=!1,e.next=34;break;case 45:e.next=51;break;case 47:e.prev=47,e.t0=e.catch(31),V=!0,W=e.t0;case 51:if(e.prev=51,e.prev=52,!F||null==J.return){e.next=56;break}return e.next=56,J.return();case 56:if(e.prev=56,!V){e.next=59;break}throw W;case 59:return e.finish(56);case 60:return e.finish(51);case 61:U>BigInt(0)&&(R.cell_output.capacity="0x"+U.toString(16),t=t.update("outputs",(function(e){return e.push(R)})));case 62:if(!(o>0&&k)){e.next=64;break}throw new Error("Not enough capacity in from address!");case 64:if(G=t.get("inputs").findIndex((function(e){return new g(e.cell_output.lock,{validate:!1}).equals(new g(P,{validate:!1}))})),-1===G){e.next=81;break}for(;G>=t.get("witnesses").size;)t=t.update("witnesses",(function(e){return e.push("0x")}));if(!A&&"string"==typeof r){e.next=81;break}if($=t.get("witnesses").get(G),Q={lock:"0x"+I.slice(2)+h.SECP_SIGNATURE_PLACEHOLDER.slice(2).repeat(r.M)},"0x"===$){e.next=79;break}if(ee=new l.core.WitnessArgs(new d.Reader($)),!(te=ee.getLock()).hasValue()||new d.Reader(te.value().raw()).serializeJson()===Q.lock){e.next=75;break}throw new Error("Lock field in first witness is set aside for signature!");case 75:(re=ee.getInputType()).hasValue()&&(Q.input_type=new d.Reader(re.value().raw()).serializeJson()),(ne=ee.getOutputType()).hasValue()&&(Q.output_type=new d.Reader(ne.value().raw()).serializeJson());case 79:$=new d.Reader(l.core.SerializeWitnessArgs(d.normalizers.NormalizeWitnessArgs(Q))).serializeJson(),t=t.update("witnesses",(function(e){return e.set(G,$)}));case 81:if(k){e.next=83;break}return e.abrupt("return",[t,o]);case 83:return e.abrupt("return",t);case 84:case"end":return e.stop()}}),e,null,[[31,47,51,61],[52,,56,60]])})))).apply(this,arguments)}function _(e,t,r,n){return k.apply(this,arguments)}function k(){return(k=i(a.mark((function e(t,r,n,i){var o,s;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=(void 0===i?{}:i).config,s=(s=void 0===o?void 0:o)||(0,p.getConfig)(),e.abrupt("return",m(t,r,void 0,n,{config:s,requireToAddress:!1}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e,t,r,n){return C.apply(this,arguments)}function C(){return(C=i(a.mark((function e(t,r,n,i){var o,s,u;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=(void 0===i?{}:i).config,s=(s=void 0===o?void 0:o)||(0,p.getConfig)(),!(r>=t.get("outputs").size)){e.next=4;break}throw new Error("Invalid output index!");case 4:return u=BigInt(t.get("outputs").get(r).cell_output.capacity),e.abrupt("return",m(t,n,void 0,u,{config:s,requireToAddress:!1}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e,t){var r=(void 0===t?{}:t).config,n=void 0===r?void 0:r;return n=n||(0,p.getConfig)(),(0,h.prepareSigningEntries)(e,n,"SECP256K1_BLAKE160_MULTISIG")}t.CellCollector=b;var P={transfer:m,payFee:_,prepareSigningEntries:E,serializeMultisigScript:v.serializeMultisigScript,multisigArgs:v.multisigArgs,injectCapacity:S,setupInputCell:y,CellCollector:b};t.default=P},6165:function(e,t,r){"use strict";var n=r(3572).default,i=r(7162),a=r(2954).default,o=r(1799).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.issueToken=C,t.ownerForSudt=z,t.transfer=P;var s=r(8278),u=r(7143),c=w(r(3009)),l=r(4166),p=w(r(844)),d=r(9336),f=r(7623),h=r(3664),v=r(2584),g=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=y(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(82)),b=w(r(8608));function y(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(y=function(e){return e?r:t})(e)}function w(e){return e&&e.__esModule?e:{default:e}}var m=u.utils,x=m.toBigUInt128LE,_=m.readBigUInt128LE,k=m.computeScriptHash,S=u.values.ScriptValue;function C(e,t,r,n,i,a){return E.apply(this,arguments)}function E(){return(E=a(i.mark((function e(t,r,n,a,o,u){var c,f,v,g,b,y,w,m;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=(void 0===u?{}:u).config,f=(f=void 0===c?void 0:c)||(0,h.getConfig)(),v=f.SCRIPTS.SUDT){e.next=5;break}throw new Error("Provided config does not have SUDT script setup!");case 5:return t=(0,s.addCellDep)(t,{out_point:{tx_hash:v.TX_HASH,index:v.INDEX},dep_type:v.DEP_TYPE}),g=(0,l.parseFromInfo)(r,{config:f}).fromScript,b=g,y={code_hash:v.CODE_HASH,hash_type:v.HASH_TYPE,args:k(g)},w={cell_output:{capacity:"0x0",lock:b,type:y},data:x(n),out_point:void 0,block_hash:void 0},a||(a=(0,d.minimalCellCapacity)(w)),a=BigInt(a),w.cell_output.capacity="0x"+a.toString(16),t=t.update("outputs",(function(e){return e.push(w)})),m=t.get("outputs").size-1,t=t.update("fixedEntries",(function(e){return e.push({field:"outputs",index:m})})),e.next=18,p.default.injectCapacity(t,[r],BigInt(w.cell_output.capacity),void 0,o,{config:f});case 18:return t=e.sent,e.abrupt("return",t);case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e,t,r,n,i,a,o,s,u){return I.apply(this,arguments)}function I(){return(I=a(i.mark((function e(t,r,a,u,y,w,m,k,C){var E,P,I,z,B,T,O,H,j,D,L,R,U,N,M,K,q,F,V,W,Y,J,X,Z,G,$,Q,ee,te,re,ne,ie,ae,oe,se,ue,ce,le,pe,de,fe,he,ve,ge,be,ye,we,me,xe,_e;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(P=(E=void 0===C?{}:C).config,I=void 0===P?void 0:P,z=E.LocktimePoolCellCollector,B=void 0===z?v.CellCollector:z,T=E.splitChangeCell,O=void 0!==T&&T,I=I||(0,h.getConfig)(),H=I.SCRIPTS.SUDT){e.next=5;break}throw new Error("Provided config does not have SUDT script setup!");case 5:if(0!==r.length){e.next=7;break}throw new Error("`fromInfos` can't be empty!");case 7:if(u){e.next=9;break}throw new Error("You must provide a to address!");case 9:if(j=(0,d.parseAddress)(u,{config:I}),D=r.map((function(e){return(0,l.parseFromInfo)(e,{config:I}).fromScript})),L=w?(0,d.parseAddress)(w,{config:I}):D[0],!((y=BigInt(y))<=0n)){e.next=15;break}throw new Error("amount must be greater than 0");case 15:if(R=A(a,I),U=t.get("cellProvider")){e.next=19;break}throw new Error("Cell provider is missing!");case 19:if(N=0n,M=0n,!(0,s.isAcpScript)(j,I)){e.next=32;break}return K=new g.CellCollector(u,U,{config:I,queryOptions:{type:R,data:"any"}}),e.next=25,K.collect().next();case 25:if(q=e.sent.value){e.next=28;break}throw new Error("toAddress ANYONE_CAN_PAY input not found!");case 28:t=(t=t.update("inputs",(function(e){return e.push(q)}))).update("witnesses",(function(e){return e.push("0x")})),N=BigInt(q.cell_output.capacity),M=_(q.data);case 32:for(F={cell_output:{capacity:"0x0",lock:j,type:R},data:x(y),out_point:void 0,block_hash:void 0},m&&(m=BigInt(m)),(0,s.isAcpScript)(j,I)?(m||(m=0n),F.cell_output.capacity="0x"+(N+m).toString(16),F.data=x(M+BigInt(y))):(m||(m=(0,d.minimalCellCapacity)(F)),F.cell_output.capacity="0x"+m.toString(16)),t=(t=t.update("outputs",(function(e){return e.push(F)}))).update("fixedEntries",(function(e){return e.push({field:"outputs",index:t.get("outputs").size-1})})),t=(0,s.addCellDep)(t,{out_point:{tx_hash:H.TX_HASH,index:H.INDEX},dep_type:H.DEP_TYPE}),V={cell_output:{capacity:"0x0",lock:L,type:R},data:x(0n),out_point:void 0,block_hash:void 0},W={cell_output:{capacity:"0x0",lock:L,type:void 0},data:"0x",out_point:void 0,block_hash:void 0},Y=BigInt(0),J=BigInt(0),X=(0,f.Set)(),Z=n(t.get("inputs"));!(G=Z()).done;)$=G.value,X=X.add($.out_point.tx_hash+"_"+$.out_point.index);Q=(0,f.List)(),k&&r.forEach((function(e,t){var r=new B(e,U,{config:I,tipHeader:k,queryOptions:{type:R,data:"any"}});Q=Q.push({cellCollector:r,index:t})})),r.forEach((function(e,t){var r=new b.default.CellCollector(e,U,{config:I,queryOptions:{type:R,data:"any"}}),n=new c.default.CellCollector(e,U,{config:I,queryOptions:{type:R,data:"any"}}),i=new g.default.CellCollector(e,U,{config:I,queryOptions:{type:R,data:"any"}});Q=Q.push({cellCollector:r,index:t},{cellCollector:n,index:t},{cellCollector:i,index:t,isAnyoneCanPay:!0,destroyable:(0,l.parseFromInfo)(e,{config:I}).destroyable})})),k&&r.forEach((function(e,t){var r=new B(e,U,{config:I,tipHeader:k});Q=Q.push({cellCollector:r,index:t})})),r.forEach((function(e,t){var r=new b.default.CellCollector(e,U,{config:I}),n=new c.default.CellCollector(e,U,{config:I}),i=new g.default.CellCollector(e,U,{config:I});Q=Q.push({cellCollector:r,index:t},{cellCollector:n,index:t},{cellCollector:i,index:t,isAnyoneCanPay:!0,destroyable:(0,l.parseFromInfo)(e,{config:I}).destroyable})})),ee=n(Q);case 50:if((te=ee()).done){e.next=87;break}re=te.value,ne=re.index,ie=re.cellCollector,ae=re.isAnyoneCanPay,oe=re.destroyable,se=!1,ue=!1,e.prev=54,le=i.mark((function e(){var n,a,o,s,u,c,l,f,h,v,g,b;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=de.value,a=n.out_point.tx_hash+"_"+n.out_point.index,!X.has(a)){e.next=4;break}return e.abrupt("return","continue");case 4:return X=X.add(a),o=r[ne],e.next=8,p.default.setupInputCell(t,n,o,{config:I});case 8:if(t=e.sent,s=t.get("outputs").size-1,t=t.update("outputs",(function(e){return e.remove(s)})),(u=t.get("fixedEntries").findIndex((function(e){return"outputs"===e.field&&e.index===s})))>=0&&(t=t.update("fixedEntries",(function(e){return e.remove(u)}))),c=BigInt(n.cell_output.capacity),l=n.cell_output.type?_(n.data):0n,(f=ae&&!oe?c-(0,d.minimalCellCapacity)(n):c)>m&&(f=m),m-=f,v=c-f,(!ae||ae&&oe)&&(Y+=v),(h=l)>y&&(h=y),y-=h,g=l-h,(!ae||ae&&oe)&&(J+=g),ae&&!oe&&(b={cell_output:{capacity:"0x"+v.toString(16),lock:n.cell_output.lock,type:n.cell_output.type},data:n.cell_output.type?x(g):"0x"},t=t.update("outputs",(function(e){return e.push(b)})),n.cell_output.type&&(t=t.update("fixedEntries",(function(e){return e.push({field:"outputs",index:t.get("outputs").size-1})})))),0n!==m||0n!==y||!(0n===Y&&0n===J||Y>(0,d.minimalCellCapacity)(W)&&0n===J)){e.next=30;break}return V.cell_output.type=void 0,V.data="0x",e.abrupt("return","break");case 30:if(!(0n===m&&0n===y&&Y>(0,d.minimalCellCapacity)(W)&&J>0n)){e.next=32;break}return e.abrupt("return","break");case 32:case"end":return e.stop()}}),e)})),pe=o(ie.collect());case 57:return e.next=59,pe.next();case 59:if(!(se=!(de=e.sent).done)){e.next=69;break}return e.delegateYield(le(),"t0",61);case 61:if("continue"!==(fe=e.t0)){e.next=64;break}return e.abrupt("continue",66);case 64:if("break"!==fe){e.next=66;break}return e.abrupt("break",69);case 66:se=!1,e.next=57;break;case 69:e.next=75;break;case 71:e.prev=71,e.t1=e.catch(54),ue=!0,ce=e.t1;case 75:if(e.prev=75,e.prev=76,!se||null==pe.return){e.next=80;break}return e.next=80,pe.return();case 80:if(e.prev=80,!ue){e.next=83;break}throw ce;case 83:return e.finish(80);case 84:return e.finish(75);case 85:e.next=50;break;case 87:if(he=-1,!(0,s.isAcpScript)(V.cell_output.lock,I)||-1===(he=t.get("outputs").findIndex((function(e){return new S(V.cell_output.lock,{validate:!1}).equals(new S(e.cell_output.lock,{validate:!1}))&&(0n===J&&!V.cell_output.type&&!e.cell_output.type||J>=0n&&!!V.cell_output.type&&!!e.cell_output.type&&new S(V.cell_output.type,{validate:!1}).equals(new S(e.cell_output.type,{validate:!1})))})))||-1!==t.get("fixedEntries").findIndex((function(e){return"output"===e.field&&e.index===he}))){e.next=101;break}ve=t.get("outputs").get(he),(ge=JSON.parse(JSON.stringify(ve))).cell_output.capacity="0x"+(BigInt(ve.cell_output.capacity)+Y).toString(16),J>0&&(ge.data=x(_(ve.data)+J)),be=(0,d.minimalCellCapacity)(V),ye=(0,d.minimalCellCapacity)(W),we=!1,J>0n&&O&&Y>=be+ye&&(ge.cell_output.capacity=ve.cell_output.capacity,W.cell_output.capacity="0x"+Y.toString(16),we=!0),t=t.update("outputs",(function(e){return e.set(he,ge)})),we&&(t=t.update("outputs",(function(e){return e.push(W)}))),e.next=115;break;case 101:if(!(Y>=(0,d.minimalCellCapacity)(V))){e.next=113;break}V.cell_output.capacity="0x"+Y.toString(16),J>0n&&(V.data=x(J)),me=(0,d.minimalCellCapacity)(V),xe=(0,d.minimalCellCapacity)(W),_e=!1,J>0n&&O&&Y>=me+xe&&(V.cell_output.capacity="0x"+me.toString(16),W.cell_output.capacity="0x"+(Y-me).toString(16),_e=!0),t=t.update("outputs",(function(e){return e.push(V)})),J>0n&&(t=t.update("fixedEntries",(function(e){return e.push({field:"outputs",index:t.get("outputs").size-1})}))),_e&&(t=t.update("outputs",(function(e){return e.push(W)}))),e.next=115;break;case 113:if(!(J>0n&&Y<(0,d.minimalCellCapacity)(V))){e.next=115;break}throw new Error("Not enough capacity for change in from infos!");case 115:if(!(m>0)){e.next=117;break}throw new Error("Not enough capacity in from infos!");case 117:if(!(y>0)){e.next=119;break}throw new Error("Not enough amount in from infos!");case 119:return e.abrupt("return",t);case 120:case"end":return e.stop()}}),e,null,[[54,71,75,85],[76,,80,84]])})))).apply(this,arguments)}function A(e,t){var r=t.SCRIPTS.SUDT;return{code_hash:r.CODE_HASH,hash_type:r.HASH_TYPE,args:e}}function z(e,t){var r=(void 0===t?{}:t).config,n=void 0===r?void 0:r;n=n||(0,h.getConfig)();var i=(0,l.parseFromInfo)(e,{config:n}).fromScript;return k(i)}var B={issueToken:C,transfer:P,ownerForSudt:z};t.default=B},8902:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findConfigByScript=function(e,t){var r=t||(0,n.getConfig)().SCRIPTS;return Object.values(r).find((function(t){return(null==t?void 0:t.CODE_HASH)===e.code_hash&&(null==t?void 0:t.HASH_TYPE)===e.hash_type}))},t.nameOfScript=function(e,t){var r=t||(0,n.getConfig)().SCRIPTS,i=Object.entries(r).find((function(t){var r=t[1];return(null==r?void 0:r.CODE_HASH)===e.code_hash&&(null==r?void 0:r.HASH_TYPE)===e.hash_type}));return i?i[0]:void 0};var n=r(6741)},3664:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={initializeConfig:!0,getConfig:!0,validateConfig:!0,CKB2019:!0,CKB2021:!0,helpers:!0,predefined:!0,createConfig:!0};Object.defineProperty(t,"CKB2019",{enumerable:!0,get:function(){return a.CKB2019}}),Object.defineProperty(t,"CKB2021",{enumerable:!0,get:function(){return a.CKB2021}}),Object.defineProperty(t,"createConfig",{enumerable:!0,get:function(){return s.createConfig}}),Object.defineProperty(t,"getConfig",{enumerable:!0,get:function(){return a.getConfig}}),t.helpers=void 0,Object.defineProperty(t,"initializeConfig",{enumerable:!0,get:function(){return a.initializeConfig}}),Object.defineProperty(t,"predefined",{enumerable:!0,get:function(){return s.predefined}}),Object.defineProperty(t,"validateConfig",{enumerable:!0,get:function(){return a.validateConfig}});var i=r(5461);Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||e in t&&t[e]===i[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}}))}));var a=r(6741),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=u(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(8902));t.helpers=o;var s=r(4290);function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(u=function(e){return e?r:t})(e)}},6741:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CKB2019=function(e){return Object.assign({},e,{CKB2021:!1})},t.CKB2021=function(e){return Object.assign({},e,{CKB2021:!0})},t.getConfig=function(){return p},t.initializeConfig=function(e){e?(l(e),p=(0,i.default)(e)):(a.logger.deprecated("initializeConfig with env will be deprecated, please migrate to initializeConfig(...)"),function(){var e,t=null===(e=process)||void 0===e?void 0:e.env,n=null==t?void 0:t.LUMOS_CONFIG_NAME;if(("LINA"===n||"AGGRON4"===n)&&o.predefined[n])return void(p=o.predefined[n]);var a=(null==t?void 0:t.LUMOS_CONFIG_FILE)||"config.json";try{var s=r(9441).readFileSync(a),u=JSON.parse(s);l(u),p=(0,i.default)(u)}catch(c){throw new Error("Error loading config from file "+a+": "+c)}}())},t.validateConfig=l;var n,i=(n=r(8629))&&n.__esModule?n:{default:n},a=r(7143),o=r(4290);function s(e,t){if(function(e,t){if(!/^0x([0-9a-fA-F][0-9a-fA-F])*$/.test(t))throw new Error(e+" must be a hex string!")}(e,t),66!=t.length)throw new Error(e+" must be a hex string of 66 bytes long!")}function u(e,t){if("0x0"!==t&&!/^0x[1-9a-fA-F][0-9a-fA-F]*$/.test(t))throw new Error(e+" must be a hex integer!")}function c(e,t){if(void 0===t&&(t="variable"),!e)throw new Error(t+" is not valid")}function l(e){c("object"==typeof e.SCRIPTS&&null!=e.SCRIPTS,"config.SCRIPT");for(var t=0,r=Object.keys(e.SCRIPTS);t<r.length;t++){var n=r[t],i=e.SCRIPTS[n];c(null==i?void 0:i.CODE_HASH),s("SCRIPTS."+n+".CODE_HASH",i.CODE_HASH);var a=i.HASH_TYPE;if("type"!==a&&"data"!==a)throw new Error("SCRIPTS."+n+".HASH_TYPE must either be data or type!");s("SCRIPTS."+n+".TX_HASH",i.TX_HASH),u("SCRIPTS."+n+".INDEX",i.INDEX);var o=i.DEP_TYPE;if("dep_group"!==o&&"code"!==o)throw new Error("SCRIPTS."+n+".DEP_TYPE must either be dep_group or code!");var l=i.SHORT_ID;if(null!=l&&"number"!=typeof l)throw new Error("SHORT_ID must be a number!")}}var p=o.predefined.LINA},4290:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createConfig=a,t.predefined=void 0;var n,i=(n=r(8629))&&n.__esModule?n:{default:n};function a(e){return(0,i.default)(e)}var o={LINA:a({PREFIX:"ckb",SCRIPTS:{SECP256K1_BLAKE160:{CODE_HASH:"0x9bd7e06f3ecf4be0f2fcd2188b23f1b9fcc88e5d4b65a8637b17723bbda3cce8",HASH_TYPE:"type",TX_HASH:"0x71a7ba8fc96349fea0ed3a5c47992e3b4084b031a42264a018e0072e8172e46c",INDEX:"0x0",DEP_TYPE:"dep_group",SHORT_ID:0},SECP256K1_BLAKE160_MULTISIG:{CODE_HASH:"0x5c5069eb0857efc65e1bca0c07df34c31663b3622fd3876c876320fc9634e2a8",HASH_TYPE:"type",TX_HASH:"0x71a7ba8fc96349fea0ed3a5c47992e3b4084b031a42264a018e0072e8172e46c",INDEX:"0x1",DEP_TYPE:"dep_group",SHORT_ID:1},DAO:{CODE_HASH:"0x82d76d1b75fe2fd9a27dfbaa65a039221a380d76c926f378d3f81cf3e7e13f2e",HASH_TYPE:"type",TX_HASH:"0xe2fb199810d49a4d8beec56718ba2593b665db9d52299a0f9e6e75416d73ff5c",INDEX:"0x2",DEP_TYPE:"code"},SUDT:{CODE_HASH:"0x5e7a36a77e68eecc013dfa2fe6a23f3b6c344b04005808694ae6dd45eea4cfd5",HASH_TYPE:"type",TX_HASH:"0xc7813f6a415144643970c2e88e0bb6ca6a8edc5dd7c1022746f628284a9936d5",INDEX:"0x0",DEP_TYPE:"code"},ANYONE_CAN_PAY:{CODE_HASH:"0xd369597ff47f29fbc0d47d2e3775370d1250b85140c670e4718af712983a2354",HASH_TYPE:"type",TX_HASH:"0x4153a2014952d7cac45f285ce9a7c5c0c0e1b21f2d378b82ac1433cb11c25c4d",INDEX:"0x0",DEP_TYPE:"dep_group",SHORT_ID:2}}}),AGGRON4:a({PREFIX:"ckt",SCRIPTS:{SECP256K1_BLAKE160:{CODE_HASH:"0x9bd7e06f3ecf4be0f2fcd2188b23f1b9fcc88e5d4b65a8637b17723bbda3cce8",HASH_TYPE:"type",TX_HASH:"0xf8de3bb47d055cdf460d93a2a6e1b05f7432f9777c8c474abf4eec1d4aee5d37",INDEX:"0x0",DEP_TYPE:"dep_group",SHORT_ID:0},SECP256K1_BLAKE160_MULTISIG:{CODE_HASH:"0x5c5069eb0857efc65e1bca0c07df34c31663b3622fd3876c876320fc9634e2a8",HASH_TYPE:"type",TX_HASH:"0xf8de3bb47d055cdf460d93a2a6e1b05f7432f9777c8c474abf4eec1d4aee5d37",INDEX:"0x1",DEP_TYPE:"dep_group",SHORT_ID:1},DAO:{CODE_HASH:"0x82d76d1b75fe2fd9a27dfbaa65a039221a380d76c926f378d3f81cf3e7e13f2e",HASH_TYPE:"type",TX_HASH:"0x8f8c79eb6671709633fe6a46de93c0fedc9c1b8a6527a18d3983879542635c9f",INDEX:"0x2",DEP_TYPE:"code"},SUDT:{CODE_HASH:"0xc5e5dcf215925f7ef4dfaf5f4b4f105bc321c02776d6e7d52a1db3fcd9d011a4",HASH_TYPE:"type",TX_HASH:"0xe12877ebd2c3c364dc46c5c992bcfaf4fee33fa13eebdf82c591fc9825aab769",INDEX:"0x0",DEP_TYPE:"code"},ANYONE_CAN_PAY:{CODE_HASH:"0x3419a1c09eb2567f6552ee7a8ecffd64155cffe0f1796e6e61ec088d740c1356",HASH_TYPE:"type",TX_HASH:"0xec26b0f85ed839ece5f11c4c4e837ec359f5adc4420410f6453b1f6b60fb96a6",INDEX:"0x0",DEP_TYPE:"dep_group",SHORT_ID:2}}})};t.predefined=o},5461:function(){},6632:function(e,t,r){"use strict";var n=r(8834).Buffer,i=r(7111).default;Object.defineProperty(t,"__esModule",{value:!0}),t.ExtendedPublicKey=t.ExtendedPrivateKey=t.AddressType=t.AccountExtendedPublicKey=void 0;var a,o,s=(a=r(6414))&&a.__esModule?a:{default:a},u=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=p(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(9273)),c=r(7143),l=r(2526);function p(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(p=function(e){return e?r:t})(e)}t.AddressType=o,function(e){e[e.Receiving=0]="Receiving",e[e.Change=1]="Change"}(o||(t.AddressType=o={}));var d=function(){function e(e,t){(0,l.assertPublicKey)(e),(0,l.assertChainCode)(t),this.publicKey=e,this.chainCode=t}return e.prototype.serialize=function(){return this.publicKey+this.chainCode.slice(2)},e.parse=function(t){return c.utils.assertHexString("serialized",t),new e(t.slice(0,68),"0x"+t.slice(68))},e}();t.ExtendedPublicKey=d;var f=function(e){function t(){return e.apply(this,arguments)||this}i(t,e),t.parse=function(e){return c.utils.assertHexString("serialized",e),new t(e.slice(0,68),"0x"+e.slice(68))};var r=t.prototype;return r.publicKeyInfo=function(e,r){var n=this.getPublicKey(e,r);return{publicKey:n,blake160:u.default.publicKeyToBlake160(n),path:t.pathFor(e,r)}},t.pathForReceiving=function(e){return t.pathFor(o.Receiving,e)},t.pathForChange=function(e){return t.pathFor(o.Change,e)},t.pathFor=function(e,r){return t.ckbAccountPath+"/"+e+"/"+r},r.getPublicKey=function(e,r){return void 0===e&&(e=o.Receiving),"0x"+s.default.fromPublicKey(n.from(this.publicKey.slice(2),"hex"),n.from(this.chainCode.slice(2),"hex"),t.ckbAccountPath).deriveChild(e,!1).deriveChild(r,!1).publicKey.toString("hex")},t}(d);t.AccountExtendedPublicKey=f,function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(f,"ckbAccountPath","m/44'/309'/0'");var h=function(){function e(e,t){(0,l.assertPrivateKey)(e),(0,l.assertChainCode)(t),this.privateKey=e,this.chainCode=t}var t=e.prototype;return t.serialize=function(){return this.privateKey+this.chainCode.slice(2)},t.toExtendedPublicKey=function(){var e=(0,u.privateToPublic)(this.privateKey);return new d(e,this.chainCode)},t.toAccountExtendedPublicKey=function(){var e=new s.default(n.from(this.privateKey.slice(2),"hex"),n.from(this.chainCode.slice(2),"hex")).derivePath(f.ckbAccountPath);return new f("0x"+e.publicKey.toString("hex"),"0x"+e.chainCode.toString("hex"))},e.fromSeed=function(t){var r=s.default.fromSeed(t);return new e("0x"+r.privateKey.toString("hex"),"0x"+r.chainCode.toString("hex"))},t.privateKeyInfo=function(e,t){var r=f.pathFor(e,t);return this.privateKeyInfoByPath(r)},t.privateKeyInfoByPath=function(e){var t=new s.default(n.from(this.privateKey.slice(2),"hex"),n.from(this.chainCode.slice(2),"hex")).derivePath(e);return this.privateKeyInfoFromKeychain(t,e)},t.privateKeyInfoFromKeychain=function(e,t){return{privateKey:"0x"+e.privateKey.toString("hex"),publicKey:"0x"+e.publicKey.toString("hex"),path:t}},e.parse=function(t){return c.utils.assertHexString("serialized",t),new e(t.slice(0,66),"0x"+t.slice(66))},e}();t.ExtendedPrivateKey=h},2526:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertChainCode=function(e){if(n("chainCode",e),66!==e.length)throw new Error("chainCode must be length of 32 bytes!")},t.assertPrivateKey=function(e){if(n("privateKey",e),66!==e.length)throw new Error("privateKey must be length of 32 bytes!")},t.assertPublicKey=function(e,t){if(n(t=t||"publicKey",e),68!==e.length)throw new Error("publicKey must be length of 33 bytes!")};var n=r(7143).utils.assertHexString},8901:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"AccountExtendedPublicKey",{enumerable:!0,get:function(){return o.AccountExtendedPublicKey}}),Object.defineProperty(t,"AddressType",{enumerable:!0,get:function(){return o.AddressType}}),Object.defineProperty(t,"ExtendedPrivateKey",{enumerable:!0,get:function(){return o.ExtendedPrivateKey}}),Object.defineProperty(t,"ExtendedPublicKey",{enumerable:!0,get:function(){return o.ExtendedPublicKey}}),Object.defineProperty(t,"HexStringWithoutPrefix",{enumerable:!0,get:function(){return n.HexStringWithoutPrefix}}),Object.defineProperty(t,"IncorrectPassword",{enumerable:!0,get:function(){return n.IncorrectPassword}}),Object.defineProperty(t,"InvalidKeystore",{enumerable:!0,get:function(){return n.InvalidKeystore}}),Object.defineProperty(t,"Keychain",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"Keystore",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"PrivateKeyInfo",{enumerable:!0,get:function(){return o.PrivateKeyInfo}}),Object.defineProperty(t,"PublicKeyInfo",{enumerable:!0,get:function(){return o.PublicKeyInfo}}),Object.defineProperty(t,"UnsupportedCipher",{enumerable:!0,get:function(){return n.UnsupportedCipher}}),Object.defineProperty(t,"XPubStore",{enumerable:!0,get:function(){return i.XPubStore}}),t.default=void 0,Object.defineProperty(t,"key",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"mnemonic",{enumerable:!0,get:function(){return s.default}});var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=l(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(r(1262)),i=r(1185),a=c(r(6414)),o=r(6632),s=c(r(6358)),u=c(r(9273));function c(e){return e&&e.__esModule?e:{default:e}}function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(l=function(e){return e?r:t})(e)}var p={mnemonic:s.default,Keystore:n.default,UnsupportedCipher:n.UnsupportedCipher,IncorrectPassword:n.IncorrectPassword,InvalidKeystore:n.InvalidKeystore,Keychain:a.default,AddressType:o.AddressType,ExtendedPublicKey:o.ExtendedPublicKey,AccountExtendedPublicKey:o.AccountExtendedPublicKey,ExtendedPrivateKey:o.ExtendedPrivateKey,key:u.default,XPubStore:i.XPubStore};t.default=p},9273:function(e,t,r){"use strict";var n=r(8834).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.privateKeyToBlake160=d,t.privateToPublic=l,t.publicKeyToBlake160=p,t.recoverFromSignature=c,t.signRecoverable=u;var i=r(7143),a=r(7554),o=r(2526),s=new a.ec("secp256k1");function u(e,t){i.utils.assertHexString("message",e),(0,o.assertPrivateKey)(t);var r=s.keyFromPrivate(t.slice(2)).sign(e.slice(2),{canonical:!0}),n=r.r,a=r.s,u=r.recoveryParam;if(null===u)throw new Error("Sign message failed!");return"0x"+n.toString(16).padStart(64,"0")+a.toString(16).padStart(64,"0")+u.toString(16).padStart(2,"0")}function c(e,t){i.utils.assertHexString("message",e),i.utils.assertHexString("signature",t);var r=n.from(e.slice(2),"hex"),a=n.from(t.slice(2),"hex"),o={r:a.slice(0,32),s:a.slice(32,64),recoveryParam:a[64]};return"0x"+s.recoverPubKey(r,o,o.recoveryParam).encode("hex",!0).toLowerCase()}function l(e){var t=e;if("string"==typeof e&&((0,o.assertPrivateKey)(e),t=n.from(e.slice(2),"hex")),32!==t.length)throw new Error("Private key must be 32 bytes!");var r=s.keyFromPrivate(t).getPublic(!0,"hex");return"string"==typeof e?"0x"+r:n.from(r,"hex")}function p(e){return(0,o.assertPublicKey)(e),(new i.utils.CKBHasher).update(e).digestHex().slice(0,42)}function d(e){return p(l(e))}var f={signRecoverable:u,recoverFromSignature:c,privateToPublic:l,publicKeyToBlake160:p,privateKeyToBlake160:d};t.default=f},6414:function(e,t,r){"use strict";var n=r(8834).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=u(r(9261)),a=r(7554),o=u(r(8077)),s=r(9273);function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var l=new a.ec("secp256k1"),p=n.from(""),d=function(){function e(e,t){c(this,"privateKey",p),c(this,"publicKey",p),c(this,"chainCode",p),c(this,"index",0),c(this,"depth",0),c(this,"identifier",p),c(this,"fingerprint",0),c(this,"parentFingerprint",0),this.privateKey=e,this.chainCode=t,this.isNeutered()||(this.publicKey=(0,s.privateToPublic)(this.privateKey))}var t=e.prototype;return t.calculateFingerprint=function(){this.identifier=this.hash160(this.publicKey),this.fingerprint=this.identifier.slice(0,4).readUInt32BE(0)},e.fromSeed=function(t){var r=i.default.createHmac("sha512",n.from("Bitcoin seed","utf8")).update(t).digest(),a=new e(r.slice(0,32),r.slice(32));return a.calculateFingerprint(),a},e.fromPublicKey=function(t,r,n){var i=new e(p,r);i.publicKey=t,i.calculateFingerprint();var a=n.split("/");return i.depth=a.length-1,i.index=parseInt(a[a.length-1],10),i},t.deriveChild=function(t,r){var a,o=n.allocUnsafe(4);if(r){var s=n.concat([n.alloc(1,0),this.privateKey]);o.writeUInt32BE(t+2147483648,0),a=n.concat([s,o])}else o.writeUInt32BE(t,0),a=n.concat([this.publicKey,o]);var u,c=i.default.createHmac("sha512",this.chainCode).update(a).digest(),l=c.slice(0,32),d=c.slice(32);if(this.isNeutered())(u=new e(p,d)).publicKey=e.publicKeyAdd(this.publicKey,l),u.calculateFingerprint();else{var f=e.privateKeyAdd(this.privateKey,l);(u=new e(f,d)).calculateFingerprint()}return u.index=t,u.depth=this.depth+1,u.parentFingerprint=this.fingerprint,u},t.derivePath=function(e){if(["m","/",""].includes(e))return this;var t=this,r=e.split("/");return"m"===r[0]&&(r=r.slice(1)),r.forEach((function(e){var r=parseInt(e,10),n=e.length>1&&"'"===e[e.length-1];t=t.deriveChild(r,n)})),t},t.isNeutered=function(){return this.privateKey===p},t.hash160=function(e){var t=i.default.createHash("sha256").update(e).digest();return i.default.createHash("ripemd160").update(t).digest()},e.privateKeyAdd=function(e,t){var r=new o.default(t);return r.iadd(new o.default(e)),r.cmp(l.curve.n)>=0&&r.isub(l.curve.n),r.toArrayLike(n,"be",32)},e.publicKeyAdd=function(e,t){var r=new o.default(e.slice(1)).toRed(l.curve.red),i=r.redSqr().redIMul(r).redIAdd(l.curve.b).redSqrt();3===e[0]!==i.isOdd()&&(i=i.redNeg());var a=l.curve.g.mul(new o.default(t)).add({x:r,y:i});return n.from(a.encode(!0,!0))},e}();t.default=d},1262:function(e,t,r){"use strict";var n=r(8834).Buffer,i=r(7111).default,a=r(8240).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.UnsupportedCipher=t.InvalidKeystore=t.IncorrectPassword=void 0;var o=d(r(9261)),s=r(8679),u=r(4302),c=d(r(2244)),l=d(r(2165)),p=r(6632);function d(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(){return e.call(this,"Unsupported cipher!")||this}return i(t,e),t}(a(Error));t.UnsupportedCipher=f;var h=function(e){function t(){return e.call(this,"Incorrect password!")||this}return i(t,e),t}(a(Error));t.IncorrectPassword=h;var v=function(e){function t(){return e.call(this,"Invalid keystore, please check your file integrity.")||this}return i(t,e),t}(a(Error));t.InvalidKeystore=v;var g="aes-128-ctr",b=function(){function e(e,t,r){var n,i,a;a=3,(i="version")in(n=this)?Object.defineProperty(n,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[i]=a,this.crypto=e,this.id=t,this.origin=r}e.fromJson=function(t){try{var r=JSON.parse(t);return new e(r.crypto,r.id,r.origin)}catch(n){throw new v}},e.load=function(e){var t=c.default.readFileSync(e,"utf-8");return this.fromJson(t)};var t=e.prototype;return t.save=function(e,t){var r=void 0===t?{}:t,n=r.name,i=void 0===n?this.filename():n,a=r.overwrite,o=void 0!==a&&a,s=l.default.join(e,i);if(!o&&c.default.existsSync(s))throw new Error("Keystore file already exists!");c.default.writeFileSync(s,this.toJson())},t.filename=function(){return this.id+".json"},t.toJson=function(){return JSON.stringify(this)},t.isFromCkbCli=function(){return"ckb-cli"===this.origin},e.createEmpty=function(){var t=o.default.randomBytes(32),r=o.default.randomBytes(16),n={dklen:32,salt:t.toString("hex"),n:Math.pow(2,18),r:8,p:1};return new e({ciphertext:"",cipherparams:{iv:r.toString("hex")},cipher:g,kdf:"scrypt",kdfparams:n,mac:""},(0,u.v4)())},e.create=function(t,r,i){void 0===i&&(i={});var a=i.salt||o.default.randomBytes(32),s=i.iv||o.default.randomBytes(16),c={dklen:32,salt:a.toString("hex"),n:Math.pow(2,18),r:8,p:1},l=o.default.scryptSync(r,a,c.dklen,e.scryptOptions(c)),p=o.default.createCipheriv(g,l.slice(0,16),s);if(!p)throw new f;var d=n.concat([p.update(n.from(t.serialize().slice(2),"hex")),p.final()]);return new e({ciphertext:d.toString("hex"),cipherparams:{iv:s.toString("hex")},cipher:g,kdf:"scrypt",kdfparams:c,mac:e.mac(l,d)},(0,u.v4)())},t.isEmpty=function(){return""===this.crypto.ciphertext&&""===this.crypto.mac},t.decrypt=function(t){var r=this.derivedKey(t),i=n.from(this.crypto.ciphertext,"hex");if(e.mac(r,i)!==this.crypto.mac)throw new h;var a=o.default.createDecipheriv(this.crypto.cipher,r.slice(0,16),n.from(this.crypto.cipherparams.iv,"hex"));return"0x"+n.concat([a.update(i),a.final()]).toString("hex")},t.extendedPrivateKey=function(e){return p.ExtendedPrivateKey.parse(this.decrypt(e))},t.checkPassword=function(t){var r=this.derivedKey(t),i=n.from(this.crypto.ciphertext,"hex");return e.mac(r,i)===this.crypto.mac},t.derivedKey=function(t){var r=this.crypto.kdfparams;return o.default.scryptSync(t,n.from(r.salt,"hex"),r.dklen,e.scryptOptions(r))},e.mac=function(e,t){return new s.Keccak(256).update(n.concat([e.slice(16,32),t])).digest("hex")},e.scryptOptions=function(e){return{N:e.n,r:e.r,p:e.p,maxmem:128*(e.n+e.p+2)*e.r}},e}();t.default=b},6358:function(e,t,r){"use strict";var n=r(8834).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.entropyToMnemonic=b,t.generateMnemonic=w,t.mnemonicToEntropy=g,t.mnemonicToSeed=v,t.mnemonicToSeedSync=h,t.validateMnemonic=y;var i=o(r(9088)),a=o(r(8587));function o(e){return e&&e.__esModule?e:{default:e}}var s="Invalid mnemonic",u="Entropy should be divisable by 4",c="Entropy should be shorter than 33",l="Entropy should be longer than 15";if(2048!==a.default.length)throw new Error("Word list should have 2048 words, but "+a.default.length+" received in fact");function p(e){return e.reduce((function(e,t){return e+t.toString(2).padStart(8,"0")}),"")}function d(e){var t=8*e.length/32;return p(i.default.createHash("sha256").update(e).digest()).slice(0,t)}function f(e){return void 0===e&&(e=""),"mnemonic"+e}function h(e,t){void 0===e&&(e=""),void 0===t&&(t="");var r=n.from(e.normalize("NFKD"),"utf8"),a=n.from(f(t.normalize("NFKD")),"utf8");return i.default.pbkdf2Sync(r,a,2048,64,"sha512")}function v(e,t){return void 0===e&&(e=""),void 0===t&&(t=""),new Promise((function(r,a){try{var o=n.from(e.normalize("NFKD"),"utf8"),s=n.from(f(t.normalize("NFKD")),"utf8");i.default.pbkdf2(o,s,2048,64,"sha512",(function(e,t){e&&a(e),r(t)}))}catch(u){a(u)}}))}function g(e){void 0===e&&(e="");var t=e.normalize("NFKD").split(" ");if(t.length<12)throw new Error("Words should be longer than 11");if(t.length>24)throw new Error("Words should be shorter than 25");if(t.length%3!=0)throw new Error(s);var r=t.map((function(e){var t=a.default.indexOf(e);if(-1===t)throw new Error(s);return t.toString(2).padStart(11,"0")})).join(""),i=32*Math.floor(r.length/33),o=r.slice(0,i),p=r.slice(i),f=o.match(/(.{1,8})/g).map((function(e){return parseInt(e,2)}));if(f.length<16)throw new Error(l);if(f.length>32)throw new Error(c);if(f.length%4!=0)throw new Error(u);var h=n.from(f);if(d(h)!==p)throw new Error("Invalid checksum");return"0x"+h.toString("hex")}function b(e){var t=n.from(e.slice(2),"hex");if(t.length<16)throw new TypeError(l);if(t.length>32)throw new TypeError(c);if(t.length%4!=0)throw new TypeError(u);return(p(t)+d(t)).match(/(.{1,11})/g).map((function(e){var t=parseInt(e,2);return a.default[t]})).join(" ")}function y(e){try{g(e)}catch(t){return!1}return!0}function w(){return b("0x"+i.default.randomBytes(16).toString("hex"))}var m={entropyToMnemonic:b,mnemonicToEntropy:g,mnemonicToSeed:v,mnemonicToSeedSync:h,validateMnemonic:y,generateMnemonic:w};t.default=m},8587:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=["abandon","ability","able","about","above","absent","absorb","abstract","absurd","abuse","access","accident","account","accuse","achieve","acid","acoustic","acquire","across","act","action","actor","actress","actual","adapt","add","addict","address","adjust","admit","adult","advance","advice","aerobic","affair","afford","afraid","again","age","agent","agree","ahead","aim","air","airport","aisle","alarm","album","alcohol","alert","alien","all","alley","allow","almost","alone","alpha","already","also","alter","always","amateur","amazing","among","amount","amused","analyst","anchor","ancient","anger","angle","angry","animal","ankle","announce","annual","another","answer","antenna","antique","anxiety","any","apart","apology","appear","apple","approve","april","arch","arctic","area","arena","argue","arm","armed","armor","army","around","arrange","arrest","arrive","arrow","art","artefact","artist","artwork","ask","aspect","assault","asset","assist","assume","asthma","athlete","atom","attack","attend","attitude","attract","auction","audit","august","aunt","author","auto","autumn","average","avocado","avoid","awake","aware","away","awesome","awful","awkward","axis","baby","bachelor","bacon","badge","bag","balance","balcony","ball","bamboo","banana","banner","bar","barely","bargain","barrel","base","basic","basket","battle","beach","bean","beauty","because","become","beef","before","begin","behave","behind","believe","below","belt","bench","benefit","best","betray","better","between","beyond","bicycle","bid","bike","bind","biology","bird","birth","bitter","black","blade","blame","blanket","blast","bleak","bless","blind","blood","blossom","blouse","blue","blur","blush","board","boat","body","boil","bomb","bone","bonus","book","boost","border","boring","borrow","boss","bottom","bounce","box","boy","bracket","brain","brand","brass","brave","bread","breeze","brick","bridge","brief","bright","bring","brisk","broccoli","broken","bronze","broom","brother","brown","brush","bubble","buddy","budget","buffalo","build","bulb","bulk","bullet","bundle","bunker","burden","burger","burst","bus","business","busy","butter","buyer","buzz","cabbage","cabin","cable","cactus","cage","cake","call","calm","camera","camp","can","canal","cancel","candy","cannon","canoe","canvas","canyon","capable","capital","captain","car","carbon","card","cargo","carpet","carry","cart","case","cash","casino","castle","casual","cat","catalog","catch","category","cattle","caught","cause","caution","cave","ceiling","celery","cement","census","century","cereal","certain","chair","chalk","champion","change","chaos","chapter","charge","chase","chat","cheap","check","cheese","chef","cherry","chest","chicken","chief","child","chimney","choice","choose","chronic","chuckle","chunk","churn","cigar","cinnamon","circle","citizen","city","civil","claim","clap","clarify","claw","clay","clean","clerk","clever","click","client","cliff","climb","clinic","clip","clock","clog","close","cloth","cloud","clown","club","clump","cluster","clutch","coach","coast","coconut","code","coffee","coil","coin","collect","color","column","combine","come","comfort","comic","common","company","concert","conduct","confirm","congress","connect","consider","control","convince","cook","cool","copper","copy","coral","core","corn","correct","cost","cotton","couch","country","couple","course","cousin","cover","coyote","crack","cradle","craft","cram","crane","crash","crater","crawl","crazy","cream","credit","creek","crew","cricket","crime","crisp","critic","crop","cross","crouch","crowd","crucial","cruel","cruise","crumble","crunch","crush","cry","crystal","cube","culture","cup","cupboard","curious","current","curtain","curve","cushion","custom","cute","cycle","dad","damage","damp","dance","danger","daring","dash","daughter","dawn","day","deal","debate","debris","decade","december","decide","decline","decorate","decrease","deer","defense","define","defy","degree","delay","deliver","demand","demise","denial","dentist","deny","depart","depend","deposit","depth","deputy","derive","describe","desert","design","desk","despair","destroy","detail","detect","develop","device","devote","diagram","dial","diamond","diary","dice","diesel","diet","differ","digital","dignity","dilemma","dinner","dinosaur","direct","dirt","disagree","discover","disease","dish","dismiss","disorder","display","distance","divert","divide","divorce","dizzy","doctor","document","dog","doll","dolphin","domain","donate","donkey","donor","door","dose","double","dove","draft","dragon","drama","drastic","draw","dream","dress","drift","drill","drink","drip","drive","drop","drum","dry","duck","dumb","dune","during","dust","dutch","duty","dwarf","dynamic","eager","eagle","early","earn","earth","easily","east","easy","echo","ecology","economy","edge","edit","educate","effort","egg","eight","either","elbow","elder","electric","elegant","element","elephant","elevator","elite","else","embark","embody","embrace","emerge","emotion","employ","empower","empty","enable","enact","end","endless","endorse","enemy","energy","enforce","engage","engine","enhance","enjoy","enlist","enough","enrich","enroll","ensure","enter","entire","entry","envelope","episode","equal","equip","era","erase","erode","erosion","error","erupt","escape","essay","essence","estate","eternal","ethics","evidence","evil","evoke","evolve","exact","example","excess","exchange","excite","exclude","excuse","execute","exercise","exhaust","exhibit","exile","exist","exit","exotic","expand","expect","expire","explain","expose","express","extend","extra","eye","eyebrow","fabric","face","faculty","fade","faint","faith","fall","false","fame","family","famous","fan","fancy","fantasy","farm","fashion","fat","fatal","father","fatigue","fault","favorite","feature","february","federal","fee","feed","feel","female","fence","festival","fetch","fever","few","fiber","fiction","field","figure","file","film","filter","final","find","fine","finger","finish","fire","firm","first","fiscal","fish","fit","fitness","fix","flag","flame","flash","flat","flavor","flee","flight","flip","float","flock","floor","flower","fluid","flush","fly","foam","focus","fog","foil","fold","follow","food","foot","force","forest","forget","fork","fortune","forum","forward","fossil","foster","found","fox","fragile","frame","frequent","fresh","friend","fringe","frog","front","frost","frown","frozen","fruit","fuel","fun","funny","furnace","fury","future","gadget","gain","galaxy","gallery","game","gap","garage","garbage","garden","garlic","garment","gas","gasp","gate","gather","gauge","gaze","general","genius","genre","gentle","genuine","gesture","ghost","giant","gift","giggle","ginger","giraffe","girl","give","glad","glance","glare","glass","glide","glimpse","globe","gloom","glory","glove","glow","glue","goat","goddess","gold","good","goose","gorilla","gospel","gossip","govern","gown","grab","grace","grain","grant","grape","grass","gravity","great","green","grid","grief","grit","grocery","group","grow","grunt","guard","guess","guide","guilt","guitar","gun","gym","habit","hair","half","hammer","hamster","hand","happy","harbor","hard","harsh","harvest","hat","have","hawk","hazard","head","health","heart","heavy","hedgehog","height","hello","helmet","help","hen","hero","hidden","high","hill","hint","hip","hire","history","hobby","hockey","hold","hole","holiday","hollow","home","honey","hood","hope","horn","horror","horse","hospital","host","hotel","hour","hover","hub","huge","human","humble","humor","hundred","hungry","hunt","hurdle","hurry","hurt","husband","hybrid","ice","icon","idea","identify","idle","ignore","ill","illegal","illness","image","imitate","immense","immune","impact","impose","improve","impulse","inch","include","income","increase","index","indicate","indoor","industry","infant","inflict","inform","inhale","inherit","initial","inject","injury","inmate","inner","innocent","input","inquiry","insane","insect","inside","inspire","install","intact","interest","into","invest","invite","involve","iron","island","isolate","issue","item","ivory","jacket","jaguar","jar","jazz","jealous","jeans","jelly","jewel","job","join","joke","journey","joy","judge","juice","jump","jungle","junior","junk","just","kangaroo","keen","keep","ketchup","key","kick","kid","kidney","kind","kingdom","kiss","kit","kitchen","kite","kitten","kiwi","knee","knife","knock","know","lab","label","labor","ladder","lady","lake","lamp","language","laptop","large","later","latin","laugh","laundry","lava","law","lawn","lawsuit","layer","lazy","leader","leaf","learn","leave","lecture","left","leg","legal","legend","leisure","lemon","lend","length","lens","leopard","lesson","letter","level","liar","liberty","library","license","life","lift","light","like","limb","limit","link","lion","liquid","list","little","live","lizard","load","loan","lobster","local","lock","logic","lonely","long","loop","lottery","loud","lounge","love","loyal","lucky","luggage","lumber","lunar","lunch","luxury","lyrics","machine","mad","magic","magnet","maid","mail","main","major","make","mammal","man","manage","mandate","mango","mansion","manual","maple","marble","march","margin","marine","market","marriage","mask","mass","master","match","material","math","matrix","matter","maximum","maze","meadow","mean","measure","meat","mechanic","medal","media","melody","melt","member","memory","mention","menu","mercy","merge","merit","merry","mesh","message","metal","method","middle","midnight","milk","million","mimic","mind","minimum","minor","minute","miracle","mirror","misery","miss","mistake","mix","mixed","mixture","mobile","model","modify","mom","moment","monitor","monkey","monster","month","moon","moral","more","morning","mosquito","mother","motion","motor","mountain","mouse","move","movie","much","muffin","mule","multiply","muscle","museum","mushroom","music","must","mutual","myself","mystery","myth","naive","name","napkin","narrow","nasty","nation","nature","near","neck","need","negative","neglect","neither","nephew","nerve","nest","net","network","neutral","never","news","next","nice","night","noble","noise","nominee","noodle","normal","north","nose","notable","note","nothing","notice","novel","now","nuclear","number","nurse","nut","oak","obey","object","oblige","obscure","observe","obtain","obvious","occur","ocean","october","odor","off","offer","office","often","oil","okay","old","olive","olympic","omit","once","one","onion","online","only","open","opera","opinion","oppose","option","orange","orbit","orchard","order","ordinary","organ","orient","original","orphan","ostrich","other","outdoor","outer","output","outside","oval","oven","over","own","owner","oxygen","oyster","ozone","pact","paddle","page","pair","palace","palm","panda","panel","panic","panther","paper","parade","parent","park","parrot","party","pass","patch","path","patient","patrol","pattern","pause","pave","payment","peace","peanut","pear","peasant","pelican","pen","penalty","pencil","people","pepper","perfect","permit","person","pet","phone","photo","phrase","physical","piano","picnic","picture","piece","pig","pigeon","pill","pilot","pink","pioneer","pipe","pistol","pitch","pizza","place","planet","plastic","plate","play","please","pledge","pluck","plug","plunge","poem","poet","point","polar","pole","police","pond","pony","pool","popular","portion","position","possible","post","potato","pottery","poverty","powder","power","practice","praise","predict","prefer","prepare","present","pretty","prevent","price","pride","primary","print","priority","prison","private","prize","problem","process","produce","profit","program","project","promote","proof","property","prosper","protect","proud","provide","public","pudding","pull","pulp","pulse","pumpkin","punch","pupil","puppy","purchase","purity","purpose","purse","push","put","puzzle","pyramid","quality","quantum","quarter","question","quick","quit","quiz","quote","rabbit","raccoon","race","rack","radar","radio","rail","rain","raise","rally","ramp","ranch","random","range","rapid","rare","rate","rather","raven","raw","razor","ready","real","reason","rebel","rebuild","recall","receive","recipe","record","recycle","reduce","reflect","reform","refuse","region","regret","regular","reject","relax","release","relief","rely","remain","remember","remind","remove","render","renew","rent","reopen","repair","repeat","replace","report","require","rescue","resemble","resist","resource","response","result","retire","retreat","return","reunion","reveal","review","reward","rhythm","rib","ribbon","rice","rich","ride","ridge","rifle","right","rigid","ring","riot","ripple","risk","ritual","rival","river","road","roast","robot","robust","rocket","romance","roof","rookie","room","rose","rotate","rough","round","route","royal","rubber","rude","rug","rule","run","runway","rural","sad","saddle","sadness","safe","sail","salad","salmon","salon","salt","salute","same","sample","sand","satisfy","satoshi","sauce","sausage","save","say","scale","scan","scare","scatter","scene","scheme","school","science","scissors","scorpion","scout","scrap","screen","script","scrub","sea","search","season","seat","second","secret","section","security","seed","seek","segment","select","sell","seminar","senior","sense","sentence","series","service","session","settle","setup","seven","shadow","shaft","shallow","share","shed","shell","sheriff","shield","shift","shine","ship","shiver","shock","shoe","shoot","shop","short","shoulder","shove","shrimp","shrug","shuffle","shy","sibling","sick","side","siege","sight","sign","silent","silk","silly","silver","similar","simple","since","sing","siren","sister","situate","six","size","skate","sketch","ski","skill","skin","skirt","skull","slab","slam","sleep","slender","slice","slide","slight","slim","slogan","slot","slow","slush","small","smart","smile","smoke","smooth","snack","snake","snap","sniff","snow","soap","soccer","social","sock","soda","soft","solar","soldier","solid","solution","solve","someone","song","soon","sorry","sort","soul","sound","soup","source","south","space","spare","spatial","spawn","speak","special","speed","spell","spend","sphere","spice","spider","spike","spin","spirit","split","spoil","sponsor","spoon","sport","spot","spray","spread","spring","spy","square","squeeze","squirrel","stable","stadium","staff","stage","stairs","stamp","stand","start","state","stay","steak","steel","stem","step","stereo","stick","still","sting","stock","stomach","stone","stool","story","stove","strategy","street","strike","strong","struggle","student","stuff","stumble","style","subject","submit","subway","success","such","sudden","suffer","sugar","suggest","suit","summer","sun","sunny","sunset","super","supply","supreme","sure","surface","surge","surprise","surround","survey","suspect","sustain","swallow","swamp","swap","swarm","swear","sweet","swift","swim","swing","switch","sword","symbol","symptom","syrup","system","table","tackle","tag","tail","talent","talk","tank","tape","target","task","taste","tattoo","taxi","teach","team","tell","ten","tenant","tennis","tent","term","test","text","thank","that","theme","then","theory","there","they","thing","this","thought","three","thrive","throw","thumb","thunder","ticket","tide","tiger","tilt","timber","time","tiny","tip","tired","tissue","title","toast","tobacco","today","toddler","toe","together","toilet","token","tomato","tomorrow","tone","tongue","tonight","tool","tooth","top","topic","topple","torch","tornado","tortoise","toss","total","tourist","toward","tower","town","toy","track","trade","traffic","tragic","train","transfer","trap","trash","travel","tray","treat","tree","trend","trial","tribe","trick","trigger","trim","trip","trophy","trouble","truck","true","truly","trumpet","trust","truth","try","tube","tuition","tumble","tuna","tunnel","turkey","turn","turtle","twelve","twenty","twice","twin","twist","two","type","typical","ugly","umbrella","unable","unaware","uncle","uncover","under","undo","unfair","unfold","unhappy","uniform","unique","unit","universe","unknown","unlock","until","unusual","unveil","update","upgrade","uphold","upon","upper","upset","urban","urge","usage","use","used","useful","useless","usual","utility","vacant","vacuum","vague","valid","valley","valve","van","vanish","vapor","various","vast","vault","vehicle","velvet","vendor","venture","venue","verb","verify","version","very","vessel","veteran","viable","vibrant","vicious","victory","video","view","village","vintage","violin","virtual","virus","visa","visit","visual","vital","vivid","vocal","voice","void","volcano","volume","vote","voyage","wage","wagon","wait","walk","wall","walnut","want","warfare","warm","warrior","wash","wasp","waste","water","wave","way","wealth","weapon","wear","weasel","weather","web","wedding","weekend","weird","welcome","west","wet","whale","what","wheat","wheel","when","where","whip","whisper","wide","width","wife","wild","will","win","window","wine","wing","wink","winner","winter","wire","wisdom","wise","wish","witness","wolf","woman","wonder","wood","wool","word","work","world","worry","worth","wrap","wreck","wrestle","wrist","write","wrong","yard","year","yellow","you","young","youth","zebra","zero","zone","zoo"]},1185:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XPubStore=void 0;var n,i=r(6632),a=(n=r(2244))&&n.__esModule?n:{default:n};var o=function(){function e(e){this.accountExtendedPublicKey=e}var t=e.prototype;return t.toAccountExtendedPublicKey=function(){return this.accountExtendedPublicKey},t.save=function(e,t){var r=(void 0===t?{}:t).overwrite;if(!(void 0!==r&&r)&&a.default.existsSync(e))throw new Error("XPub file already exists!");a.default.writeFileSync(e,this.toJson())},t.toJson=function(){return JSON.stringify({xpubkey:this.accountExtendedPublicKey.serialize().slice(2)})},e.load=function(t){var r=a.default.readFileSync(t,"utf-8"),n=JSON.parse(r).xpubkey;return new e(i.AccountExtendedPublicKey.parse("0x"+n))},e}();t.XPubStore=o},9336:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addressToScript=t.TransactionSkeleton=void 0,t.createTransactionFromSkeleton=m,t.encodeToAddress=d,t.encodeToPredefinedAddress=v,t.encodeToSecp256k1Blake160Address=function(e,t){var r=(void 0===t?{}:t).config,n=void 0===r?void 0:r;return v(e,"SECP256K1_BLAKE160",{config:n})},t.encodeToSecp256k1Blake160MultisigAddress=function(e,t){var r=(void 0===t?{}:t).config,n=void 0===r?void 0:r;return v(e,"SECP256K1_BLAKE160_MULTISIG",{config:n})},t.generateAddress=p,t.generateSecp256k1Blake160Address=function(e,t){var r=(void 0===t?{}:t).config,n=void 0===r?void 0:r;return h(e,"SECP256K1_BLAKE160",{config:n})},t.generateSecp256k1Blake160MultisigAddress=function(e,t){var r=(void 0===t?{}:t).config,n=void 0===r?void 0:r;return h(e,"SECP256K1_BLAKE160_MULTISIG",{config:n})},t.locateCellDep=function(e,t){var r=(void 0===t?{}:t).config,n=void 0===r?void 0:r;n=n||(0,s.getConfig)();var i=Object.values(n.SCRIPTS).find((function(t){return t.CODE_HASH===e.code_hash&&t.HASH_TYPE===e.hash_type}));if(i)return{dep_type:i.DEP_TYPE,out_point:{tx_hash:i.TX_HASH,index:i.INDEX}};return null},t.minimalCellCapacity=function(e,t){var r=(void 0===t?{}:t).validate;(void 0===r||r)&&a.validators.ValidateCellOutput(e.cell_output);var n=8;n+=new a.Reader(e.cell_output.lock.code_hash).length(),n+=new a.Reader(e.cell_output.lock.args).length(),n+=1,e.cell_output.type&&(n+=new a.Reader(e.cell_output.type.code_hash).length(),n+=new a.Reader(e.cell_output.type.args).length(),n+=1);e.data&&(n+=new a.Reader(e.data).length());return BigInt(n)*BigInt(1e8)},t.objectToTransactionSkeleton=function(e){for(var t=(0,o.Map)(),r=0,n=Object.entries(e.inputSinces);r<n.length;r++){var i=n[r],a=i[0],s=i[1];t=t.set(+a,s)}return w({cellProvider:e.cellProvider,cellDeps:(0,o.List)(e.cellDeps),headerDeps:(0,o.List)(e.headerDeps),inputs:(0,o.List)(e.inputs),outputs:(0,o.List)(e.outputs),witnesses:(0,o.List)(e.witnesses),fixedEntries:(0,o.List)(e.fixedEntries),signingEntries:(0,o.List)(e.signingEntries),inputSinces:t})},t.parseAddress=b,t.scriptToAddress=void 0,t.sealTransaction=function(e,t){var r=m(e);if(t.length!==e.get("signingEntries").size)throw new Error("Requiring "+e.get("signingEntries").size+" sealing contents but provided "+t.length+"!");return e.get("signingEntries").forEach((function(e,i){if("witness_args_lock"!==e.type)throw new Error("Invalid signing entry type: "+e.type);var o=r.witnesses[e.index],s=new n.core.WitnessArgs(new a.Reader(o)),u={lock:t[i]},c=s.getInputType();c.hasValue()&&(u.input_type=new a.Reader(c.value().raw()).serializeJson());var l=s.getOutputType();l.hasValue()&&(u.output_type=new a.Reader(l.value().raw()).serializeJson()),a.validators.ValidateWitnessArgs(u),r.witnesses[e.index]=new a.Reader(n.core.SerializeWitnessArgs(a.normalizers.NormalizeWitnessArgs(u))).serializeJson()})),r},t.transactionSkeletonToObject=function(e){return e.toJS()};var n=r(7143),i=r(6534),a=r(1674),o=r(7623),s=r(3664),u=1023;function c(e){return"0x"+e.map((function(e){return("00"+e.toString(16)).slice(-2)})).join("")}function l(e){if(!/^(0x)?([0-9a-fA-F][0-9a-fA-F])*$/.test(e))throw new Error("Invalid hex string!");e.startsWith("0x")&&(e=e.slice(2));for(var t=[];e.length>=2;)t.push(parseInt(e.slice(0,2),16)),e=e.slice(2);return t}function p(e,t){var r=(void 0===t?{}:t).config,n=void 0===r?void 0:r;n=n||(0,s.getConfig)();var a=Object.values(n.SCRIPTS).find((function(t){return t.CODE_HASH===e.code_hash&&t.HASH_TYPE===e.hash_type})),o=[];if(a&&void 0!==a.SHORT_ID)o.push(1,a.SHORT_ID),o.push.apply(o,l(e.args));else{if(n.CKB2021){var c=function(){if("data"===e.hash_type)return 0;if("type"===e.hash_type)return 1;if("data1"===e.hash_type)return 2;throw new Error("unknown hash_type "+e.hash_type)}();return o.push(0),o.push.apply(o,l(e.code_hash)),o.push(c),o.push.apply(o,l(e.args)),i.bech32m.encode(n.PREFIX,i.bech32m.toWords(o),u)}o.push("type"===e.hash_type?4:2),o.push.apply(o,l(e.code_hash)),o.push.apply(o,l(e.args))}var p=i.bech32.toWords(o);return i.bech32.encode(n.PREFIX,p,u)}function d(e,t){var r=(void 0===t?{}:t).config,n=void 0===r?void 0:r;n=n||(0,s.getConfig)();var a=[],o=function(){if("data"===e.hash_type)return 0;if("type"===e.hash_type)return 1;if("data1"===e.hash_type)return 2;throw new Error("unknown hash_type "+e.hash_type)}();return a.push(0),a.push.apply(a,l(e.code_hash)),a.push(o),a.push.apply(a,l(e.args)),i.bech32m.encode(n.PREFIX,i.bech32m.toWords(a),u)}var f=p;function h(e,t,r){var n=(void 0===r?{}:r).config,i=void 0===n?void 0:n,a=(i=i||(0,s.getConfig)()).SCRIPTS[t];return p({code_hash:a.CODE_HASH,hash_type:a.HASH_TYPE,args:e},{config:i})}function v(e,t,r){var n=(void 0===r?{}:r).config,i=void 0===n?void 0:n,a=(i=i||(0,s.getConfig)()).SCRIPTS[t];return d({code_hash:a.CODE_HASH,hash_type:a.HASH_TYPE,args:e},{config:i})}function g(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(var i=0,a=r;i<a.length;i++){var o=a[i];try{return o()}catch(s){e=s}}throw e}function b(e,t){var r=(void 0===t?{}:t).config,n=void 0===r?void 0:r;n=n||(0,s.getConfig)();var a=g((function(){return i.bech32m.decode(e,u)}),(function(){return i.bech32.decode(e,u)})),o=a.prefix,l=a.words;if(o!==n.PREFIX)throw Error("Invalid prefix! Expected: "+n.PREFIX+", actual: "+o);var p=g((function(){return i.bech32m.fromWords(l)}),(function(){return i.bech32.fromWords(l)}));switch(p[0]){case 0:if(p.length<34)throw new Error("Invalid payload length!");var d=p.slice(33,34)[0];return{code_hash:c(p.slice(1,33)),hash_type:function(){if(0===d)return"data";if(1===d)return"type";if(2===d)return"data1";throw new Error("unknown hash_type "+d)}(),args:c(p.slice(34))};case 1:if(p.length<2)throw Error("Invalid payload length!");var f=Object.values(n.SCRIPTS).find((function(e){return e.SHORT_ID===p[1]}));if(!f)throw Error("Invalid code hash index: "+p[1]+"!");return{code_hash:f.CODE_HASH,hash_type:f.HASH_TYPE,args:c(p.slice(2))};case 2:if(p.length<33)throw Error("Invalid payload length!");return{code_hash:c(p.slice(1,33)),hash_type:"data",args:c(p.slice(33))};case 4:if(p.length<33)throw Error("Invalid payload length!");return{code_hash:c(p.slice(1,33)),hash_type:"type",args:c(p.slice(33))}}throw Error("Invalid payload format type: "+p[0])}t.scriptToAddress=f;var y=b;t.addressToScript=y;var w=(0,o.Record)({cellProvider:null,cellDeps:(0,o.List)(),headerDeps:(0,o.List)(),inputs:(0,o.List)(),outputs:(0,o.List)(),witnesses:(0,o.List)(),fixedEntries:(0,o.List)(),signingEntries:(0,o.List)(),inputSinces:(0,o.Map)()});function m(e,t){var r=(void 0===t?{}:t).validate,n=void 0===r||r,i={version:"0x0",cell_deps:e.get("cellDeps").toArray(),header_deps:e.get("headerDeps").toArray(),inputs:e.get("inputs").map((function(t,r){return{since:e.get("inputSinces").get(r,"0x0"),previous_output:t.out_point}})).toArray(),outputs:e.get("outputs").map((function(e){return e.cell_output})).toArray(),outputs_data:e.get("outputs").map((function(e){return e.data||"0x0"})).toArray(),witnesses:e.get("witnesses").toArray()};return n&&a.validators.ValidateTransaction(i),i}t.TransactionSkeleton=w},8042:function(e,t,r){"use strict";t.vc=void 0,t.BM=void 0;var n=r(1674),i=r(7143),a=p(r(3664));t.vc=a;var o=r(6493);p(r(8901));var s=r(8357),u=p(r(9336));t.BM=u,p(r(6862));var c=r(1996);function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(l=function(e){return e?r:t})(e)}function p(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=l(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}return n.default=e,r&&r.set(e,n),n}n.Reader,n.validators,n.normalizers,n.transformers},6493:function(e,t,r){"use strict";var n=r(7162),i=r(2954).default;Object.defineProperty(t,"__esModule",{value:!0}),t.RPC=void 0;var a=r(1674);function o(e){return void 0===e&&(e=0),new Promise((function(t){return setTimeout(t,e)}))}var s={get:function(e,t){return i(n.mark((function r(){var i,a,o=arguments;return n.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(i=e.rpc)[t].apply(i,o);case 2:if(a=r.sent,!e.indexer){r.next=6;break}return r.next=6,e.waitForBlockSync();case 6:return r.abrupt("return",a);case 7:case"end":return r.stop()}}),r)})))}},u=function(){function e(e,t,r){var n=void 0===r?{}:r,i=n.waitForSyncCheckIntervalSeconds,o=void 0===i?1:i,s=n.blockDifference,u=void 0===s?3:s,c=n.rpcOptions,l=void 0===c?{}:c;this.rpc=new a.RPC(e,l),this.indexer=t,this.waitForSyncCheckIntervalSeconds=o,this.blockDifference=u}var t=e.prototype;return t.resetIndexer=function(e){this.indexer=e},t.getProxy=function(){return new Proxy(this,s)},t.waitForBlockSync=function(){var e=i(n.mark((function e(){var t,r,i,a;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.indexer){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.rpc.get_tip_header();case 4:t=e.sent,r=BigInt(t.number);case 6:return e.next=9,this.indexer.tip();case 9:if(!(i=e.sent)){e.next=14;break}if(a=BigInt(i.block_number),!(r-a<=this.blockDifference)){e.next=14;break}return e.abrupt("break",18);case 14:return e.next=16,o(1e3*this.waitForSyncCheckIntervalSeconds);case 16:e.next=6;break;case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e}(),c=function(){function e(e,t,r){var n=void 0===r?{}:r,i=n.waitForSyncCheckIntervalSeconds,a=void 0===i?1:i,o=n.blockDifference,s=void 0===o?3:o,c=n.rpcOptions,l=void 0===c?{}:c;this.rpcProxy=new u(e,t,{waitForSyncCheckIntervalSeconds:a,blockDifference:s,rpcOptions:l}).getProxy()}var t=e.prototype;return t.resetIndexer=function(e){this.rpcProxy.resetIndexer(e)},t.get_block=function(){var e=i(n.mark((function e(t,r){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpcProxy.get_block(t,r||null));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),t.get_block_by_number=function(){var e=i(n.mark((function e(t,r){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpcProxy.get_block_by_number(t,r||null));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),t.get_header=function(){var e=i(n.mark((function e(t,r){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpcProxy.get_header(t,r||null));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),t.get_header_by_number=function(){var e=i(n.mark((function e(t,r){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpcProxy.get_header_by_number(t,r||null));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),t.get_transaction=function(){var e=i(n.mark((function e(t){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpcProxy.get_transaction(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.get_block_hash=function(){var e=i(n.mark((function e(t){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpcProxy.get_block_hash(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.get_tip_header=function(){var e=i(n.mark((function e(t){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpcProxy.get_tip_header(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.get_live_cell=function(){var e=i(n.mark((function e(t,r){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpcProxy.get_live_cell(t,r));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),t.get_tip_block_number=function(){var e=i(n.mark((function e(){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpcProxy.get_tip_block_number());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.get_current_epoch=function(){var e=i(n.mark((function e(){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpcProxy.get_current_epoch());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.get_epoch_by_number=function(){var e=i(n.mark((function e(t){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpcProxy.get_epoch_by_number(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.get_block_economic_state=function(){var e=i(n.mark((function e(t){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpcProxy.get_block_economic_state(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.get_transaction_proof=function(){var e=i(n.mark((function e(t,r){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpcProxy.get_transaction_proof(t,r||null));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),t.verify_transaction_proof=function(){var e=i(n.mark((function e(t){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpcProxy.verify_transaction_proof(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.get_fork_block=function(){var e=i(n.mark((function e(t,r){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpcProxy.get_fork_block(t,r||null));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),t.get_consensus=function(){var e=i(n.mark((function e(){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpcProxy.get_consensus());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.dry_run_transaction=function(){var e=i(n.mark((function e(t){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpcProxy.dry_run_transaction(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.calculate_dao_maximum_withdraw=function(){var e=i(n.mark((function e(t,r){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpcProxy.calculate_dao_maximum_withdraw(t,r));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),t.local_node_info=function(){var e=i(n.mark((function e(){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpcProxy.local_node_info());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.get_peers=function(){var e=i(n.mark((function e(){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpcProxy.get_peers());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.get_banned_addresses=function(){var e=i(n.mark((function e(){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpcProxy.get_banned_addresses());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.clear_banned_addresses=function(){var e=i(n.mark((function e(){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpcProxy.clear_banned_addresses());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.set_ban=function(){var e=i(n.mark((function e(t,r,i,a,o){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpcProxy.set_ban(t,r,i||null,void 0!==a?a:null,o||null));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i,a){return e.apply(this,arguments)}}(),t.sync_state=function(){var e=i(n.mark((function e(){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpcProxy.sync_state());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.set_network_active=function(){var e=i(n.mark((function e(t){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpcProxy.set_network_active(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.add_node=function(){var e=i(n.mark((function e(t,r){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpcProxy.add_node(t,r));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),t.remove_node=function(){var e=i(n.mark((function e(t){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpcProxy.remove_node(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.ping_peers=function(){var e=i(n.mark((function e(){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpcProxy.ping_peers());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.send_transaction=function(){var e=i(n.mark((function e(t,r){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpcProxy.send_transaction(t,r||null));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),t.tx_pool_info=function(){var e=i(n.mark((function e(){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpcProxy.tx_pool_info());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.clear_tx_pool=function(){var e=i(n.mark((function e(){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpcProxy.clear_tx_pool());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.get_raw_tx_pool=function(){var e=i(n.mark((function e(t){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpcProxy.get_raw_tx_pool(void 0!==t?t:null));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.get_blockchain_info=function(){var e=i(n.mark((function e(){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpcProxy.get_blockchain_info());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.send_alert=function(){var e=i(n.mark((function e(t){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpcProxy.send_alert(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),e}();t.RPC=c},623:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"RPCCollector",{enumerable:!0,get:function(){return n.RPCCollector}});var n=r(5258)},5258:function(e,t,r){"use strict";var n=r(7162),i=r(3572).default,a=r(4879).default,o=r(8133).default;Object.defineProperty(t,"__esModule",{value:!0}),t.RPCCollector=void 0;var s,u=(s=r(1484))&&s.__esModule?s:{default:s},c=r(576),l=r(6486);var p=function(){function e(e,t,r){var n=void 0===r?{}:r,i=n.skipCellWithContent,a=void 0===i||i,o=n.loadData,s=void 0!==o&&o,u=n.loadBlockNumber,l=void 0===u||u;this.rpc=e,this.lockHash=new c.Reader(t).serializeJson(),this.skipCellWithContent=a,this.loadData=s,this.loadBlockNumber=l}return e.prototype.collect=function(){var e=this;return o(n.mark((function t(){var r,o,s,c,p,d,f,h,v,g,b;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=l.HexStringToBigInt,t.next=3,a(e.rpc.get_tip_block_number());case 3:t.t1=t.sent,r=(0,t.t0)(t.t1),o=u.default.BigInt(0);case 6:if(!u.default.lessThanOrEqual(o,r)){t.next=37;break}return s=u.default.add(o,u.default.BigInt(100)),u.default.greaterThan(s,r)&&(s=r),t.next=11,a(e.rpc.get_cells_by_lock_hash(e.lockHash,(0,l.BigIntToHexString)(o),(0,l.BigIntToHexString)(s)));case 11:c=t.sent,p=i(c);case 13:if((d=p()).done){t.next=34;break}if(f=d.value,!e.skipCellWithContent){t.next=18;break}if(!f.type&&!u.default.greaterThan((0,l.HexStringToBigInt)(f.output_data_len),u.default.BigInt(100))){t.next=18;break}return t.abrupt("continue",32);case 18:if(h=null,!e.loadData){t.next=24;break}return t.next=22,a(e.rpc.get_live_cell(f.out_point,!0));case 22:v=t.sent,h=v.cell.data.content;case 24:if(g=null,!e.loadBlockNumber){t.next=30;break}return t.next=28,a(e.rpc.get_header(f.block_hash));case 28:b=t.sent,g=b.number;case 30:return t.next=32,{cellbase:f.cellbase,cell_output:{capacity:f.capacity,lock:f.lock,type:f.type},out_point:f.out_point,block_hash:f.block_hash,data:h,output_data_len:f.output_data_len,block_number:g};case 32:t.next=13;break;case 34:o=u.default.add(s,u.default.BigInt(1)),t.next=6;break;case 37:case"end":return t.stop()}}),t)})))()},e}();t.RPCCollector=p},1674:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BigIntToHexString",{enumerable:!0,get:function(){return a.BigIntToHexString}}),Object.defineProperty(t,"HexStringToBigInt",{enumerable:!0,get:function(){return a.HexStringToBigInt}}),Object.defineProperty(t,"RPC",{enumerable:!0,get:function(){return a.RPC}}),Object.defineProperty(t,"Reader",{enumerable:!0,get:function(){return n.Reader}}),Object.defineProperty(t,"TransactionDumper",{enumerable:!0,get:function(){return i.TransactionDumper}}),t.validators=t.transformers=t.normalizers=t.cell_collectors=t.VERSION=void 0;var n=r(576),i=r(7588),a=r(6486),o=p(r(565));t.normalizers=o;var s=p(r(3123));t.transformers=s;var u=p(r(2230));t.validators=u;var c=p(r(623));function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(l=function(e){return e?r:t})(e)}function p(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=l(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}return n.default=e,r&&r.set(e,n),n}t.cell_collectors=c;t.VERSION="__development_build__"},565:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NormalizeBlock=function(e,t){var r=(void 0===t?{}:t).debugPath;return c(void 0===r?"block":r,e,{header:d(m),uncles:g(d(x)),transactions:g(d(y)),proposals:g(u(10))})},t.NormalizeCellDep=v,t.NormalizeCellInput=f,t.NormalizeCellOutput=h,t.NormalizeCellbaseWitness=function(e,t){var r=(void 0===t?{}:t).debugPath;return c(void 0===r?"cellbase_witness":r,e,{lock:d(l),message:u(-1)})},t.NormalizeHeader=m,t.NormalizeOutPoint=p,t.NormalizeRawHeader=w,t.NormalizeRawTransaction=b,t.NormalizeScript=l,t.NormalizeTransaction=y,t.NormalizeUncleBlock=x,t.NormalizeWitnessArgs=function(e,t){var r=(void 0===t?{}:t).debugPath,n=void 0===r?"witness_args":r,i={};e.lock&&(i.lock=u(-1)(n+".lock",e.lock));e.input_type&&(i.input_type=u(-1)(n+".input_type",e.input_type));e.output_type&&(i.output_type=u(-1)(n+".output_type",e.output_type));return i};var n,i=(n=r(1484))&&n.__esModule?n:{default:n},a=r(576),o=r(6486);function s(e){return function(t,r){if(!(r instanceof ArrayBuffer)){var n=(0,o.BigIntToHexString)(i.default.BigInt(r)).substr(2);if(n.length%2!=0&&(n="0"+n),n.length/2>e)throw new Error(t+" is "+n.length/2+" bytes long, expected length is "+e+"!");for(var a=new DataView(new ArrayBuffer(e)),s=0;s<n.length/2;s++){var u=n.length-2*(s+1);a.setUint8(s,parseInt(n.substr(u,2),16))}r=a.buffer}if(r.byteLength<e){var c=new Uint8Array(e);c.set(new Uint8Array(r),0),r=c.buffer}return r}}function u(e){return function(t,r){if(r=new a.Reader(r).toArrayBuffer(),e>0&&r.byteLength!==e)throw new Error(t+" has invalid length "+r.byteLength+", required: "+e);return r}}function c(e,t,r){for(var n={},i=0,a=Object.entries(r);i<a.length;i++){var o=a[i],s=o[0],u=o[1],c=t[s];if(!c)throw new Error(e+" is missing "+s+"!");n[s]=u(e+"."+s,c)}return n}function l(e,t){var r=(void 0===t?{}:t).debugPath;return c(void 0===r?"script":r,e,{code_hash:u(32),hash_type:function(e,t){switch(t){case"data":return 0;case"type":return 1;case"data1":return 2;case 0:case 1:case 2:return t;default:throw new Error(e+".hash_type has invalid value: "+t)}},args:u(-1)})}function p(e,t){var r=(void 0===t?{}:t).debugPath;return c(void 0===r?"out_point":r,e,{tx_hash:u(32),index:s(4)})}function d(e){return function(t,r){return e(r,{debugPath:t})}}function f(e,t){var r=(void 0===t?{}:t).debugPath;return c(void 0===r?"cell_input":r,e,{since:s(8),previous_output:d(p)})}function h(e,t){var r=(void 0===t?{}:t).debugPath,n=void 0===r?"cell_output":r,i=c(n,e,{capacity:s(8),lock:d(l)});return e.type&&(i.type_=l(e.type,{debugPath:n+".type"})),i}function v(e,t){var r=(void 0===t?{}:t).debugPath;return c(void 0===r?"cell_dep":r,e,{out_point:d(p),dep_type:function(e,t){switch(t){case"code":return 0;case"dep_group":return 1;case 0:case 1:return t;default:throw new Error(e+".dep_type has invalid value: "+t)}}})}function g(e){return function(t,r){return r.map((function(r,n){return e(t+"["+n+"]",r)}))}}function b(e,t){var r=(void 0===t?{}:t).debugPath;return c(void 0===r?"raw_transaction":r,e,{version:s(4),cell_deps:g(d(v)),header_deps:g(u(32)),inputs:g(d(f)),outputs:g(d(h)),outputs_data:g(u(-1))})}function y(e,t){var r=(void 0===t?{}:t).debugPath,n=void 0===r?"transaction":r,i=b(e,{debugPath:"(raw)"+n}),a=c(n,e,{witnesses:g(u(-1))});return a.raw=i,a}function w(e,t){var r=(void 0===t?{}:t).debugPath;return c(void 0===r?"raw_header":r,e,{version:s(4),compact_target:s(4),timestamp:s(8),number:s(8),epoch:s(8),parent_hash:u(32),transactions_root:u(32),proposals_hash:u(32),extra_hash:u(32),dao:u(32)})}function m(e,t){var r=(void 0===t?{}:t).debugPath,n=void 0===r?"header":r,i=w(e,{debugPath:"(raw)"+n}),a=c(n,e,{nonce:s(16)});return a.raw=i,a}function x(e,t){var r=(void 0===t?{}:t).debugPath;return c(void 0===r?"uncle_block":r,e,{header:d(m),proposals:g(u(10))})}},576:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Reader=void 0;var r=function(){function e(e){this.view=new DataView(e)}var t=e.prototype;return t.length=function(){return this.view.byteLength},t.indexAt=function(e){return this.view.getUint8(e)},t.toArrayBuffer=function(){return this.view.buffer},t.serializeJson=function(){return"0x"+Array.prototype.map.call(new Uint8Array(this.view.buffer),(function(e){return("00"+e.toString(16)).slice(-2)})).join("")},e}(),n=function(){function e(e){this.string=e}var t=e.prototype;return t.length=function(){return this.string.length/2-1},t.indexAt=function(e){return parseInt(this.string.substr(2+2*e,2),16)},t.toArrayBuffer=function(){for(var e=new ArrayBuffer(this.length()),t=new DataView(e),r=0;r<this.length();r++)t.setUint8(r,this.indexAt(r));return e},t.serializeJson=function(){return this.string},e}(),i=function(){function e(e){if(e instanceof n||e instanceof r)return e;if("string"==typeof e){if(!e.startsWith("0x")||e.length%2!=0)throw new Error("Hex string must start with 0x, and has even numbered length!");return new n(e)}if(e instanceof ArrayBuffer)return new r(e);throw new Error("Reader can only accept hex string or ArrayBuffer!")}return e.fromRawString=function(e){for(var t=new ArrayBuffer(e.length),n=new DataView(t),i=0;i<e.length;i++){var a=e.charCodeAt(i);if(a>255)throw new Error("fromRawString can only accept UTF-8 raw string!");n.setUint8(i,a)}return new r(t)},e}();t.Reader=i},6486:function(e,t,r){"use strict";var n=r(7162),i=r(2954).default;Object.defineProperty(t,"__esModule",{value:!0}),t.BigIntToHexString=function(e){return"0x"+e.toString(16)},t.HexStringToBigInt=function(e){return o.default.BigInt(e)},t.RPC=void 0;var a=s(r(6279)),o=s(r(1484));function s(e){return e&&e.__esModule?e:{default:e}}function u(e,t){t=t||{};var r=Object.assign({},t.headers||{},e.headers||{});return Object.assign({},t,e,{headers:r})}var c={get:function(e,t,r){return"send"===t?i(n.mark((function t(){var r;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,a.default)(e.uri,u({method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(e.payload)},e.defaultOptions));case 2:return r=t.sent,t.next=5,r.json();case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)}))):function(){var n=e.id;e.id=e.id+1;for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return e.payload.push({jsonrpc:"2.0",id:n,method:t,params:a}),r}}},l={get:function(e,t){return"batch"===t?function(){return new Proxy({id:Math.round(1e7*Math.random()),payload:[],uri:e.uri,defaultOptions:e.defaultOptions},c)}:i(n.mark((function r(){var i,o,s,c,l,p,d=arguments;return n.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:for(i=Math.round(1e7*Math.random()),o=d.length,s=new Array(o),c=0;c<o;c++)s[c]=d[c];return r.next=4,(0,a.default)(e.uri,u({method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({jsonrpc:"2.0",id:i,method:t,params:s})},e.defaultOptions));case 4:return l=r.sent,r.next=7,l.json();case 7:if((p=r.sent).id===i){r.next=10;break}throw new Error("JSONRPCError: response ID does not match request ID!");case 10:if(!p.error){r.next=12;break}throw new Error("JSONRPCError: server error "+JSON.stringify(p.error));case 12:return r.abrupt("return",p.result);case 13:case"end":return r.stop()}}),r)})))}},p=function(){function e(e,t){return void 0===t&&(t={}),this.uri=e,this.defaultOptions=t,new Proxy(this,l)}return e.create=function(t){return new e(t)},e}();t.RPC=p},7588:function(e,t,r){"use strict";var n=r(3572).default,i=r(7162),a=r(2954).default;Object.defineProperty(t,"__esModule",{value:!0}),t.TransactionDumper=void 0;var o,s=(o=r(1484))&&o.__esModule?o:{default:o},u=r(576),c=r(2230);var l=function(){function e(e,t){var r=void 0===t?{}:t,n=r.validateTransaction,i=void 0===n||n,a=r.depGroupUnpacker,o=void 0===a?null:a;this.rpc=e,this.validateTransaction=i,this.depGroupUnpacker=o}var t=e.prototype;return t.dumpByHash=function(){var e=a(i.mark((function e(t){var r;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.rpc.get_transaction(t);case 2:return delete(r=e.sent.transaction).hash,e.next=6,this.dump(r);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.dump=function(){var e=a(i.mark((function e(t){var r,a,o,s,l,p,d,f,h,v,g,b,y,w,m,x,_,k,S,C,E,P,I,A,z,B,T,O;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.validateTransaction&&(0,c.ValidateTransaction)(t),r=[],a=n(t.inputs);case 3:if((o=a()).done){e.next=14;break}return s=o.value,e.next=7,this._resolveOutPoint(s.previous_output);case 7:l=e.sent,p=l.output,d=l.data,f=l.header,r.push({input:s,output:p,data:d,header:f});case 12:e.next=3;break;case 14:h=[],v=n(t.cell_deps);case 16:if((g=v()).done){e.next=44;break}return b=g.value,e.next=20,this._resolveOutPoint(b.out_point);case 20:if(y=e.sent,w=y.output,m=y.data,x=y.header,h.push({cell_dep:b,output:w,data:m,header:x}),"dep_group"!==b.dep_type){e.next=42;break}if(this.depGroupUnpacker){e.next=28;break}throw new Error("depGroupUnpacker must be provided when the transaction contains dep_group!");case 28:_=this.depGroupUnpacker(new u.Reader(m)),k=n(_);case 30:if((S=k()).done){e.next=42;break}return C=S.value,(0,c.ValidateOutPoint)(C),e.next=35,this._resolveOutPoint(C);case 35:E=e.sent,P=E.output,I=E.data,A=E.header,h.push({cell_dep:{out_point:C,dep_type:"code"},output:P,data:I,header:A});case 40:e.next=30;break;case 42:e.next=16;break;case 44:z=[],B=n(t.header_deps);case 46:if((T=B()).done){e.next=55;break}return O=T.value,e.t0=z,e.next=51,this.rpc.get_header(O);case 51:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 53:e.next=46;break;case 55:return e.abrupt("return",JSON.stringify({mock_info:{inputs:r,cell_deps:h,header_deps:z},tx:t}));case 56:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t._resolveOutPoint=function(){var e=a(i.mark((function e(t){var r,n,a,o;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.rpc.get_transaction(t.tx_hash);case 2:if((r=e.sent)&&r.transaction){e.next=5;break}throw new Error("Transaction "+t.tx_hash+" cannot be found!");case 5:if(n=r.transaction,!((a=s.default.toNumber(s.default.BigInt(t.index)))>=n.outputs.length)){e.next=9;break}throw new Error("Transaction "+t.tx_hash+" does not have output "+a+"!");case 9:return o={output:n.outputs[a],data:n.outputs_data[a]},"committed"===r.tx_status.status&&(o.header=r.tx_status.block_hash),e.abrupt("return",o);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),e}();t.TransactionDumper=l},3123:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TransformBlock=function(e,t){var r=void 0===t?{}:t,i=r.validation,s=void 0===i||i,u=r.debugPath,l=void 0===u?"block":u;e=o(l,e,{header:c(v),uncles:f(c(g)),transactions:f(c(h)),proposals:f(a)}),s&&n.ValidateBlock(e,{debugPath:"(transformed) "+l});return e},t.TransformCellDep=d,t.TransformCellInput=l,t.TransformCellOutput=p,t.TransformCellbaseWitness=function(e,t){var r=void 0===t?{}:t,i=r.validation,u=void 0===i||i,l=r.debugPath,p=void 0===l?"cellbase_witness":l;e=o(p,e,{lock:c(s),message:a}),u&&n.ValidateCellbaseWitness(e,{debugPath:"(transformed) "+p});return e},t.TransformHeader=v,t.TransformOutPoint=u,t.TransformRawHeader=function(e,t){var r=void 0===t?{}:t,i=r.validation,s=void 0===i||i,u=r.debugPath,c=void 0===u?"raw_header":u;e=o(c,e,{version:a,compact_target:a,timestamp:a,number:a,epoch:a,parent_hash:a,transactions_root:a,proposals_hash:a,extra_hash:a,dao:a}),s&&n.ValidateRawHeader(e,{debugPath:"(transformed) "+c});return e},t.TransformRawTransaction=function(e,t){var r=void 0===t?{}:t,i=r.validation,s=void 0===i||i,u=r.debugPath,h=void 0===u?"raw_transaction":u;e=o(h,e,{version:a,cell_deps:f(c(d)),header_deps:f(a),inputs:f(c(l)),outputs:f(c(p)),outputs_data:f(a)}),s&&n.ValidateRawTransaction(e,{debugPath:"(transformed) "+h});return e},t.TransformScript=s,t.TransformTransaction=h,t.TransformUncleBlock=g,t.TransformWitnessArgs=function(e,t){var r=void 0===t?{}:t,i=r.validation,s=void 0===i||i,u=r.debugPath,c=void 0===u?"witness_args":u;e=o(c,e,{lock:a,input_type:a,output_type:a}),s&&n.ValidateWitnessArgs(e,{debugPath:"(transformed) "+c});return e};var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=i(t);if(r&&r.has(e))return r.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=a?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}n.default=e,r&&r.set(e,n);return n}(r(2230));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(i=function(e){return e?r:t})(e)}function a(e,t){return t instanceof Object&&t.serializeJson instanceof Function?t.serializeJson.call(t):t}function o(e,t,r){if(!((t=a(0,t))instanceof Object))throw new Error("Transformed "+e+" is not an object!");for(var n={},i=0,o=Object.entries(r);i<o.length;i++){var s=o[i],u=s[0],c=s[1],l=t[u];if(!l)l=t[u.replace(/(_[a-z])/g,(function(e){return e.toUpperCase().replace("_","")}))];l&&(n[u]=c(e+"."+u,l))}return n}function s(e,t){var r=void 0===t?{}:t,i=r.validation,s=void 0===i||i,u=r.debugPath,c=void 0===u?"script":u;return e=o(c,e,{code_hash:a,hash_type:a,args:a}),s&&n.ValidateScript(e,{debugPath:"(transformed) "+c}),e}function u(e,t){var r=void 0===t?{}:t,i=r.validation,s=void 0===i||i,u=r.debugPath,c=void 0===u?"out_point":u;return e=o(c,e,{tx_hash:a,index:a}),s&&n.ValidateOutPoint(e,{debugPath:"(transformed) "+c}),e}function c(e){return function(t,r){return e(r,{validation:!1,debugPath:t})}}function l(e,t){var r=void 0===t?{}:t,i=r.validation,s=void 0===i||i,l=r.debugPath,p=void 0===l?"cell_input":l;return e=o(p,e,{since:a,previous_output:c(u)}),s&&n.ValidateCellInput(e,{debugPath:"(transformed) "+p}),e}function p(e,t){var r=void 0===t?{}:t,i=r.validation,u=void 0===i||i,l=r.debugPath,p=void 0===l?"cell_output":l;return e=o(p,e,{capacity:a,lock:c(s),type:c(s)}),u&&n.ValidateCellOutput(e,{debugPath:"(transformed) "+p}),e}function d(e,t){var r=void 0===t?{}:t,i=r.validation,s=void 0===i||i,l=r.debugPath,p=void 0===l?"cell_dep":l;return e=o(p,e,{out_point:c(u),dep_type:a}),s&&n.ValidateCellDep(e,{debugPath:"(transformed) "+p}),e}function f(e){return function(t,r){return r.map((function(r,n){return e(t+"["+n+"]",r)}))}}function h(e,t){var r=void 0===t?{}:t,i=r.validation,s=void 0===i||i,u=r.debugPath,h=void 0===u?"transaction":u;return e=o(h,e,{version:a,cell_deps:f(c(d)),header_deps:f(a),inputs:f(c(l)),outputs:f(c(p)),outputs_data:f(a),witnesses:f(a)}),s&&n.ValidateTransaction(e,{debugPath:"(transformed) "+h}),e}function v(e,t){var r=void 0===t?{}:t,i=r.validation,s=void 0===i||i,u=r.debugPath,c=void 0===u?"header":u;return e=o(c,e,{version:a,compact_target:a,timestamp:a,number:a,epoch:a,parent_hash:a,transactions_root:a,proposals_hash:a,extra_hash:a,dao:a,nonce:a}),s&&n.ValidateHeader(e,{debugPath:"(transformed) "+c}),e}function g(e,t){var r=void 0===t?{}:t,i=r.validation,s=void 0===i||i,u=r.debugPath,l=void 0===u?"uncle_block":u;return e=o(l,e,{header:c(v),proposals:f(a)}),s&&n.ValidateUncleBlock(e,{debugPath:"(transformed) "+l}),e}},2230:function(e,t){"use strict";function r(e,t,r,n){void 0===n&&(n=[]),function(e,t){if(!(t instanceof Object))throw new Error(e+" is not an object!")}(e,t);var i=Object.keys(t).sort(),a=r.length,o=r.length+n.length,s=e+" does not have correct keys! Required keys: ["+r.sort().join(", ")+"], optional keys: ["+n.sort().join(", ")+"], actual keys: ["+i.join(", ")+"]";if(i.length<a||i.length>o)throw new Error(s);var u=i.filter((function(e){return!r.includes(e)}));if(i.length-u.length!==a)throw new Error(s);if(u.find((function(e){return!n.includes(e)})))throw new Error(s)}function n(e,t){if(!/^0x([0-9a-fA-F][0-9a-fA-F])*$/.test(t))throw new Error(e+" must be a hex string!")}function i(e,t){if(n(e,t),66!==t.length)throw new Error(e+" must be a hex string of 66 bytes long!")}function a(e,t){if("0x0"!==t&&!/^0x[1-9a-fA-F][0-9a-fA-F]*$/.test(t))throw new Error(e+" must be a hex integer!")}function o(e,t){var a=void 0===t?{}:t,o=(a.nestedValidation,a.debugPath),s=void 0===o?"script":o;if(r(s,e,["code_hash","hash_type","args"],[]),i(s+".code_hash",e.code_hash),n(s+".args",e.args),"data"!==e.hash_type&&"type"!==e.hash_type&&"data1"!==e.hash_type)throw new Error(s+".hash_type must be either data or type!")}function s(e,t){var n=void 0===t?{}:t,o=(n.nestedValidation,n.debugPath),s=void 0===o?"out_point":o;r(s,e,["tx_hash","index"],[]),i(s+".tx_hash",e.tx_hash),a(s+".index",e.index)}function u(e,t){var n=void 0===t?{}:t,i=n.nestedValidation,o=void 0===i||i,u=n.debugPath,c=void 0===u?"cell_input":u;r(c,e,["since","previous_output"],[]),a(c+".since",e.since),o&&s(e.previous_output,{debugPath:c+".previous_output"})}function c(e,t){var n=void 0===t?{}:t,i=n.nestedValidation,s=void 0===i||i,u=n.debugPath,c=void 0===u?"cell_output":u;r(c,e,["capacity","lock"],["type"]),a(c+".capacity",e.capacity),s&&(o(e.lock,{debugPath:c+".lock"}),e.type&&o(e.type,{debugPath:c+".type"}))}function l(e,t){var n=void 0===t?{}:t,i=n.nestedValidation,a=void 0===i||i,o=n.debugPath,u=void 0===o?"cell_dep":o;if(r(u,e,["out_point","dep_type"],[]),"code"!==e.dep_type&&"dep_group"!==e.dep_type)throw new Error(u+".dep_type must be either code or dep_group!");a&&s(e.out_point,{debugPath:u+".out_point"})}function p(e,t,r,n){if(!Array.isArray(t))throw new Error(e+" is not an array!");if(n)for(var i=0;i<t.length;i++)r(e+"["+i+"]",t[i])}function d(e,t){return function(r,n){e(n,{nestedValidation:t,debugPath:r})}}function f(e,t,r){a(e+".version",t.version),p(e+".cell_deps",t.cell_deps,d(l,r),r),p(e+".header_deps",t.header_deps,i,r),p(e+".inputs",t.inputs,d(u,r),r),p(e+".outputs",t.outputs,d(c,r),r),p(e+".outputs_data",t.outputs_data,n,r)}function h(e,t){var i=void 0===t?{}:t,a=i.nestedValidation,o=void 0===a||a,s=i.debugPath,u=void 0===s?"transaction":s;r(u,e,["version","cell_deps","header_deps","inputs","outputs","outputs_data","witnesses"],[]),f(u,e,o),p(u+".witnesses",e.witnesses,n,o)}function v(e,t){var i=void 0===t?{}:t,a=(i.nestedValidation,i.debugPath),o=void 0===a?"header":a;if(r(o,e,["version","compact_target","timestamp","number","epoch","parent_hash","transactions_root","proposals_hash","extra_hash","dao","nonce"],[]),n(o+".nonce",e.nonce),34!==e.nonce.length)throw new Error(o+".nonce must be a hex string of 34 bytes long!")}function g(e,t){if(n(e,t),22!==t.length)throw new Error(e+" must be a hex string of 22 bytes long!")}function b(e,t){var n=void 0===t?{}:t,i=n.nestedValidation,a=void 0===i||i,o=n.debugPath,s=void 0===o?"uncle_block":o;r(s,e,["header","proposals"],[]),a&&v(e.header,{debugPath:s+".header"}),p(s+".proposals",e.proposals,g,a)}Object.defineProperty(t,"__esModule",{value:!0}),t.ValidateBlock=function(e,t){var n=void 0===t?{}:t,i=n.nestedValidation,a=void 0===i||i,o=n.debugPath,s=void 0===o?"block":o;r(s,e,["header","uncles","transactions","proposals"],[]),a&&v(e.header,{debugPath:s+".header"});p(s+".uncles",e.uncles,d(b,a),a),p(s+".transactions",e.transactions,d(h,a),a),p(s+".proposals",e.proposals,g,a)},t.ValidateCellDep=l,t.ValidateCellInput=u,t.ValidateCellOutput=c,t.ValidateCellbaseWitness=function(e,t){var i=void 0===t?{}:t,a=i.nestedValidation,s=void 0===a||a,u=i.debugPath,c=void 0===u?"cellbase_witness":u;r(c,e,["lock","message"],[]),n(c+".message",e.message),s&&o(e.lock,{debugPath:c+".lock"})},t.ValidateHeader=v,t.ValidateOutPoint=s,t.ValidateRawHeader=function(e,t){var n=void 0===t?{}:t,o=(n.nestedValidation,n.debugPath),s=void 0===o?"raw_header":o;r(s,e,["version","compact_target","timestamp","number","epoch","parent_hash","transactions_root","proposals_hash","extra_hash","dao"],[]),function(e,t){a(e+".version",t.version),a(e+".compact_target",t.compact_target),a(e+".timestamp",t.timestamp),a(e+".number",t.number),a(e+".epoch",t.epoch),i(e+".parent_hash",t.parent_hash),i(e+".transactions_root",t.transactions_root),i(e+".proposals_hash",t.proposals_hash),i(e+".extra_hash",t.extra_hash),i(e+".dao",t.dao)}(s,e)},t.ValidateRawTransaction=function(e,t){var n=void 0===t?{}:t,i=n.nestedValidation,a=void 0===i||i,o=n.debugPath,s=void 0===o?"raw_transaction":o;r(s,e,["version","cell_deps","header_deps","inputs","outputs","outputs_data"],[]),f(s,e,a)},t.ValidateScript=o,t.ValidateTransaction=h,t.ValidateUncleBlock=b,t.ValidateWitnessArgs=function(e,t){var i=void 0===t?{}:t,a=(i.nestedValidation,i.debugPath),o=void 0===a?"witness_args":a;r(o,e,[],["lock","input_type","output_type"]),e.lock&&n(o+".lock",e.lock);e.input_type&&n(o+".input_type",e.input_type);e.output_type&&n(o+".output_type",e.output_type)}},3196:function(){},8087:function(){},9441:function(){},9088:function(){},9261:function(){},2244:function(){},2165:function(){},8991:function(){}}]);